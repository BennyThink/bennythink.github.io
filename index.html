<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>åœŸè±†ä¸å¥½åƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="åœŸè±†ä¸å¥½åƒ">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="åœŸè±†ä¸å¥½åƒ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Bennyå°åœŸè±†">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="åœŸè±†ä¸å¥½åƒ" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">åœŸè±†ä¸å¥½åƒ</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-worker-image-metadata/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/28/worker-image-metadata/index/" class="article-date">
  <time class="dt-published" datetime="2024-09-28T00:00:00.000Z" itemprop="datePublished">2024-09-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloudflare/">cloudflare</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/09/28/worker-image-metadata/index/">ä½¿ç”¨ Cloudflare Workerè·å–å›¾ç‰‡å…ƒæ•°æ®</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>WebP Cloud æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥ç”¨äºè·å–å›¾ç‰‡çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚é•¿å®½ã€å¤§å°ã€è‰²å½©ç©ºé—´ä»¥åŠblurhashã€‚è¿™éƒ¨åˆ†è®¡ç®—ï¼Œå°¤å…¶æ˜¯blurhashå…¶å®è¿˜æ˜¯ç•¥æœ‰å‹åŠ›çš„ï¼Œæˆ‘ä»¬å°±æƒ³èƒ½ä¸èƒ½æŠŠè¿™éƒ¨åˆ†åŠŸèƒ½æ”¾åˆ°å›æºè¯·æ±‚ä¸Šã€‚</p>
<p>å¯¹äº Azure Functionæ¥è¯´ï¼Œè¿™å¿…ç„¶ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºä»–å‡ ä¹å°±æ˜¯<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/developer/javascript/how-to/develop-serverless-apps?tabs=v4-ts">ä¸€ä¸ªå®Œæ•´çš„NodeJSç¯å¢ƒ</a>ï¼Œå¯ä»¥ç”¨sharpçš„ï¼›ä½†æ˜¯å¯¹äºWorkersï¼Œ<a target="_blank" rel="noopener" href="https://developers.cloudflare.com/workers/reference/how-workers-works/">ç”±äºä»–æ˜¯V8</a>ï¼Œåªæ”¯æŒ<a target="_blank" rel="noopener" href="https://developers.cloudflare.com/workers/runtime-apis/nodejs/">NodeJSæœ€åŸºæœ¬çš„ä¸€äº›API</a>ï¼Œæœ€å¤š<a target="_blank" rel="noopener" href="https://developers.cloudflare.com/workers/runtime-apis/webassembly/">å¸¦ä¸ŠWasm</a>ï¼Œè¿™æ ·ç”¨sharpå°±å˜æˆäº†å‡ ä¹ä¸å¯èƒ½çš„äº‹æƒ…ï¼Œå› ä¸ºè¦è°ƒç”¨libvipsã€‚</p>
<p>æœ€ç»ˆç»è¿‡äº†æˆ‘çš„è‰°è‹¦æ¢ç´¢ï¼Œå‘ç°ä¸€ä¸ªåä¸º <code>@cf-wasm/photon</code> çš„åº“ï¼Œå¯ä»¥ç”¨æ¥è·å–å›¾ç‰‡åŸºç¡€ä¿¡æ¯ã€‚é¦–å…ˆéœ€è¦ import</p>
<p>import { PhotonImage, SamplingFilter, resize } from â€˜@cf-wasm&#x2F;photonâ€™;</p>
<p>ç”¨èµ·æ¥ä¹Ÿè¿˜è¡Œï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦é€šè¿‡ <code>fetch</code>è·å–å›¾ç‰‡ï¼Œå¾—åˆ°ä¸€ä¸ª<code>response</code>ï¼Œå¯ä»¥ä»è¿™é‡Œæ‹¿åˆ° <code>ArrayBuffer</code></p>
<p>const response &#x3D; await fetch(url)<br>const buffer &#x3D; await response.arrayBuffer();</p>
<p>ç„¶å<code>PhotonImage</code> éœ€è¦<code>Uint8Array</code>ï¼Œé‚£å…ˆè½¬æ¢ä¸€ä¸‹</p>
<p>const inputBytes &#x3D; new Uint8Array(buffer);</p>
<p>ç„¶ååŠ è½½å›¾ç‰‡</p>
<p>const inputImage &#x3D; PhotonImage.new_from_byteslice(inputBytes);</p>
<p>å®½é«˜å¯ä»¥ç”¨ <code>inputImage.get_width()</code>å’Œ<code>inputImage.get_height()</code></p>
<p>è‰²å½©ç©ºé—´å¯ä»¥ç”¨ <code>inputImage.get_image_data().colorSpace</code></p>
<p>æ–‡ä»¶å¤§å°ç›´æ¥ <code>buffer.length</code>å°±è¡Œ</p>
<p>è®¡ç®— blurhashå»ºè®®å…ˆè°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œæ¯•ç«Ÿ Workeræœ‰æ‰§è¡Œæ—¶é—´é™åˆ¶</p>
<p>const resized &#x3D; resize(inputImage, 32, 32, SamplingFilter.Nearest);</p>
<p>ç„¶åè®¡ç®—</p>
<p>const blur &#x3D; encode(resized.get_raw_pixels(), resized.get_width(), resized.get_height(), 4, 4);</p>
<p>è‡³äºå›¾ç‰‡æ ¼å¼ï¼Œé‚£åªèƒ½é magic headeräº†ï¼Œæ¯”å¦‚ä½¿ç”¨å¦‚ä¸‹ChatGPTç»™æˆ‘çš„ç¥å¥‡ä»£ç </p>
<p>function getImageFormatFromArrayBuffer(arrayBuffer) {<br>    const uint8Array &#x3D; new Uint8Array(arrayBuffer);</p>
<pre><code>// Check for PNG (first 8 bytes: 89 50 4E 47 0D 0A 1A 0A)
if (
    uint8Array\[0\] === 0x89 &amp;&amp;
    uint8Array\[1\] === 0x50 &amp;&amp;
    uint8Array\[2\] === 0x4e &amp;&amp;
    uint8Array\[3\] === 0x47 &amp;&amp;
    uint8Array\[4\] === 0x0d &amp;&amp;
    uint8Array\[5\] === 0x0a &amp;&amp;
    uint8Array\[6\] === 0x1a &amp;&amp;
    uint8Array\[7\] === 0x0a
) &#123;
    return &#39;png&#39;;
&#125;

// Check for JPEG (first 3 bytes: FF D8 FF)
if (uint8Array\[0\] === 0xff &amp;&amp; uint8Array\[1\] === 0xd8 &amp;&amp; uint8Array\[2\] === 0xff) &#123;
    return &#39;jpeg&#39;;
&#125;

// Check for GIF (first 6 bytes: GIF87a or GIF89a)
if (
    uint8Array\[0\] === 0x47 &amp;&amp;
    uint8Array\[1\] === 0x49 &amp;&amp;
    uint8Array\[2\] === 0x46 &amp;&amp;
    uint8Array\[3\] === 0x38 &amp;&amp;
    (uint8Array\[4\] === 0x37 || uint8Array\[4\] === 0x39) &amp;&amp;
    uint8Array\[5\] === 0x61
) &#123;
    return &#39;gif&#39;;
&#125;

// Check for BMP (first 2 bytes: 42 4D)
if (uint8Array\[0\] === 0x42 &amp;&amp; uint8Array\[1\] === 0x4d) &#123;
    return &#39;bmp&#39;;
&#125;

// Check for WebP (first 4 bytes: 52 49 46 46 and &quot;WEBP&quot; in bytes 8-11)
if (
    uint8Array\[0\] === 0x52 &amp;&amp;
    uint8Array\[1\] === 0x49 &amp;&amp;
    uint8Array\[2\] === 0x46 &amp;&amp;
    uint8Array\[3\] === 0x46 &amp;&amp;
    uint8Array\[8\] === 0x57 &amp;&amp;
    uint8Array\[9\] === 0x45 &amp;&amp;
    uint8Array\[10\] === 0x42 &amp;&amp;
    uint8Array\[11\] === 0x50
) &#123;
    return &#39;webp&#39;;
&#125;

return &#39;Unknown format&#39;;
</code></pre>
<p>}</p>
<p>éƒ¨ç½²</p>
<p>npm install @cf-wasm&#x2F;photon<br>npm install blurhash<br>wrangler deploy </p>
<p>å°±å¯ä»¥äº†ã€‚wranglerä¼šè‡ªåŠ¨æ‰“åŒ…ï¼ŒæŠŠä¾èµ–å’Œwasmä¹Ÿä¸€èµ·ä¸Šä¼ ä¸Šå»</p>
<h2 id="Azure-Function"><a href="#Azure-Function" class="headerlink" title="Azure Function"></a>Azure Function</h2><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯Azure Functionï¼Œé‚£ä¹ˆäº‹æƒ…å°±ç®€å•å¤šäº†ï¼Œç›´æ¥å®‰è£…å¹¶ä½¿ç”¨ sharp å°±è¡Œã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒAzure Functionå¯ä»¥é€‰æ‹©è¿è¡Œçš„ç¯å¢ƒæ˜¯Linuxè¿˜æ˜¯Windowsã€‚æ‰€ä»¥æœ¬åœ°ä¹Ÿè¦å®‰è£…å¥½æ­£ç¡®çš„sharpç„¶åæ‰å¯ä»¥éƒ¨ç½²ã€‚</p>
<p>npm install â€“cpu&#x3D;x64 â€“os&#x3D;linux sharp</p>
<p>è¯¦æƒ…å¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://sharp.pixelplumbing.com/install#cross-platform">Cross-platform</a></p>
<h2 id="æœ€ç»ˆç»“æœ"><a href="#æœ€ç»ˆç»“æœ" class="headerlink" title="æœ€ç»ˆç»“æœ"></a>æœ€ç»ˆç»“æœ</h2><p>åŸæ¥æ˜¯æ‰“ç®—æŠŠ Workerå’ŒFunction ç”¨åŒä¸€å¥—ä»£ç åº“çš„ï¼Œä½†æ˜¯ç”±äº Workerçš„é™åˆ¶ï¼Œå³ä½¿ä¸åŒæƒ…å†µä¸‹ä½¿ç”¨ä¸åŒçš„importï¼ŒWorkerè¿˜æ˜¯æ²¡æ³•å…¼å®¹ FunctionğŸ« </p>
<p>æ‰€ä»¥åªèƒ½åˆ†å¼€ä¸¤ä¸ªåˆ†æ”¯äº†ã€‚</p>
<p><img src="/images/2024092817391160.png" alt="è¡¨æ ¼ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>Cloudflare Workers å¤ªå¼±æ™ºäº†ï¼Œå®³æˆ‘å¤±å»äº†äººç”Ÿä¸­å®è´µçš„ä¸‰ä¸ªå°æ—¶<a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/09/2024092817391148.png"><img src="/images/2024092817391148.png" alt="å¡é€šäººç‰© ä¸­åº¦å¯ä¿¡åº¦æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/28/worker-image-metadata/index/" data-id="cm1mqfxms0000d8jf1uap05xh" data-title="ä½¿ç”¨ Cloudflare Workerè·å–å›¾ç‰‡å…ƒæ•°æ®" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-workers-function/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/27/workers-function/index/" class="article-date">
  <time class="dt-published" datetime="2024-09-27T00:00:00.000Z" itemprop="datePublished">2024-09-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/azure/">azure</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/09/27/workers-function/index/">å°† Cloudflare Workers è¿ç§»åˆ° Azure Function</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>WebP Cloud Services<a target="_blank" rel="noopener" href="https://blog.webp.se/cloudflare-workers-origin-zh/">ä½¿ç”¨ Cloudflare Workersè¿›è¡Œå›æºæ¥ä¿è¯åŸç«™æœåŠ¡å™¨IPä¸æ³„æ¼</a>ã€‚æœ¬ç€é™æœ¬å¢æ•ˆçš„ç†å¿µï¼Œæˆ‘ä»¬è¿™æ¬¡å‡†å¤‡å°†éƒ¨åˆ†å›æºè¯·æ±‚è¿ç§»åˆ° Azure Functionã€‚</p>
<p>Azure Function åŒæ ·ä¹Ÿæ˜¯ç”± Azure æä¾›çš„serverlessæœåŠ¡ï¼Œè¿è¡Œæ—¶å¯ä»¥ä½¿ç”¨ Pythonã€NodeJSã€Javaå’Œäº²å„¿å­ .NETã€PowerShellï¼Œå’Œ Cloudflare Workersä¸€æ ·ï¼Œæ¯ä¸ªæœˆå‰100ä¸‡è¯·æ±‚å…è´¹ï¼Œå…·ä½“ä¿¡æ¯å¯ä»¥å‚è€ƒä»·æ ¼è¡¨</p>
<p>æˆ‘ä»¬çš„å›æºä»£ç æ˜¯ä½¿ç”¨ JavaScriptå†™çš„ï¼Œè™½ç„¶è¿™ä¸ªè¯­è¨€æŒºæ‰­æ›²çš„ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿è¿ç§»ï¼Œå°±ä¸å˜å•¦ï¼</p>
<h1 id="åˆ›å»º-Azure-è´¦å·"><a href="#åˆ›å»º-Azure-è´¦å·" class="headerlink" title="åˆ›å»º Azure è´¦å·"></a>åˆ›å»º Azure è´¦å·</h1><p>ä½ éœ€è¦æœ‰ä¸€ä¸ªæ´»è·ƒè®¢é˜…çš„Azureè´¦å·â€¦â€¦</p>
<h1 id="åˆ›å»º-Function"><a href="#åˆ›å»º-Function" class="headerlink" title="åˆ›å»º Function"></a>åˆ›å»º Function</h1><p>æœç´¢æ æœç´¢ Function Appï¼Œç‚¹å‡» Create æŒ‰é’®ï¼Œä¼šå‘ç° Azure æä¾›äº†äº”ç§é€‰é¡¹ã€‚é€‰æ‹©ç¬¬ä¸€ä¸ª Consumption</p>
<p><img src="/images/2024092621330760.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="åŸºæœ¬ä¿¡æ¯"><a href="#åŸºæœ¬ä¿¡æ¯" class="headerlink" title="åŸºæœ¬ä¿¡æ¯"></a>åŸºæœ¬ä¿¡æ¯</h3><p>è¿›å…¥é…ç½®é¡µé¢ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªèµ„æºç»„ï¼Œéœ€è¦é€‰æ‹©çš„æ˜¯ Runtimeï¼Œè¿™é‡Œé€‰æ‹© nodejsï¼Œç„¶å Regioné€‰æ‹©ç¦»ç”¨æˆ·æœ€æ¥è¿‘çš„åœ°æ–¹ã€‚è¿™é‡Œå’Œ Cloudflare Workersä¸ä¸€æ ·ï¼ŒCloudflare Workersæ˜¯åœ¨å…¨çƒéƒ¨ç½²çš„ï¼Œä¼šåœ¨ç¦»ç”¨æˆ·æœ€è¿‘çš„èŠ‚ç‚¹æ‰§è¡Œï¼›Azure è¿™é‡Œæ˜¯åœ¨å›ºå®šçš„èŠ‚ç‚¹æ‰§è¡Œï¼Œæ‰€ä»¥å¯¹äºå¤§é™†ç”¨æˆ·æ¥è¯´ï¼Œæ—¥éŸ©æ¸¯æ–°æ˜¯æ¯”è¾ƒä¸é”™çš„ä½ç½®ã€‚</p>
<p><img src="/images/2024092621330965.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h3><p>é»˜è®¤å°±è¡Œï¼Œè¦æ˜¯çœ‹é»˜è®¤çš„åå­—ä¸å–œæ¬¢ï¼Œå¯ä»¥è‡ªå·±æ”¹æ‰</p>
<h3 id="ç½‘ç»œ"><a href="#ç½‘ç»œ" class="headerlink" title="ç½‘ç»œ"></a>ç½‘ç»œ</h3><p>è¿™é‡Œè¦é€‰æ‹©Enable public accessï¼Œè¦ä¸ç„¶è®¿é—®ä¸äº†ã€‚</p>
<p><img src="/images/2024092621331055.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="å…¶ä»–é€‰é¡¹"><a href="#å…¶ä»–é€‰é¡¹" class="headerlink" title="å…¶ä»–é€‰é¡¹"></a>å…¶ä»–é€‰é¡¹</h3><p>Monitoring æƒ³å¼€å°±å¼€ï¼Œä¸ºäº†çœé’±å¯ä»¥å…³æ‰ã€‚å½“ç„¶åç»­ä¹Ÿå¯ä»¥é‡æ–°å¼€å¯ï¼›</p>
<p>Deploymentæ˜¯é…ç½®CDçš„åœ°æ–¹ï¼Œå¯ä»¥ä»¥åå†é…ç½®</p>
<h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p>éƒ¨ç½²å®Œæˆä¹‹å Azure ä¼šæä¾›ä¸€ä¸ªURLï¼Œæ‰“å¼€ä¹‹ååº”è¯¥æ˜¯è¿™æ ·çš„</p>
<p><img src="/images/2024092621331135.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, ç½‘ç«™ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="å‡†å¤‡å¼€å‘ç¯å¢ƒ"><a href="#å‡†å¤‡å¼€å‘ç¯å¢ƒ" class="headerlink" title="å‡†å¤‡å¼€å‘ç¯å¢ƒ"></a>å‡†å¤‡å¼€å‘ç¯å¢ƒ</h2><p>ä¸åƒ Cloudflare Workers é‚£ä¹ˆç›´æ¥ï¼Œå¼€å‘ Azure Functions æœ€å¥½ç”¨ VS Codeã€‚å› ä¸ºç”¨ Azure Functions æ‰©å±•ä¼šå¾ˆæ–¹ä¾¿ã€‚</p>
<p>ç„¶åæŒ‰F1å¼¹å‡ºçª—å£ Azure Functions â€“ Create New Projectï¼Œè¯­è¨€å°±é€‰æ‹© JavaScriptï¼Œæ„¿æ„åšç±»å‹ä½“æ“ä¹Ÿå¯ä»¥é€‰æ‹© TypeScriptï¼Œæˆ–è€…ä»»ä½•ä½ ç†Ÿæ‚‰çš„è¯­è¨€éƒ½å¯ä»¥ã€‚</p>
<p><img src="/images/2024092621331236.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>Triggerä¸ºå¦‚ä½•è§¦å‘Functionsï¼Œè¿™ä¸ªåœºæ™¯ä¸‹é€‰æ‹©HTTP Triggerå°±å¯ä»¥äº†</p>
<p><img src="/images/202409262133137.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="ç†Ÿæ‚‰å¼€å‘ç¯å¢ƒ"><a href="#ç†Ÿæ‚‰å¼€å‘ç¯å¢ƒ" class="headerlink" title="ç†Ÿæ‚‰å¼€å‘ç¯å¢ƒ"></a>ç†Ÿæ‚‰å¼€å‘ç¯å¢ƒ</h2><h3 id="ç›®å½•ä¸æ–‡ä»¶"><a href="#ç›®å½•ä¸æ–‡ä»¶" class="headerlink" title="ç›®å½•ä¸æ–‡ä»¶"></a>ç›®å½•ä¸æ–‡ä»¶</h3><ul>
<li><code>src/functions/fetchImage.js</code> è¿™ä¸ªå°±æ˜¯ä½ çš„ä»£ç </li>
<li><code>host.json</code>ï¼šé…ç½®</li>
</ul>
<h3 id="éƒ¨ç½²-1"><a href="#éƒ¨ç½²-1" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p>F1 â€“ Deploy to Function Appï¼Œé€‰æ‹©è®¢é˜…-åˆšåˆšåˆ›å»ºçš„function</p>
<p>éƒ¨ç½²æˆåŠŸä¹‹åï¼Œæµè§ˆå™¨è®¿é—®ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog-fun-post.azurewebsites.net/api/fetchimage">https://blog-fun-post.azurewebsites.net/api/fetchimage</a></p>
<p>å°±å¯ä»¥çœ‹åˆ° Hello Worldä¿¡æ¯äº†ã€‚å…¶ä¸­ï¼š</p>
<ul>
<li><code>api</code>æ˜¯è·¯ç”±å‰ç¼€ï¼Œå¯ä»¥è‡ªå®šä¹‰çš„</li>
<li><code>fetchimage</code>æ˜¯ä»£ç é‡Œå†™å¥½çš„è·¯ç”±ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œé»˜è®¤ä»£ç é‡Œå®šä¹‰çš„name</li>
</ul>
<p>Azure ä¸Šå¯ä»¥çœ‹åˆ°å·²ç»éƒ¨ç½²å¥½çš„ä»£ç </p>
<p><img src="/images/2024092621331341.png" alt="å›¾ç‰‡åŒ…å« å›¾å½¢ç”¨æˆ·ç•Œé¢ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç‚¹è¿›å»ç»ˆäºæœ‰äº†å’Œ Cloudflare Workersä¸€æ ·çš„åœ¨çº¿ç¼–è¾‘é¡µé¢ï¼ˆä¸è¿‡å¯èƒ½æ˜¯åªè¯»çš„ï¼Œå’Œé€‰æ‹©çš„è¯­è¨€æœ‰å…³ï¼‰</p>
<p><img src="/images/2024092621331482.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, ç”µå­é‚®ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="æœ¬åœ°è°ƒè¯•"><a href="#æœ¬åœ°è°ƒè¯•" class="headerlink" title="æœ¬åœ°è°ƒè¯•"></a>æœ¬åœ°è°ƒè¯•</h3><p>æ¯æ¬¡æ”¹ä»£ç éƒ½éƒ¨ç½²ä¸€æ¬¡ç¡®å®ä¸æ˜¯å¥½åŠæ³•ã€‚è¿™ä¸ªæ—¶å€™å°±è¦ç”¨æœ¬åœ°è°ƒè¯•å•¦ï¼Œç”±äºæˆ‘ä»¬æ˜¯ç”¨ HTTP triggerçš„ï¼Œè°ƒè¯•èµ·æ¥éå¸¸ç®€å•æ–¹ä¾¿ã€‚å“¦å¯¹äº†ï¼Œè°ƒè¯• JavaScript åº”ç”¨å¾—æœ‰nodejs</p>
<p>æ‰“å¼€ <code>fetchImage.js</code> æŒ‰ä¸‹F5ï¼Œè¿™é‡Œé€‰æ‹© Connect Storage Accountï¼ˆå…¶å®é€‰æ‹© emulatorç»•è¿‡å»ä¹Ÿè¡Œï¼Œæ²¡å…³ç³»ï¼‰</p>
<p><img src="/images/2024092621331673.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿è¡Œï¼Œå¯èƒ½éœ€è¦å®‰è£…ä¸€äº›ä¾èµ–ï¼Œå®‰è£…å®Œæˆä¹‹åå°±ä¼šçœ‹åˆ°æ§åˆ¶å°è¾“å‡ºäº†ç±»ä¼¼å¦‚ä¸‹ä¿¡æ¯</p>
<p>Azure Functions Core Tools<br>Core Tools Version: 4.0.6280 Commit hash: N&#x2F;A +421f0144b42047aa289ce691dc6db4fc8b6143e6 (64-bit)<br>Function Runtime Version: 4.834.3.22875<br>[2024-09-26T12:27:04.937Z] Debugger listening on ws:&#x2F;&#x2F;127.0.0.1:9229&#x2F;882fb0c8-1957-4070-a6be-9cfd3250d77b<br>[2024-09-26T12:27:04.938Z] For help, see: <a target="_blank" rel="noopener" href="https://nodejs.org/en/docs/inspector">https://nodejs.org/en/docs/inspector</a><br>[2024-09-26T12:27:05.003Z] Worker process started and initialized.<br>[2024-09-26T12:27:05.058Z] Debugger attached.<br>Functions:<br>fetchImage: [GET,POST] <a target="_blank" rel="noopener" href="http://localhost:7071/api/fetchImage">http://localhost:7071/api/fetchImage</a><br>For detailed output, run func with â€“verbose flag.</p>
<p>æµè§ˆå™¨è®¿é—®<code>http://localhost:7071/api/fetchImag</code>e å°±å¯ä»¥äº†ï¼Œæ”¹äº†ä»£ç ä¹Ÿä¼šè‡ªåŠ¨çƒ­åŠ è½½ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰“æ–­ç‚¹ã€‚</p>
<h2 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h2><p>ä¸€ä¸ªæœ€ç®€å•çš„ Functions ä»£ç æ˜¯è¿™æ ·çš„</p>
<p>const { app } &#x3D; require(â€˜@azure&#x2F;functionsâ€™);</p>
<p>app.http(â€˜fetchâ€™, {<br>    methods: [â€˜GETâ€™, â€˜POSTâ€™],<br>    authLevel: â€˜anonymousâ€™,<br>    handler: async (request, context) &#x3D;&gt; {<br>        context.log(`Http function processed request for url â€œ${request.url}â€`);<br>        return { body: `Hello hello hello` };<br>    },<br>});</p>
<ul>
<li><code>app.http</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åå­—ï¼Œè¦å”¯ä¸€ï¼Œå¹¶ä¸”é»˜è®¤æ˜¯è·¯ç”±</li>
<li><code>methods</code>è¡¨ç¤ºæ¥å—çš„è¯·æ±‚æ–¹æ³•</li>
<li><code>handler</code>æ˜¯å¤„ç†è¯·æ±‚çš„åœ°æ–¹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>request</code>ï¼Œå¯ä»¥ç”¨æ¥è·å–è¯·æ±‚ä½“ä¹‹ç±»çš„ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªæ˜¯<code>context</code>ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬æ—¥å¿—åŠŸèƒ½ã€ç»‘å®šæ•°æ®ã€ç¯å¢ƒä¿¡æ¯ç­‰ã€‚</li>
<li><code>return</code> ç”¨äºè¿”å›å“åº”ï¼Œ<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-node?tabs=javascript,windows,azure-cli&pivots=nodejs-model-v4">æŒ‰ç…§æ–‡æ¡£</a> <code>context.res</code> ä¹Ÿåº”è¯¥å¯ä»¥ï¼Œä½†æ˜¯åœ¨æˆ‘è¿™é‡Œä¸è¡Œï¼Œå¯èƒ½<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/42548199/azure-function-not-returning-response-through-context-res">éœ€è¦é¢å¤–é…ç½®ä¸€ä¸‹</a>ã€‚è¿”å›ä¸€ä¸ªobjectï¼Œç¼–è¾‘å™¨ä¼šè‡ªåŠ¨è¡¥å…¨ï¼Œæ¯”å¦‚body, status,headers ç­‰</li>
</ul>
<h2 id="å®šä¹‰è·¯ç”±"><a href="#å®šä¹‰è·¯ç”±" class="headerlink" title="å®šä¹‰è·¯ç”±"></a>å®šä¹‰è·¯ç”±</h2><h3 id="è·¯ç”±å‰ç¼€"><a href="#è·¯ç”±å‰ç¼€" class="headerlink" title="è·¯ç”±å‰ç¼€"></a>è·¯ç”±å‰ç¼€</h3><p>é»˜è®¤ï¼Œfunctionsçš„ä»£ç éƒ½æ˜¯ åœ¨ <code>/api</code> è¿™ä¸ªè·¯ç”±ä¸‹çš„ï¼Œåœ¨ <code>host.json</code> é‡Œå¯ä»¥è¿›è¡Œé…ç½®</p>
<p>â€œextensionsâ€: {<br>    â€œhttpâ€: {<br>      â€œroutePrefixâ€: â€œâ€<br>    }<br>  }</p>
<p>è¿™æ ·å°±æ²¡æœ‰ <code>api</code> è¿™ä¸ªå‰ç¼€äº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥éšä¾¿æ”¹ï¼</p>
<h3 id="è·¯ç”±åç§°"><a href="#è·¯ç”±åç§°" class="headerlink" title="è·¯ç”±åç§°"></a>è·¯ç”±åç§°</h3><p>é»˜è®¤è·¯ç”±åç§°æ˜¯<code>app.http</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¦‚</p>
<p>app.http(â€˜fetchâ€™, {<br>    methods: [â€˜GETâ€™, â€˜POSTâ€™],<br>    authLevel: â€˜anonymousâ€™,<br>    handler: handler,<br>});</p>
<p>é‚£ä¹ˆè·¯ç”±å°±æ˜¯ <code>fetch</code> ï¼Œå¦‚æœè¦è‡ªå®šä¹‰å¯ä»¥é¢å¤–ä¼ å…¥ä¸€ä¸ª <code>route</code>ã€‚éœ€è¦æ³¨æ„ä¸å¯ä»¥æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œä¹Ÿä¸å¯ä»¥æ˜¯<code>/</code>å¼€å¤´çš„</p>
<p>app.http(â€˜fetchâ€™, {<br>    methods: [â€˜GETâ€™, â€˜POSTâ€™],<br>    authLevel: â€˜anonymousâ€™,<br>    handler: handler,<br>    route: â€œsomethingâ€<br>});</p>
<h2 id="æ ¹è®¿é—®"><a href="#æ ¹è®¿é—®" class="headerlink" title="æ ¹è®¿é—®"></a>æ ¹è®¿é—®</h2><p>å¦‚æœä½ å¸Œæœ›åº”ç”¨åœ¨ <a href="https://example.com/">https://example.com</a> ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦<code>/api</code> ä¹Ÿä¸éœ€è¦è·¯ç”±åç§°ï¼Œé‚£ä¹ˆå°±è¦ç»¼åˆä»¥ä¸Šä¸¤ç§æ–¹æ³•ï¼Œé…ç½®å‰ç¼€ï¼Œç„¶å <code>route: &quot;/&quot;</code>ä¸èƒ½ç•™ç©ºğŸ˜‚ï¼Œå¦‚æœç•™ç©ºå°±ä¼šå‡ºç°azureé»˜è®¤çš„é¡µé¢ [v_tips]åˆä¸€ä¸ªäººç”Ÿå°æŠ€å·§ğŸ« [&#x2F;v_tips]</p>
<h2 id="è¿ç§»ä»£ç "><a href="#è¿ç§»ä»£ç " class="headerlink" title="è¿ç§»ä»£ç "></a>è¿ç§»ä»£ç </h2><p>æˆ‘ä»¬çš„Cloudflare Workersä»£ç æ˜¯è¿™ä¹ˆå†™çš„ï¼Œéå¸¸ç®€å•</p>
<p>async function handleProxy(post_body) {<br>    const headers &#x3D; {<br>        â€œAcceptâ€: post_body.accept,<br>        â€œUser-Agentâ€: post_body.user_agent<br>    };</p>
<pre><code>const response = await fetch(post\_body.origin\_url, &#123;
    method: post\_body.request\_name,
    headers: headers
&#125;);

if (response.ok) &#123;
    const res = new Response(response.body, &#123;
        status: response.status,
        statusText: response.statusText,
        headers: response.headers
    &#125;);
    return res;
&#125; else &#123;
    return new Response(response.statusText || &quot;Unknown Error&quot;, &#123;
        status: response.status,
        statusText: response.statusText
    &#125;);
&#125;
</code></pre>
<p>}</p>
<p>export default {<br>    async fetch(request, env, ctx) {<br>        try {<br>            const post_body &#x3D; await request.json();<br>            return handleProxy(post_body);<br>        } catch (error) {<br>            return new Response(â€œInvalid JSON dataâ€, { status: 400 });<br>        }<br>    },<br>};</p>
<p>åŸºæœ¬ä¸Šè¦æ”¹çš„åœ°æ–¹å¦‚ä¸‹ï¼š</p>
<ol>
<li>å…¥å£å‚æ•°ä½ç½®è°ƒæ¢</li>
<li>æ”¹æ”¹å‡½æ•°åå­—ä¹‹ç±»çš„</li>
</ol>
<p>ä¹Ÿå°±æ˜¯æ”¹ä¸€ä¸‹é‚£ä¸ª<code>default</code></p>
<p>async function handler(request, context) {<br>    try {<br>        const body &#x3D; await request.json();<br>        return handleProxy(body);<br>    } catch (error) {<br>        console.error(â€˜JSON parsing error:â€™, error);<br>        return new Response(â€˜Invalid JSON dataâ€™, { status: 400 });<br>    }<br>}</p>
<p>å¥½äº†ä½ çš„å‡½æ•°å†™å¥½äº†ï¼Œå¯ä»¥éƒ¨ç½²äº†ã€‚å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œé™¤äº†é…ç½®ç¯å¢ƒé‚£é‡Œéº»çƒ¦ç‚¹ï¼Œåˆ«çš„éƒ½å¾ˆå®¹æ˜“ï¼Œæ¯•ç«Ÿå¤§å®¶éƒ½æ˜¯nodejs 20,è‡ªå¸¦äº†<code>fetch</code>å’Œ<code>Response</code></p>
<p>ç”šè‡³å¯ä»¥é€šè¿‡è¿è¡Œæ—¶ä¿¡æ¯ä¸åŒï¼Œä½¿ç”¨ä¸åŒçš„å…¥å£å‡½æ•°ï¼Œè¿›è€Œåšåˆ°ç”¨ä¸€å¥—ä»£ç ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>Functionæä¾›çš„è¯­è¨€æ¯”Cloudflare Workerså¤š</li>
<li>å¤§å®¶éƒ½æ˜¯JavaScriptï¼Œè¿ç§»å¾ˆç®€å•ã€‚ä¸ºäº†ç±»å‹å®‰å…¨ä¹Ÿå¯ä»¥ä½¿ç”¨ TypeScript</li>
<li>Functionæ˜¯åŒºåŸŸæ€§éƒ¨ç½²ï¼›Workersæ˜¯å…¨çƒéƒ¨ç½²ä¸”å°±è¿‘æ‰§è¡Œ</li>
<li>Function æƒ³è¦åšåˆ°å°±è¿‘æ‰§è¡Œï¼Œå¯èƒ½å¾—éœ€è¦é…åˆ FrontDoor + å¤šåœ°éƒ¨ç½²ï¼Œæƒ³æƒ³å°±å¤´ç–¼</li>
<li>Functionæä¾›çš„è®¡åˆ’æŒºå¤šçš„</li>
<li>Functionä¹Ÿåº”è¯¥å¯ä»¥æ‹¿æ¥åšä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„äº‹æƒ…</li>
<li>Azureçš„çº¿è·¯å¾ˆå¥½ï¼Œå¯¹å¤§é™†è®¿é—®éå¸¸å‹å¥½ï¼Œè€ŒCloudflareåˆ™æ˜¯é™é€ŸCDNäº†</li>
<li>Azureçš„åŠŸèƒ½å¥½å¤šï¼ˆä»·æ ¼ä¹Ÿå¾ˆç¾ä¸½ï¼‰ï¼Œè¿˜å¾…ä»¥åæ…¢æ…¢å­¦ä¹ å°è¯•</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/27/workers-function/index/" data-id="cm1lb077g0000s4jfgb3g1yfv" data-title="å°† Cloudflare Workers è¿ç§»åˆ° Azure Function" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-one-api-clickhouse/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/21/one-api-clickhouse/index/" class="article-date">
  <time class="dt-published" datetime="2024-09-21T00:00:00.000Z" itemprop="datePublished">2024-09-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/09/21/one-api-clickhouse/index/">one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>one-api&#x2F;new-apiæ˜¯ä¸€æ¬¾å¼€æºçš„OpenAI æ¥å£ç®¡ç† &amp; åˆ†å‘ç³»ç»Ÿï¼Œæ”¯æŒOpenAIã€Anthropicã€Geminiç­‰å¤šç§æ¨¡å‹ã€‚</p>
<p>è¿™å¥—ç³»ç»Ÿï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦æ¥çœ‹ï¼Œç”¨èµ·æ¥å€’è¿˜å¥½ï¼ŒUIå¾ˆç®€æ´ï¼›ä»å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œä½œè€…æŒºä¸å®¹æ˜“çš„è¦ç”¨Goæ¥å¤„ç†å„ç§å¥‡å¥‡æ€ªæ€ªçš„åºåˆ—åŒ–é—®é¢˜ï¼Œä¸€æ—¦è¯·æ±‚æ•°é‡è¿‡å¤šå¹¶å‘å°±æ— æ³•æå‡ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿæœ‰å¾ˆå¤š<a target="_blank" rel="noopener" href="https://t.me/mikuri520/2836">å¥‡å¥‡æ€ªæ€ªçš„åœ°æ–¹å•¦</a>â€¦â€¦</p>
<hr>
<p>æˆ‘çš„<a target="_blank" rel="noopener" href="https://burn.hair/">OpenAIæ¥å£è½¬å‘ç«™ ã€Œå¤´é¡¶å†’ç«ã€</a> å°±æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¹‹ä¸Šæ­å»ºçš„ã€‚åªä¸è¿‡ç»è¿‡äº†æˆ‘çš„å¤§é‡ä¿®æ”¹ï¼Œæ¯”å¦‚åŠ ä¸ªæ•°æ®çœ‹æ¿è¿™ç§å‰ç«¯çš„åŠŸèƒ½</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/09/2024092119325495.jpg"><img src="/images/2024092119325495.jpg"></a></p>
<p>ä»¥åŠé»˜é»˜çš„çœ‹ä¸è§çš„åå°ä¼˜åŒ–ã€‚ç»è¿‡æˆ‘çš„ä¸€ç•ªè°ƒæ•™ä¹‹åï¼Œç›®å‰åœ¨Hetzner 2C 2Gçš„æœºå™¨ä¸Šå·²ç»èƒ½è¾¾åˆ°å‡ ç™¾çš„QPSäº†ã€‚å½“ç„¶å®é™…ä½¿ç”¨ï¼Œè¿˜å¾—çœ‹çœŸæ­£çš„APIèƒ½å¤Ÿæä¾›å¤šå°‘TPMå’ŒRPMã€‚</p>
<hr>
<p>åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæœ¬æ¥æ•°æ®åº“çš„å‹åŠ›å°±æ¯”è¾ƒå¤§ï¼Œå¦‚æœè¿˜å¼€å¯äº†æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œé‚£ä¹ˆæ•°æ®åº“å°±ä¼šè¢«å¤§é‡çš„æ—¥å¿—å†™å…¥ç›´æ¥æ’‘çˆ†ï¼›å¦å¤–ï¼Œå³ä½¿åœ¨éé«˜è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œåœ¨æ—¥å¿—æ¡ç›®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼ŒæŸ¥çœ‹æ¯ä¸€é¡µæ—¥å¿—çš„è¯·æ±‚é€Ÿåº¦ä¹Ÿä¼šå¾ˆæ…¢ã€‚</p>
<p>ä¼˜åŒ–å¹¶å‘æœ€ç®€å•ã€å¹¶ä¸”å¤§æ¦‚ç‡å¥½ç”¨çš„åŠæ³•ä¹‹ä¸€æ˜¯ç”¨æ›´é«˜é…ç½®çš„æœºå™¨ã€‚ä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>æå‡åˆ°ä¸€å®šé…ç½®ä¹‹åï¼Œå†æå‡åŸºæœ¬æ²¡å¸®åŠ©ï¼Œä¹Ÿå°±æ˜¯é™·å…¥è¾¹é™…æ•ˆåº”é€’å‡</strong>ã€‚è€Œä¸”å¯¹äºæˆ‘è¿™ç§ç©·äººï¼Œè‡ªç„¶åªèƒ½é å˜å¼‚ä¼˜åŒ–äº†ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ ClickHouseæ›¿æ¢åŸæœ‰çš„æ—¥å¿—ç³»ç»Ÿï¼Œé¿å…åœ¨é«˜å¹¶å‘çš„æ—¶å€™æ¸…ç©ºæ¶åŒ–å¹¶é™ä½æ€§èƒ½ã€‚è‡³äºå…¶ä»–æ–¹é¢çš„ä¼˜åŒ–ï¼Œç­‰ä»¥åå†è¯´ï½</p>
<h2 id="one-apiçš„æ•°æ®åº“"><a href="#one-apiçš„æ•°æ®åº“" class="headerlink" title="one-apiçš„æ•°æ®åº“"></a>one-apiçš„æ•°æ®åº“</h2><p>one-apié»˜è®¤æ”¯æŒä¸‰ç§æ•°æ®åº“ï¼ŒSQLiteï¼ŒMySQLå’ŒPostgreSQLã€‚</p>
<ul>
<li>SQLiteï¼šåµŒå…¥å¼çš„æ•°æ®åº“ï¼Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨é«˜å¹¶å‘ä¸‹ï¼Œå³ä½¿å…è®¸å¤šçº¿ç¨‹è¯»å†™ï¼Œå…¶æ€§èƒ½ä¹Ÿä¸ä¼šå¥½åˆ°å“ªé‡Œå»ã€‚</li>
<li>MySQLï¼šçŸ¥åçš„RDBMS</li>
<li>PostgreSQLï¼šPostgreSQLåº”è¯¥æœ‰æ›´ä¸°å¯Œçš„åŠŸèƒ½å’Œç‰¹æ€§ã€‚</li>
</ul>
<p>å¦‚æœä½ å®åœ¨æ‡’å¾—è‡ªå·±ä¼˜åŒ–ï¼Œç›´æ¥æ¢æˆ PostgreSQL+é«˜é…ç½®çš„æœºå™¨å§ï¼ŒPostgreSQLçš„æ€§èƒ½åº”è¯¥ä¼šå¥½è¿‡MySQLä¸€äº›ã€‚</p>
<h2 id="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥"><a href="#one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥" class="headerlink" title="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥"></a>one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥</h2><p>One-apiçš„æ™®é€šæ•°æ®å’Œæ—¥å¿—é»˜è®¤æƒ…å†µä¸‹å‡è®°å½•åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¹‹ä¸­ï¼Œå…¶Go Struct Model å¦‚ä¸‹</p>
<p>type Log struct {<br>    Id               int    `json:â€idâ€`<br>    UserId           int    `json:â€user_idâ€ gorm:â€indexâ€`<br>    CreatedAt        int64  `json:â€created_atâ€ gorm:â€bigint;index:idx_created_at_typeâ€`<br>    Type             int    `json:â€typeâ€ gorm:â€index:idx_created_at_typeâ€`<br>    Content          string `json:â€contentâ€`<br>    Username         string `json:â€usernameâ€ gorm:â€index:index_username_model_name,priority:2;default:â€™â€™â€`<br>    TokenName        string `json:â€token_nameâ€ gorm:â€index;default:â€™â€™â€`<br>    ModelName        string `json:â€model_nameâ€ gorm:â€index;index:index_username_model_name,priority:1;default:â€™â€™â€`<br>    Quota            int    `json:â€quotaâ€ gorm:â€default:0â€`<br>    PromptTokens     int    `json:â€prompt_tokensâ€ gorm:â€default:0â€`<br>    CompletionTokens int    `json:â€completion_tokensâ€ gorm:â€default:0â€`<br>    ChannelId        int    `json:â€channelâ€ gorm:â€indexâ€`<br>}</p>
<p>é»˜è®¤é…ç½®ä¸‹ï¼Œæ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šè°ƒç”¨ <code>RecordConsumeLog</code> å†™å…¥æ—¥å¿—ï¼Œå…¶ä»£ç éå¸¸ç®€å•</p>
<p>log :&#x3D; &amp;Log{<br>    UserId:           userId,<br>    Username:         GetUsernameById(userId),<br>    CreatedAt:        helper.GetTimestamp(),<br>    Type:             LogTypeConsume,<br>    Content:          content,<br>    PromptTokens:     promptTokens,<br>    CompletionTokens: completionTokens,<br>    TokenName:        tokenName,<br>    ModelName:        modelName,<br>    Quota:            int(quota),<br>    ChannelId:        channelId,<br>}<br>err :&#x3D; LOG_DB.Create(log).Error</p>
<h3 id="é€æ¡å†™å…¥æ—¥å¿—"><a href="#é€æ¡å†™å…¥æ—¥å¿—" class="headerlink" title="é€æ¡å†™å…¥æ—¥å¿—"></a>é€æ¡å†™å…¥æ—¥å¿—</h3><p>åœ¨è¯·æ±‚æ•°é‡æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€æ¡ä¸€æ¡çš„æ‰§è¡Œ insert è¯­å¥ã€‚è¿™ç§æƒ…å†µä¸‹ä¸»è¦æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>
<ol>
<li>ç½‘ç»œå»¶è¿Ÿï¼šæ¯æ¬¡æ“ä½œéƒ½æœ‰å¾€è¿”çš„RTTã€é€šä¿¡å¼€é”€</li>
<li>äº‹åŠ¡å¼€é”€ï¼šæ¯æ¬¡æ“ä½œéƒ½è¦å¼€å¯å’Œå…³é—­äº‹åŠ¡</li>
<li>è´Ÿè½½ï¼šé¢‘ç¹æ’å…¥ä¼šå¯¼è‡´CPUå’ŒIOè´Ÿè½½å¢åŠ </li>
</ol>
<p>å³ä½¿ä½ å¾ˆæœ‰é’±ï¼Œç”¨åˆ°äº†æ¯ä¸ªæœˆå‡ ç™¾å‡ åƒç¾å…ƒé…ç½®å’Œä»·æ ¼å¥‡é«˜çš„Managed databaseï¼Œ1å’Œ2çš„é—®é¢˜è¿˜æ˜¯æ— æ³•é¿å…</p>
<h3 id="insert-manyä¼˜åŒ–"><a href="#insert-manyä¼˜åŒ–" class="headerlink" title="insert_manyä¼˜åŒ–"></a>insert_manyä¼˜åŒ–</h3><p>ä½¿ç”¨ insert_manyï¼Œç§¯æ”’ä¸€å®šçš„æ•°æ®ä¹‹åä¸€èµ·æ’å…¥ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸ç®€å•çš„ä¼˜åŒ–æ€è·¯ã€‚è¿™ç§åŠæ³•ä¹Ÿæœ‰äº›ç¼ºç‚¹ï¼š</p>
<ol>
<li>è¦ç­‰æ•°æ®ç§¯æ”’åˆ°ä¸€å®šç¨‹åº¦ï¼Œä¼šæœ‰ä¸€å®šçš„å»¶è¿Ÿ</li>
<li>ç§¯æ”’æ•°æ®åˆ°æ—¶å€™å¯èƒ½ä¼šæœ‰å†…å­˜æ¶ˆè€—è¿‡å¤šçš„é£é™©</li>
<li>å¯èƒ½ä¼šæœ‰æ›´é«˜çš„å¤±è´¥æ¦‚ç‡ï¼Œä¸€æ¬¡æ€§æ’å…¥æ•°æ®è¿‡å¤šï¼Œå¯èƒ½ä¼šæœ‰ <code>max_allowed_packet</code> ä¹‹ç±»çš„é—®é¢˜</li>
</ol>
<p>ä¼˜ç‚¹å¾ˆæ˜æ˜¾ï¼Œä¸€æ¬¡æ€§å†™å…¥æ•°æ®å¯æ¯”ä¸€æ¡ä¸€æ¡å†™è¦å¿«ä¸Šå¾ˆå¤šå€äº†ã€‚</p>
<p>one-apiè‡ªå¸¦äº†ä¸€ä¸ªç±»ä¼¼çš„åŠŸèƒ½ï¼Œç¯å¢ƒå˜é‡<code>BATCH_UPDATE_ENABLED</code> å’Œ <code>BATCH_UPDATE_INTERVAL</code> ã€‚ä¸è¿‡æˆªæ­¢åˆ°æˆ‘å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œå†™æ—¥å¿—çš„è¿™éƒ¨åˆ†åŠŸèƒ½ä¸åŒ…å«åœ¨<code>batchUpdate</code>å†…â€¦è€Œæ˜¯åœ¨ä¸€ä¸ªgo routineå†…æ‰§è¡Œçš„â€¦</p>
<p>æ›´è¦å‘½çš„æ˜¯ï¼Œè¿™ä¸ª<code>batchUpdate</code>ä»è®¾è®¡ä¸Šæ¥çœ‹ï¼Œåªèƒ½èšåˆæ•°å€¼ç±»å‹çš„æ•°æ®ğŸ˜‚</p>
<p>func addNewRecord(type_ int, id int, value int64) {<br>    batchUpdateLocks[type_].Lock()<br>    defer batchUpdateLocks[type_].Unlock()<br>    if _, ok :&#x3D; batchUpdateStores[type_][id]; !ok {<br>        batchUpdateStores[type_][id] &#x3D; value<br>    } else {<br>        batchUpdateStores[type_][id] +&#x3D; value<br>    }<br>}</p>
<p>æ”¹é€ ä¸€ä¸‹å½“ç„¶å¯è¡Œï¼Œæ”’å¤Ÿ1000æ¡æˆ–åˆ°ä¸€å®šæ—¶é—´é—´éš”ä¸€èµ·å†™å…¥æ•°æ®åº“ï¼Œéš¾åº¦ä¸é«˜ï¼ŒChatGPTå¯ä»¥å¸®å¿™ã€‚</p>
<h2 id="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–"><a href="#one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–" class="headerlink" title="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–"></a>one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–</h2><p>å‡å¦‚æ—¥å¿—å¾ˆå°‘ï¼Œé‚£ä¹ˆè¯»å–æ—¥å¿—å¹¶ä¸ä¼šé€ æˆä»€ä¹ˆå¤§é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œå¹¶ä¸”è¿˜ç”¨æˆ·ç‚¹å‡»äº†ä¸‹ä¸€é¡µï¼Œç”šè‡³æ˜¯æœ€åä¸€é¡µè¿›è¡Œäº†åˆ†é¡µæ“ä½œï¼Œé‚£ä¹ˆ <code>OFFSET</code>å’Œ<code>LIMIT</code> ä¼šæ˜¾è‘—å½±å“æ•°æ®åº“çš„æ€§èƒ½ã€‚</p>
<p>MySQL åœ¨æ‰§è¡Œ <code>OFFSET</code> æ—¶ï¼Œå¿…é¡»ä»å¤´å¼€å§‹æ‰«æå¹¶ä¸¢å¼ƒå‰ <code>OFFSET</code> æ¡è®°å½•ï¼Œç„¶åè¿”å› <code>LIMIT</code> æ¡è®°å½•ï¼Œå¯¼è‡´è¾ƒå¤§çš„æ—¶é—´å¼€é”€ï¼Œå°¤å…¶æ˜¯ <code>OFFSET</code> æ•°å€¼è¾ƒå¤§æ—¶ã€‚</p>
<p>ä¼˜åŒ–æ–¹æ³•åº”è¯¥æ˜¯æœ‰ä¸€äº›çš„ï¼Œæ¯”å¦‚é€šè¿‡ä¸»é”®è€Œä¸æ˜¯<code>OFFSET</code> ï¼Œå…·ä½“å¯ä»¥é—®é—®ChatGPTï¼Œæˆ‘ä¸æ˜¯å¾ˆæ„¿æ„è¿›è¡Œè¿™ä¸ªæ–¹å‘çš„ç ”ç©¶ğŸ˜‚</p>
<h2 id="ClickHouseä»‹ç»"><a href="#ClickHouseä»‹ç»" class="headerlink" title="ClickHouseä»‹ç»"></a>ClickHouseä»‹ç»</h2><p>ClickHouseæ˜¯yandexå¼€å‘çš„ä¸€ä¸ªå¼€æºåˆ—å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œä¸“é—¨ä¸ºé«˜æ€§èƒ½çš„åˆ†ææŸ¥è¯¢è€Œè®¾è®¡ï¼Œåœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶æœ‰å‡ºè‰²çš„è¡¨ç°ã€‚</p>
<p>ClickHouseé‡‡ç”¨åˆ—å¼å­˜å‚¨ï¼Œä¸åƒMySQLç­‰æ˜¯è¡Œå¼å­˜å‚¨ï¼Œç‰¹åˆ«é€‚åˆå­˜å‚¨æ—¥å¿—ã€‚åœ¨ WebP Cloud Services ä¸­æˆ‘ä»¬çš„ç»Ÿè®¡ä¿¡æ¯æ¥æºä¾¿æ˜¯ ClickHouse</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/09/202409212031366.png"><img src="/images/202409212031366.png"></a></p>
<p>æ›´é‡è¦çš„æ˜¯ï¼ŒClickHouseçš„æŸ¥è¯¢è¯­å¥å’ŒMySQLã€PostgreSQLç­‰å‡ ä¹æ²¡ä»€ä¹ˆå·®åˆ«ï¼ŒåŸºæœ¬ä¸Šæ”¹æ”¹å°±èƒ½ç”¨ï¼Œå­¦ä¹ æ›²çº¿å¾ˆå¹³ç¼“ã€‚</p>
<h2 id="ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨"><a href="#ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨"></a>ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨</h2><p>æ ¹æ®ä¸Šé¢çš„Go Structå’Œå·²æœ‰çš„æ•°æ®ç»“æ„ï¼Œæ”¹æ”¹åŸºæœ¬ä¸Šå°±å¯ä»¥äº†ã€‚ä¸ºäº†ä¿æŒä¸€è‡´ï¼Œ<code>created_at</code> å°±ç”¨æ•°å­—æ—¶é—´æˆ³äº†ï¼Œè™½ç„¶ä½¿ç”¨ <code>datetime</code>æ˜¯æ›´å¥½çš„åŠæ³•ã€‚</p>
<p>CREATE TABLE logs<br>(<br>    user_id           Nullable(Int64),<br>    created_at        Int64  DEFAULT toUnixTimestamp(now()),<br>    type              Nullable(Int64),<br>    content           Nullable(String),<br>    username          String DEFAULT â€˜â€™,<br>    token_name        String DEFAULT â€˜â€™,<br>    model_name        String DEFAULT â€˜â€™,<br>    quota             Int64  DEFAULT 0,<br>    prompt_tokens     Int64  DEFAULT 0,<br>    completion_tokens Int64  DEFAULT 0,<br>    ip                Nullable(String),<br>    user_agent        Nullable(String)<br>) ENGINE &#x3D; MergeTree()<br>      ORDER BY (created_at, username, token_name, model_name);</p>
<h2 id="è¿æ¥åˆ°ClickHouse"><a href="#è¿æ¥åˆ°ClickHouse" class="headerlink" title="è¿æ¥åˆ°ClickHouse"></a>è¿æ¥åˆ°ClickHouse</h2><p>ä½¿ç”¨å®˜æ–¹çš„ github.com&#x2F;ClickHouse&#x2F;clickhouse-go</p>
<p>var ch, err &#x3D; clickhouse.Open(&amp;clickhouse.Options{<br>    Addr: []string{â€œclickhouse:9000â€},<br>    Auth: clickhouse.Auth{<br>        Database: â€œopenaiâ€,<br>        Username: â€œdefaultâ€,<br>        Password: â€œâ€,<br>    },<br>})</p>
<h2 id="å†™å…¥æ•°æ®"><a href="#å†™å…¥æ•°æ®" class="headerlink" title="å†™å…¥æ•°æ®"></a>å†™å…¥æ•°æ®</h2><p>query :&#x3D; `INSERT INTO logs ( user_id, created_at, type, content, username, token_name, model_name,quota, prompt_tokens, completion_tokens, ip, user_agent)`<br>ch.Exec(ctx, query, 1, timestamp, â€¦)</p>
<h2 id="æ‰¹é‡å†™å…¥æ•°æ®"><a href="#æ‰¹é‡å†™å…¥æ•°æ®" class="headerlink" title="æ‰¹é‡å†™å…¥æ•°æ®"></a>æ‰¹é‡å†™å…¥æ•°æ®</h2><p>Clickhouseæœ€å‰å®³çš„åœ°æ–¹ä¹‹ä¸€æ˜¯å¯ä»¥æ‰¹é‡å†™å…¥æ•°æ®ï¼Œå®˜ç½‘ä¸Š<a target="_blank" rel="noopener" href="https://clickhouse.com/docs/en/cloud/bestpractices/bulk-inserts">æ˜¯è¿™ä¹ˆè¯´çš„</a>ï¼š</p>
<blockquote>
<p>Generally, we recommend inserting data in fairly large batches of at least 1,000 rows at a time, and ideally between 10,000 to 100,000 rows.</p>
</blockquote>
<p>ä½ çœ‹ä»–ä»¬å¤šè‡ªä¿¡ï¼Œè®©ä½ æ”’å¤Ÿäº†å†å†™ï¼Œä¸€æ¬¡å†™å‡ ä¸‡æ²¡é—®é¢˜</p>
<h3 id="åˆ›å»ºbatch"><a href="#åˆ›å»ºbatch" class="headerlink" title="åˆ›å»ºbatch"></a>åˆ›å»ºbatch</h3><p>åœ¨Goé‡Œæ‰¹é‡å†™å…¥ï¼Œè¦å…ˆåˆ›å»ºbatch</p>
<p>var batch, err &#x3D; ch.PrepareBatch(ctx, `INSERT INTO logs ( user_id, created_at, type, content, username, token_name, model_name,<br>    quota, prompt_tokens, completion_tokens, ip, user_agent)<br>VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`)</p>
<h3 id="è¿½åŠ æ•°æ®"><a href="#è¿½åŠ æ•°æ®" class="headerlink" title="è¿½åŠ æ•°æ®"></a>è¿½åŠ æ•°æ®</h3><p>ç„¶åå¾€è¿™ä¸ª batché‡Œç–¯ç‹‚<code>append</code>æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åœ¨åŸæ¥çš„<code>RecordConsumeLog</code> ä¸­è¿½åŠ æ•°æ®åˆ°è¿™ä¸ªbatch</p>
<p>batch.Append(userId, helper.GetTimestamp(),<br>    LogTypeConsume, content, username, tokenName, modelName, quota, promptTokens, completionTokens, ip, ua,<br>)</p>
<h3 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h3><p>æ—¶é—´å·®ä¸å¤šäº†ï¼Œæˆ–è€…æ•°æ®è¶³å¤Ÿäº†ï¼Œæäº¤</p>
<p>batch.Send()</p>
<h3 id="å®šæ—¶å™¨"><a href="#å®šæ—¶å™¨" class="headerlink" title="å®šæ—¶å™¨"></a>å®šæ—¶å™¨</h3><p>å®šæ—¶å™¨å¯ä»¥ç”¨<code>ticker</code></p>
<p>func ClickHouseTicker() {<br>    var ticker &#x3D; time.NewTicker(time.Second * 60)<br>    for {<br>        select {<br>        case &lt;-ticker.C:<br>            FlushLog()<br>        }<br>    }<br>}</p>
<p>åœ¨ mainé‡Œ <code>go ClickHouseTicker()</code>å³å¯</p>
<h3 id="æ¸…ç©ºbatch"><a href="#æ¸…ç©ºbatch" class="headerlink" title="æ¸…ç©ºbatch"></a>æ¸…ç©ºbatch</h3><p>å†™å®Œæ•°æ®ä¹‹åï¼Œç„¶åæ¸…ç©ºbatchï¼Œä¸èƒ½è¶Šå†™è¶Šå¤š</p>
<p>batch&#x3D;createBatch()</p>
<h3 id="ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ"><a href="#ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ" class="headerlink" title="ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ"></a>ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ</h3><p>æœ€åï¼Œè¦æ•è· SIGINTå’ŒSIGTERMä¿¡å·ï¼Œä¸èƒ½é‡å¯ç¨‹åºçš„ä¸¢æ—¥å¿—å•Šï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°IIFE+goroutineäº†</p>
<p>sigChan :&#x3D; make(chan os.Signal, 1)<br>signal.Notify(sigChan, syscall.SIGTERM, syscall.SIGINT)<br>go func() {<br>    for {<br>        sig :&#x3D; &lt;-sigChan<br>        switch sig {<br>        case syscall.SIGINT, syscall.SIGTERM:<br>            logger.SysLog(â€œCleaning upâ€¦â€)<br>            model.FlushLog()<br>            model.ConsolidateConsumeQuota()<br>            time.Sleep(time.Second * 2)<br>            syscall.Exit(0)<br>        }<br>    }<br>}()</p>
<h2 id="è¯»æ•°æ®"><a href="#è¯»æ•°æ®" class="headerlink" title="è¯»æ•°æ®"></a>è¯»æ•°æ®</h2><p>æŸ¥è¯¢è¯­æ³•åŸºæœ¬å’ŒMySQLä¸€æ ·ï¼Œ<code>ch.Query(ctx, query, paramsâ€¦)</code>å°±è¡Œï¼Œorder byï¼Œoffsetï¼Œlimitï¼Œcountç­‰éƒ½æœ‰</p>
<h2 id="åˆ é™¤æ—¥å¿—"><a href="#åˆ é™¤æ—¥å¿—" class="headerlink" title="åˆ é™¤æ—¥å¿—"></a>åˆ é™¤æ—¥å¿—</h2><p>æ—¥å¿—æ€»å¾—åˆ æ‰ï¼Œè¦ä¸ç„¶ç£ç›˜æ—©æ™šä¼šè¢«æ’‘çˆ†ã€‚ç”¨ç±»ä¼¼å¦‚ä¸‹è¯­å¥å°±è¡Œï¼Œæœ€åçš„ <code>max_execution_time</code> å¯é€‰ï¼Œé¿å…æ—¥å¿—çœŸçš„å¤ªå¤šåˆ é™¤ä¹Ÿå¾ˆè´¹æ—¶é—´</p>
<p>DELETE FROM logs WHERE type &#x3D; 2 AND created_at &lt; timestamp SETTINGS max_execution_time&#x3D;3600</p>
<h2 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h2><p>é€šè¿‡ Grafana + Clickhouseä½œä¸ºæ•°æ®æºï¼Œå¯ä»¥ç›´æ¥ç”»å›¾è¡¨ã€‚ä¹‹å‰ QPS çš„æ•°æ®æ˜¯å†™å…¥åˆ° influxdbçš„ï¼Œä¸€æ—¦è¶…è¿‡7å¤©æŸ¥è¯¢å°±å¾ˆæ…¢ï¼Œç°åœ¨æˆ‘å•ç‹¬æŠŠæœ¬åº”å†™åˆ° influxdbçš„æ•°æ®å†™åˆ°äº†ä¸€ä¸ªåä¸º stats çš„ClickHouseè¡¨ï¼Œåªä¿å­˜å…³é”®çš„ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ—¶é—´ï¼Œæ¨¡å‹åç§°ç­‰ã€‚</p>
<p>æ¯”å¦‚çœ‹çœ‹å¤§å®¶ç”¨å¾—æœ€å¤šçš„æ¨¡å‹ï¼Œæœ€å¤šçš„ç«Ÿç„¶æ˜¯miniï¼Œç„¶åæ˜¯4oï¼›ä½†æ˜¯æ¶ˆè´¹æ˜¯åè¿‡æ¥çš„ï¼Œå› ä¸º4oçš„ä»·æ ¼æ¯”è¾ƒè´µï¼Œminiæ¯”è¾ƒä¾¿å®œ</p>
<p><img src="/images/2024092119153889.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, é¥¼å›¾ ä¸­åº¦å¯ä¿¡åº¦æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æŸ¥è¯¢æ€§èƒ½èƒ½æå‡"><a href="#æŸ¥è¯¢æ€§èƒ½èƒ½æå‡" class="headerlink" title="æŸ¥è¯¢æ€§èƒ½èƒ½æå‡"></a>æŸ¥è¯¢æ€§èƒ½èƒ½æå‡</h2><p>ç®€å•çš„æ‰§è¡Œä¸‰ä¸ªæŸ¥è¯¢ï¼Œä¸€å…±æœ‰354ä¸‡çš„æ•°æ®ã€‚ä¸»è¦æµ‹ä¸€ä¸‹å¤§é‡ç¿»é¡µï¼Œå¯ä»¥çœ‹å‡ºå³ä½¿æœ€å·®çš„<code>select *</code> çš„æƒ…å†µä¸‹ï¼ŒClickHouseå¤§æ¦‚ä¹Ÿæœ‰4-5å€çš„æ€§èƒ½æå‡ã€‚</p>
<table><tbody><tr><td>æŸ¥è¯¢</td><td>MySQL</td><td>ClickHouse</td><td>æ¯”ç‡</td></tr><tr><td>select count(*) from openai.logs;</td><td>2.73</td><td>0.002</td><td>1365.00</td></tr><tr><td>select user_id from openai.logs limit 3 offset 3000000;</td><td>4.19</td><td>0.022</td><td>190.45</td></tr><tr><td>select * from openai.logs limit 3 offset 3000000;</td><td>12.16</td><td>2.778</td><td>4.38</td></tr></tbody></table>

<p>mysql&gt; select count(*) from openai.logs;<br>+â€”â€”â€”-+<br>| count(*) |<br>+â€”â€”â€”-+<br>|  3540771 |<br>+â€”â€”â€”-+<br>1 row in set (2.73 sec)</p>
<p>mysql&gt; select user_id from openai.logs limit 3 offset 3000000;<br>â€¦.<br>3 rows in set (4.19 sec)</p>
<p>mysql&gt; select * from openai.logs limit 3 offset 3000000;<br>â€¦.                                                                                                                                                                                                                                                   |<br>3 rows in set (12.16 sec)</p>
<p>c387e15ec5c6 :) select count(*) from openai.logs;</p>
<p>SELECT count(*)<br>FROM openai.logs</p>
<p>Query id: 9382c843-927d-471f-8f6c-85a049d58294</p>
<p>   â”Œâ”€count()â”€â”</p>
<ol>
<li>â”‚ 3540771 â”‚ â€“ 3.54 million<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</li>
</ol>
<p>1 row in set. Elapsed: 0.002 sec.</p>
<p>c387e15ec5c6 :) select user_id from openai.logs limit 3 offset 3000000;</p>
<p>SELECT user_id<br>FROM openai.logs<br>LIMIT 3000000, 3</p>
<p>Query id: 66d0ea52-6b30-4a73-b313-fc45bdcbaaf2<br>â€¦.</p>
<p>3 rows in set. Elapsed: 0.022 sec. Processed 3.29 million rows, 29.64 MB (146.90 million rows&#x2F;s., 1.32 GB&#x2F;s.)<br>Peak memory usage: 4.26 MiB.</p>
<p>c387e15ec5c6 :) select * from openai.logs limit 3 offset 3000000;</p>
<p>SELECT *<br>FROM openai.logs<br>LIMIT 3000000, 3</p>
<p>Query id: 0faf62f4-5203-434a-8b3d-d1bcf032a8d0<br>â€¦.<br>3 rows in set. Elapsed: 2.778 sec. Processed 3.01 million rows, 9.26 GB (1.08 million rows&#x2F;s., 3.33 GB&#x2F;s.)<br>Peak memory usage: 258.79 MiB.</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>é‚£å½“ç„¶æ˜¯è¦è‡ªæˆ‘å®£ä¼ ä¸€ä¸‹å•¦ï¼</p>
<p>ğŸŒŸğŸŒŸğŸŒŸæ¬¢è¿æ³¨å†Œå¹¶ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://burn.hair/?lang=zh-CN&utm_source=dmesg">å¤´é¡¶å†’ç« OpenAI æ¥å£è½¬å‘ç«™</a>ï¼Œç¨³å®šã€å¿«é€Ÿã€é«˜å¹¶å‘ï¼Œæ³¨å†Œå³èµ é€ $0.5 æµ‹è¯•é¢åº¦ ğŸŒŸğŸŒŸğŸŒŸ</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/21/one-api-clickhouse/index/" data-id="cm1cqczkf0000ymjf4qnmejvy" data-title="one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-stripe-fraud/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/03/stripe-fraud/index/" class="article-date">
  <time class="dt-published" datetime="2024-08-03T00:00:00.000Z" itemprop="datePublished">2024-08-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/08/03/stripe-fraud/index/">Stripe å¦‚ä½•å®‰å…¨æ”¶æ¬¾å¹¶é¿å…ç›—åˆ·ä¸æµ‹å¡</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[v_error]è­¦å‘Šâš ï¸ åœ¨å¤§å¤šæ•°å›½å®¶å’Œåœ°åŒºï¼Œç›—åˆ·ä¿¡ç”¨å¡éƒ½æ˜¯çŠ¯ç½ªè¡Œä¸ºï¼Œæ•°é¢å·¨å¤§ç”šè‡³æ˜¯é‡ç½ªã€‚è¯·ä¸è¦ä»¥èº«è¯•æ³• [&#x2F;v_error] ä½¿ç”¨Stripeè¿›è¡Œæ”¶æ¬¾æ˜¯<a target="_blank" rel="noopener" href="https://dmesg.app/stripe-telegram.html">ä¸€ä»¶éå¸¸ç®€å•çš„äº‹æƒ…</a>ï¼Œç”¨èµ·æ¥éå¸¸èˆ’é€‚ï¼Œä¸æƒ³å†™ä»£ç å°±æ— ä»£ç ï¼Œä¼šå†™ä»£ç è¿˜æƒ³è‡ªå·±è®¾è®¡å‰åç«¯å¯ä»¥ç”¨ Stripe Elementsã€‚</p>
<p>å½“ä½ æŠŠäº‹æƒ…åšå¥½äº†ï¼ŒæŠŠä½ çš„åœ¨çº¿æœåŠ¡ä¸Šçº¿äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¸€å®šè¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼šç›—åˆ·ä¸æµ‹å¡ï¼ˆå¡å·æµ‹è¯•ã€é“¶è¡Œå¡æµ‹è¯•ï¼‰ã€‚</p>
<p>ç›—åˆ·å¾ˆå¥½ç†è§£ï¼Œç”¨å·æ¥çš„ä¿¡ç”¨å¡èµ„æ–™å»ä½ çš„ç½‘ç«™ä¸Šè´­ç‰©ï¼›æµ‹å¡åˆ™æ˜¯ç”¨å°é¢äº¤æ˜“æˆ–è€…å…¶ä»–æ–¹å¼æ¥ç¡®å®šç›—çªƒæ¥çš„ä¿¡ç”¨å¡æ˜¯å¯ç”¨çš„ï¼Œç„¶ååç»­å†å¤§é¢è¯ˆéª—ä¸­ä½¿ç”¨è¿™äº›ä¿¡ç”¨å¡ã€‚</p>
<p>æ¯«æ— ç–‘é—®ï¼Œåªè¦æ˜¯åœ¨çº¿ç”µå­å•†åŠ¡ï¼Œå°±ä¸€å®šæ— æ³•é¿å…ç›—åˆ·ä¸æµ‹å¡çš„ã€‚</p>
<p>ä¸€ä¸ªéå¸¸é‡è¦çš„äº‹æƒ…æ˜¯ï¼Œ<strong>å•†æˆ·ã€å¡ç»„ç»‡ä¸Stripeéƒ½æœ‰è´£ä»»ä¸ä¹‰åŠ¡é˜»æ­¢ç›—åˆ·å’Œæµ‹å¡ã€‚</strong></p>
<p>ä¹Ÿè®¸æœ‰äººä¸ç†è§£ï¼Œä¸ºä»€ä¹ˆå•†æˆ·ä¹Ÿæœ‰è´£ä»»ä¸ä¹‰åŠ¡é˜»æ­¢ç›—åˆ·å’Œæµ‹å¡ï¼Ÿæˆ‘å°±æ˜¯æŠŠ Stripe çš„ä¸€ä¸ªPayment Linkæ”¾åˆ°äº†ç½‘ä¸Šï¼ŒæŸä¸ªä¸æ€€å¥½æ„çš„äººçœ‹åˆ°äº†å»ç›—åˆ·ï¼Œä¸»åŠ¨ç»™æˆ‘é€é’±ï¼Œæˆ‘ä¸ºä»€ä¹ˆè¦è´Ÿè´£ï¼Ÿ</p>
<p>åˆ‡å‹¿è´ªå°ä¾¿å®œï¼çœŸæ­£çš„æŒå¡äººå‘ç°äº†å¼‚å¸¸çš„ä»˜æ¬¾è®°å½•ï¼Œä»–ä»¬ä¼šå»æ‰¾å‘å¡è¡Œäº‰è®®ï¼Œå‘å¡è¡Œå°±ä¼šæ‰¾åˆ° Stripeï¼Œå•†æˆ·å°±éœ€è¦åº”å¯¹äº‰è®®ï¼Œè¿™æœŸé—´ä¸ä»…è¦æ‰¿æ‹…äº‰è®®è´¹ï¼Œåœ¨äº‰è®®æ¯”ä¾‹è¿‡é«˜æ—¶Stripeè¿˜ä¼šå°å·ã€ç”šè‡³ç½šæ¬¾ã€‚</p>
<p><img src="/images/2024072819003618.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>æ‰€ä»¥ï¼Œé‡åˆ°æ¥æºä¸æ˜çš„æ¬ºè¯ˆä»˜æ¬¾ï¼Œä¸€å®šè¦<strong>å…¨é¢é€€æ¬¾</strong>ï¼Œå¯ä¸èƒ½è´ªå°ä¾¿å®œã€‚</p>
<p>ä¸è¿‡å¦‚æœå¯¹æ–¹æ˜¯ç”¨æ”¯ä»˜å®ã€å¾®ä¿¡ä»˜æ¬¾çš„é‚£å°±ä¸ç”¨ç®¡äº†ï¼Œå› ä¸ºè¿™ä¿©åº”è¯¥æ˜¯ä¸æ”¯æŒäº‰è®®çš„ğŸ˜‚</p>
<hr>
<p>å‰ä¸ä¹…ï¼Œæˆ‘â€œæƒ¹æ¯›â€äº†ä¸€ä¸ªé»‘äº§è®ºå›ã€‚è¿™ä¸ªé»‘äº§è®ºå›çš„äººå°±å¼€å§‹ç›—åˆ·+æµ‹å¡ã€‚</p>
<p><img src="/images/2024072819003795.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, ç½‘ç«™ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>æ¯”å¦‚è¿™ç§ï¼Œäººåœ¨æ–°åŠ å¡ç”¨å¢¨è¥¿å“¥çš„å¡ğŸ¤¨ï¼Œå†è€ƒè™‘åˆ°æˆ‘çš„ç”¨æˆ·çš„å¤§éƒ¨åˆ†éƒ½æ˜¯ä¸­å›½äººï¼Œæ‰€ä»¥çœ‹èµ·æ¥æ€ä¹ˆéƒ½å¾ˆåƒç›—åˆ·ã€‚</p>
<p>åæ¥ä»–ä»¬ç›—åˆ·ä¸æˆè¿˜æ¼ç¾æˆæ€’<a target="_blank" rel="noopener" href="https://dmesg.app/hide-in-cf.html">å¼€å§‹DoSæˆ‘äº†</a>ï¼Œå³°å€¼ç«Ÿç„¶æœ‰5500ä¸‡ã€‚</p>
<p>è‡³äºæˆ‘æ˜¯æ€ä¹ˆâ€œæƒ¹æ¯›â€è¿™ç¾¤äººçš„ï¼Œä»¥åä¹Ÿè®¸å¯ä»¥å†™ä¸€ç¯‡æ¥è¯´è¯´è¿™ä»¶äº‹ï¼Œæˆ‘è§‰å¾—è¿™å…¶ä¸­çš„ä¹è¶£ä¼šæ¯”å¬ç›¸å£°è¿˜æç¬‘ğŸ¤£ï¼Œä¸ç¬‘æˆ‘å€’è´´ä½ 100å—ã€‚å¦‚æœä½ è¿˜æ˜¯æƒ³å…ˆäº†è§£ä¸€ä¸‹ï¼Œé‚£ä¹ˆçœ‹<a target="_blank" rel="noopener" href="https://x.com/DerekNee/status/1783064415048491428">è¿™ä¸ªTwitter</a>å°±å¤Ÿäº†</p>
<hr>
<p>æœ¬æ–‡çš„ä¸»é¢˜æ˜¯ï¼Œå·²ç»ä½¿ç”¨äº†Stripeï¼Œå¦‚ä½•é˜²æ‚£äºæœªç„¶ï¼Œé¿å…ç›—åˆ·ä¸æµ‹å¡ï¼Ÿå‡å¦‚åœ¨é­é‡ç›—åˆ·ï¼Œéœ€è¦ç«‹åˆ»åšä»€ä¹ˆäº‹æƒ…ï¼Ÿ</p>
<h2 id="Radar"><a href="#Radar" class="headerlink" title="Radar"></a>Radar</h2><p>Stripe Radar æ˜¯Stripeæä¾›çš„ä¸€ä¸ªåæ¬ºè¯ˆå·¥å…·ï¼ŒåŸºäºå¼ºå¤§çš„æœºå™¨å­¦ä¹ å®ç°ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰è®¸å¤šè§„åˆ™ã€‚æ¯”å¦‚ChatGPTä¸å…è®¸ä¸­å›½çš„å¡ä»˜æ¬¾ï¼Œç±»ä¼¼è¿™æ ·çš„è§„åˆ™ï¼Œå°±å¯ä»¥Radarçš„è§„åˆ™å®ç°ã€‚</p>
<p>Radarä¸æ”¶æœˆè´¹ï¼Œè€Œæ˜¯ä»æ¯ç¬”äº¤æ˜“é‡ŒæŠ½æˆï¼ŒStripeè¿˜æ˜¯å¾ˆè‰¯å¿ƒè€Œä¸”å¾ˆä¼šèµšé’±çš„ã€‚</p>
<p>åœ¨é­é‡ç›—åˆ·çš„æ—¶å€™ï¼Œ<strong>ç«‹åˆ»è¦åšçš„äº‹æƒ…å°±æ˜¯å¼€å¯ Radar</strong>ï¼Œå¹¶ä¸”æ ¹æ®è‡ªå·±çš„æƒ…å†µè°ƒæ•´çµæ•åº¦ã€‚åŒæ—¶ï¼Œå®¡æ ¸æ‰€æœ‰å·²ç»é€šè¿‡çš„ä»˜æ¬¾ï¼Œå¦‚æœæ€€ç–‘æ˜¯ç›—åˆ·çš„ï¼Œè¦<strong>ç«‹åˆ»å…¨é¢é€€æ¬¾ï¼Œå…¨é¢é€€æ¬¾æ— æ³•äº‰è®®</strong>ã€‚åœ¨å¤„ç†å®Œä¹‹åï¼Œè”ç³» Stripeå®¢æˆ·è¡¨æ˜è‡ªå·±çš„æƒ…å†µï¼Œè¦æ±‚ä»–ä»¬æä¾›ååŠ©å’Œå»ºè®®ã€‚</p>
<p>ä»¥æ–°åŠ å¡ä¸ºä¾‹ï¼ŒRadaré£æ§å›¢é˜Ÿç‰ˆæ¯ç¬”äº¤æ˜“ 0.1æ–°å¸ï¼Œæœºå™¨å­¦ä¹ ç‰ˆæ¯ç¬”0.08æ–°å¸ã€‚å¼ºçƒˆå»ºè®®å¼€å¯å›¢é˜Ÿç‰ˆã€‚</p>
<p>å¼€å¯äº†Radarä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Risk Controlé‡Œè°ƒæ•´Radarçš„çµæ•åº¦</p>
<p><img src="/images/2024072819003967.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>æ ¹æ®è‡ªå·±çš„æƒ…å†µè°ƒæ•´å³å¯ï¼Œæ¯”å¦‚æˆ‘åœ¨é¢ä¸´å¤§é‡ç›—åˆ·çš„æ—¶å€™ï¼ŒæŠŠçµæ•åº¦è°ƒåˆ°äº†50ï¼Œæ„å‘³ç€æ‰€æœ‰é£é™©åˆ†æ•°é«˜äº50çš„ä»˜æ¬¾éƒ½ä¼šè¢«æ‹’ç»ã€‚</p>
<h2 id="3DS"><a href="#3DS" class="headerlink" title="3DS"></a>3DS</h2><p>åœ¨æŸäº›åœ°æ–¹ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ° Stripe 2D çš„è¯´æ³•ã€‚è¿™é‡Œçš„2DæŒ‡çš„æ˜¯åœ¨çº¿åˆ·å¡çš„æ—¶å€™åªè¦è¾“å…¥å¡å·ã€æœ‰æ•ˆæœŸã€CVVå¹¶ä¸”æ— éœ€è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆé€šå¸¸æ˜¯çŸ­ä¿¡æˆ–è€…Appæ¨é€ï¼‰ã€‚å¯¹åº”çš„éœ€è¦éªŒè¯çš„åˆ™æ˜¯3DS</p>
<p>åœ¨å¼€å¯äº† Radarä¹‹åï¼Œå°±å¯ä»¥å¼ºåˆ¶å¼€å¯3DSäº†ï¼Œè¿™æ ·å¯¹äºç›—åˆ·çš„æƒ…å†µåŸºæœ¬å¯ä»¥æ‹¦æˆªä¸€å¤§éƒ¨åˆ†ï¼Œæ¯•ç«Ÿä»–ä»¬æ²¡æœ‰å¡ä¸»çš„æ‰‹æœºã€‚</p>
<p>Radar â€“ Rules- Authenticate Rulesï¼Œä¸‰ä¸ªé»˜è®¤çš„3DSè§„åˆ™å…¨éƒ¨æ‰“å¼€</p>
<p><img src="/images/2024072819004024.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="è‡ªå®šä¹‰é˜»æ­¢è§„åˆ™"><a href="#è‡ªå®šä¹‰é˜»æ­¢è§„åˆ™" class="headerlink" title="è‡ªå®šä¹‰é˜»æ­¢è§„åˆ™"></a>è‡ªå®šä¹‰é˜»æ­¢è§„åˆ™</h2><p>æ¯ä¸ªäººçš„ä¸šåŠ¡éƒ½ä¸åŒï¼Œæ¯”å¦‚æˆ‘çš„è¿™ä¸ªä¸šåŠ¡ä¸‹ï¼Œç¾å›½äººä¸å¤ªå¯èƒ½æ¥ç”¨ï¼Œæ›´åˆ«æé‚£äº›éå¸¸å°ä¼—ä¸œå—äºšã€åŠ å‹’æ¯”æµ·å’Œéæ´²å›½å®¶äº†ã€‚å› æ­¤å¯¹äºæˆ‘æ¥è¯´ï¼Œæˆ‘åªè¦å…è®¸ä¸­å›½ã€æœ€å¤šå†åŒ…å«æ¸¯æ¾³å°çš„é“¶è¡Œå¡å°±å¯ä»¥äº†ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ ä¸€ä¸ªè¿™æ ·çš„è‡ªå®šä¹‰é˜»æ­¢è§„åˆ™ï¼Œè¡¨è¾¾å¼è¿™ä¹ˆå†™ï¼ŒNOTè¦å†™æœ€å‰é¢è€Œä¸æ˜¯å†™INä¹‹å‰</p>
<p>NOT (:card_country: IN (â€˜CNâ€™,â€™HKâ€™,â€™MOâ€™,â€™TWâ€™))</p>
<p>ä¸æƒ³æ¥å—é¢„ä»˜è´¹å¡ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·å†™</p>
<p>:card_funding: &#x3D; â€˜prepaidâ€™</p>
<p>åªæƒ³æ¥å—ä¸­æ¸¯æ¾³å°ï¼Œå…è®¸ä»»ä½•å›½å®¶çš„Apple Payã€Google Payï¼ˆè¿™ä¿©å®‰å…¨ç³»æ•°å¾ˆé«˜ï¼Œä¸å¤ªå¯èƒ½æ˜¯ç›—åˆ·ï¼‰ï¼Œé‚£å°±è¿™ä¹ˆå†™</p>
<p>Block if NOT (:card_country: IN (â€˜CNâ€™,â€™HKâ€™,â€™MOâ€™,â€™TWâ€™)) AND NOT(:digital_wallet: IN (â€˜android_payâ€™,â€™apple_payâ€™))</p>
<p>3DSé€šè¿‡å°±æ¥å—ï¼Œæ— æ‰€è°“å‘å¡å›½ï¼Œå¯ä»¥è¿™ä¹ˆå†™</p>
<p>NOT :is_3d_secure_authenticated:</p>
<blockquote>
<p>æŸäººåœ¨æŸé»‘äº§è®ºå›ï¼šçœŸä¸æ•¢c cnçš„å¡</p>
</blockquote>
<p>åœ¨Stripeå¹³å°ä¸Šï¼Œæˆ‘ä»¬èƒ½åšçš„äº‹æƒ…å·®ä¸å¤šåªæœ‰è¿™ä¹ˆå¤šäº†ã€‚ä¸ºäº†é˜²æ­¢æµ‹å¡ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨è‡ªå·±çš„é›†æˆæ–¹å¼ä¸Šä¸‹ç‚¹åŠŸå¤«ã€‚</p>
<h2 id="æµ‹å¡çš„æ–¹å¼"><a href="#æµ‹å¡çš„æ–¹å¼" class="headerlink" title="æµ‹å¡çš„æ–¹å¼"></a>æµ‹å¡çš„æ–¹å¼</h2><p>æµ‹å¡ä¸€èˆ¬åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯æˆæƒï¼Œç±»ä¼¼ä½ åœ¨æŸäº›ç½‘ç«™å¦‚Cloudflareç»‘å®šä½ çš„ä¿¡ç”¨å¡ï¼Œå¹¶ä¸ä¼šçœŸæ­£çš„æ‰£æ¬¾ï¼ŒAppä¸Šä¸€èˆ¬èƒ½çœ‹åˆ°è®°å½•ï¼Œä½†æ˜¯æ¯æœˆè´¦å•ä¸Šæœªå¿…ä¼šæœ‰ï¼›å¦å¤–ä¸€ç§åˆ™æ˜¯ä»˜æ¬¾ï¼Œä¸€èˆ¬æ˜¯å°é¢ä»˜æ¬¾ï¼Œç¡®è®¤å¡ç‰‡æœ‰æ•ˆå‡†å¤‡æ¥æ³¢å¤§çš„ã€‚</p>
<p><img src="/images/2024072819004098.jpeg" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº ä¸­åº¦å¯ä¿¡åº¦æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æ£€æµ‹æµ‹å¡"><a href="#æ£€æµ‹æµ‹å¡" class="headerlink" title="æ£€æµ‹æµ‹å¡"></a>æ£€æµ‹æµ‹å¡</h2><p>é¦–å…ˆå½“ç„¶æ˜¯è¦æ£€æµ‹åˆ°æµ‹å¡ã€‚æ˜¾è‘—å¢åŠ çš„æ‹’ç»äº¤æ˜“å…¶å®å°±å¯ä»¥ç”¨æ¥è¯†åˆ«æµ‹å¡ã€‚</p>
<ul>
<li>å°è¯•æŸ¥çœ‹ä»˜æ¬¾è¯¦æƒ…çš„æ—¶å€™ï¼Œèƒ½çœ‹åˆ°Stripeä¼šè‡ªåŠ¨å±è”½æµ‹å¡ï¼Œå¦‚ä¸Šé¢çš„è¿™å¼ æˆªå›¾</li>
<li>Developersçš„overviewé¡µé¢å›¾è¡¨èƒ½å‘ç°å¾ˆå¤šå¤±è´¥</li>
</ul>
<p><img src="/images/2024072819004111.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<ul>
<li>åœ¨ Developers â€“ Logs é‡ŒæŸ¥æ‰¾402ï¼Œä¹Ÿä¼šå‘ç°å¤§é‡è®°å½•</li>
</ul>
<p>åœ¨å‘ç°è¢«æäº†ä¹‹åï¼Œæˆ‘ä»¬è¦èµ¶ç´§é‡‡å–æªæ–½ã€‚å“ªæ€•èµ¶ç´§æ‰¾åˆ°æµ‹å¡çš„äººçš„IPç»™å±è”½äº†ä¹Ÿæ˜¯åŠæ³•ã€‚å½“ç„¶åäººæ²¡é‚£ä¹ˆç¬¨ï¼Œç®€å•çš„é˜²ç«å¢™è§„åˆ™æœªå¿…ä¼šç®¡ç”¨çš„ã€‚</p>
<h2 id="ä¿æŠ¤-API-Key"><a href="#ä¿æŠ¤-API-Key" class="headerlink" title="ä¿æŠ¤ API Key"></a>ä¿æŠ¤ API Key</h2><p>Stripeçš„API Keyåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯Publishable Keyå¯ä»¥å…¬å¼€çš„ï¼›å¦ä¸€ç§æ˜¯Secret Keyï¼Œæœ‰è¿™ä¸ªKeyå°±å¯ä»¥è®¿é—®Stripeçš„ç³»ç»Ÿå’Œå…¨çƒé‡‘èç½‘ç»œï¼Œæ‰€ä»¥ä¸‡ä¸‡ä¸èƒ½æ³„æ¼</p>
<p>é‡åˆ°æµ‹å¡å»ºè®®æ— è®ºæ˜¯å¦æ³„æ¼ secret keyï¼Œéƒ½å»åŠé”€ç”Ÿæˆä¸€ä¸ªæ–°çš„ï¼Œå¹¶ä¸”æ·»åŠ IPè®¿é—®ç™½åå•</p>
<p><img src="/images/2024072819004129.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, èŠå¤©æˆ–çŸ­ä¿¡ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="ä¼˜åŒ–é›†æˆæ–¹å¼"><a href="#ä¼˜åŒ–é›†æˆæ–¹å¼" class="headerlink" title="ä¼˜åŒ–é›†æˆæ–¹å¼"></a>ä¼˜åŒ–é›†æˆæ–¹å¼</h2><p>ä½¿ç”¨ Stripeæœ‰å¾ˆå¤šé›†æˆæ–¹å¼ï¼Œä½¿ç”¨ Stripe Payment Linkã€Stripe Checkoutã€Stripe Elementsæ˜¯æ¨èçš„æ–¹å¼</p>
<p><img src="/images/202407281900421.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç”¨è¿™ç§é›†æˆæ–¹å¼ï¼Œ Radarèƒ½å¤Ÿè‡ªåŠ¨æ•è·åˆ°æ›´å¤šçš„ä¿¡æ¯ï¼Œæ›´å®¹æ˜“åˆ¤æ–­ç›—åˆ·æµ‹å¡ã€‚</p>
<p>å…¶ä»–çš„æ–¹å¼å¯èƒ½å°±éœ€è¦è‡ªå·±æ‰‹åŠ¨æä¾›ä¿¡æ¯äº†ã€‚</p>
<h2 id="æ·»åŠ captcha"><a href="#æ·»åŠ captcha" class="headerlink" title="æ·»åŠ captcha"></a>æ·»åŠ captcha</h2><p>åœ¨è¯·æ±‚åˆ›å»º PaymentIntentä¹‹å‰å¯ä»¥åŠ ä¸Šä¸€ä¸ªéªŒè¯ç ï¼Œæ¯”å¦‚ Cloudflareçš„turnstileå°±æ˜¯éå¸¸å¥½çš„é€‰æ‹©ã€‚ è¿™æ ·å¯¹äºå¤§éƒ¨åˆ†çš„åƒåœ¾è¯·æ±‚éƒ½å¯ä»¥è¿‡æ»¤äº†ã€‚</p>
<p>éœ€è¦æ³¨æ„ï¼Œturnstileæ˜¯éœ€è¦å®¢æˆ·ç«¯+æœåŠ¡ç«¯å®ç°çš„ã€‚åªæœ‰å®¢æˆ·ç«¯æ˜¯ä¸å®Œæ•´çš„ã€‚</p>
<h2 id="é¢‘ç‡é™åˆ¶"><a href="#é¢‘ç‡é™åˆ¶" class="headerlink" title="é¢‘ç‡é™åˆ¶"></a>é¢‘ç‡é™åˆ¶</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œå•ä¸ªIPåˆ›å»º PaymentIntent ä¸åº”è¯¥å¤ªé¢‘ç¹ï¼Œå¯ä»¥åŠ ä¸Šé¢‘ç‡é™åˆ¶é™ä½è¢«åˆ·æ¦‚ç‡ã€‚</p>
<h2 id="ç™»å½•ä¼šè¯"><a href="#ç™»å½•ä¼šè¯" class="headerlink" title="ç™»å½•ä¼šè¯"></a>ç™»å½•ä¼šè¯</h2><p>ç™»å½•äº†æ‰èƒ½è´­ä¹°ï¼Œç±»ä¼¼è¿™ç§å¯ä»¥é™ä½è¢«åˆ·æˆæœ¬</p>
<h2 id="è‡ªå®šä¹‰è§„åˆ™"><a href="#è‡ªå®šä¹‰è§„åˆ™" class="headerlink" title="è‡ªå®šä¹‰è§„åˆ™"></a>è‡ªå®šä¹‰è§„åˆ™</h2><p>æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡æƒ…å†µï¼Œä½¿ç”¨ä¸åŒçš„è§„åˆ™æ¥å±è”½æµ‹å¡ã€‚ç”šè‡³è¿˜å¯ä»¥æ ¹æ®IPåœ°ç†ä½ç½®å’Œå‘å¡å›½ç»„åˆï¼Œå°±çœ‹æƒ³è±¡åŠ›äº†</p>
<h2 id="æˆ˜æœ"><a href="#æˆ˜æœ" class="headerlink" title="æˆ˜æœ"></a>æˆ˜æœ</h2><p>è¿™æ˜¯å±è”½çš„ä»˜æ¬¾ï¼Œçœ‹è¿™ä¸ªæ—¶é—´è¿™ä¹ˆæ¥è¿‘ï¼Œäººåœ¨ç¾å›½ç”¨ç€æ³°å›½ã€ç”šè‡³ä¸€äº›å¥‡æ€ªçš„å°å›½å®¶çš„å¡ï¼Œé£é™©ç³»æ•°éå¸¸é«˜</p>
<p><img src="/images/2024072819004281.jpeg" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>å¤§æ¦‚æ‹¦æˆªäº†3000æ¬§ï¼Œææ€–å•ŠğŸ˜‚ æœ€å¼€å§‹è§„åˆ™é…ç½®çš„ä¸å¤ªæ­£ç¡®ï¼Œä¼°è®¡è¯¯æ€äº†ä¸€éƒ¨åˆ†</p>
<p><img src="/images/2024072819004317.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>Stripeçš„æ–‡æ¡£è¿˜æ˜¯æŒºä¸é”™çš„ï¼ŒSDKç”¨èµ·æ¥ä¹Ÿéå¸¸èˆ’æœã€‚æ— è®ºæ˜¯stripe.jsè¿˜æ˜¯python bindingsï¼Œå†™æ»¡äº† type annotationsï¼Œæƒ³ç”¨é”™éƒ½éš¾</li>
<li>Stripeçš„å®¢æœä¹Ÿå¾ˆä¸“ä¸šï¼Œå“åº”éå¸¸è¿…é€Ÿ</li>
<li>åäººå¤ªå¤šå•¦</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/08/03/stripe-fraud/index/" data-id="clzepsaz30000epjfdd66d8v9" data-title="Stripe å¦‚ä½•å®‰å…¨æ”¶æ¬¾å¹¶é¿å…ç›—åˆ·ä¸æµ‹å¡" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hide-in-cf/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/07/27/hide-in-cf/index/" class="article-date">
  <time class="dt-published" datetime="2024-07-27T00:00:00.000Z" itemprop="datePublished">2024-07-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/cloudflare/">cloudflare</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/07/27/hide-in-cf/index/">éšè—äº Cloudflare çš„å…¨çƒç½‘ç»œä¹‹ä¸­</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>åšä¸€ä¸ªç½‘ç«™æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ã€‚ä¹°ä¸€ä¸ªåŸŸåï¼Œä¹°ä¸€ä¸ªæœåŠ¡å™¨ï¼ŒAè®°å½•è§£æè¿‡å»å°±å¥½äº†ã€‚</p>
<p>è¿™æ ·åšå…¶å®æœ‰ä¸€ä¸ªéå¸¸å¤§çš„å®‰å…¨éšæ‚£ï¼Œä¸æ€€å¥½æ„çš„äººå¯ä»¥æ‹¿åˆ°ä½ çš„æœåŠ¡å™¨çš„IPï¼Œç„¶åå°±å¯ä»¥åšå¾ˆå¤šåäº‹ï¼Œæ¯”å¦‚ (D)DoSã€æš´åŠ›ç ´è§£SSHä¹‹ç±»çš„ã€‚</p>
<p>ä¸€ä¸ªå¾ˆç®€å•çš„åŠæ³•ï¼Œå°±æ˜¯ç”¨ Cloudflareä¹‹ç±»çš„CDNï¼Œè¿™æ ·å¯ä»¥éšè—æºç«™IPã€‚è¿™æ ·ä»–ä»¬æ— æ³•ç›´æ¥æ”»å‡»ä½ çš„æœåŠ¡å™¨ï¼Œåªèƒ½ç–¯ç‹‚æ‰“ Cloudflareã€‚</p>
<hr>
<p>å°±åƒæˆ‘å‰ä¸ä¹…ä¸€æ ·ï¼Œé­é‡äº†äººç”Ÿä¸­ç¬¬ä¸€æ¬¡DoSï¼Œå³°å€¼å¤§æ¦‚æœ‰5500ä¸‡è¯·æ±‚çš„æ ·å­ï¼ŒåŸºæœ¬ä¸Šéƒ½è¢«Cloudflareçš„è§„åˆ™æ‹¦ä½äº†ã€‚</p>
<p><img src="/images/2024072722290473.jpeg" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, å›¾è¡¨ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>[v_tips]æœ‰è¶£çš„æ˜¯ï¼Œæ”»å‡»æ¥è‡ªäº AS4983 ï¼Œå½’å±äº Intelã€‚æˆ‘çŒœæ›´æœ‰å¯èƒ½å’ŒIntelÂ® Developer Cloudæœ‰å…³ï¼Œè€Œä¸æ˜¯Intelçš„å†…éƒ¨ç½‘ç»œè¢«é»‘æˆ–è€…å‘˜å·¥åšåäº‹ã€‚[&#x2F;v_tips]</p>
<p>ç„¶è€Œå³ä½¿ä½¿ç”¨äº† Cloudflareä¹Ÿå¹¶ä¸æ˜¯100%å®‰å…¨ã€‚å¦‚æœä½¿ç”¨æ–¹å¼ä¸æ­£ç¡®ï¼Œä¹Ÿæœ‰å¯èƒ½æš´éœ²æºç«™IPçš„ã€‚å¦‚æœè¢«æŠ“åˆ°äº†æºç«™IPï¼Œé‚£ä¹ˆåäººå°±å¯ä»¥ç–¯ç‹‚ç»™è¿™ä¸ªIPå‘èµ·è¯·æ±‚ï¼Œä½ çš„Cloudflareè§„åˆ™é…ç½®çš„å†å¥½éƒ½æ²¡æœ‰ç”¨ã€‚</p>
<hr>
<h1 id="æ³„æ¼æºç«™IPçš„æ–¹å¼"><a href="#æ³„æ¼æºç«™IPçš„æ–¹å¼" class="headerlink" title="æ³„æ¼æºç«™IPçš„æ–¹å¼"></a>æ³„æ¼æºç«™IPçš„æ–¹å¼</h1><h2 id="ç½‘ç»œç©ºé—´æµ‹ç»˜"><a href="#ç½‘ç»œç©ºé—´æµ‹ç»˜" class="headerlink" title="ç½‘ç»œç©ºé—´æµ‹ç»˜"></a>ç½‘ç»œç©ºé—´æµ‹ç»˜</h2><p>æœ‰ä¸€äº›å®‰å…¨å…¬å¸ï¼Œå¦‚censysã€shodanä¹‹ç±»çš„ã€‚ä»–ä»¬ä¼šæ‰«ææ•´ä¸ªIPv4çš„åœ°å€ï¼Œç„¶åå°è¯•è¿æ¥å„ç§å¸¸ç”¨ç«¯å£æ¥ç¡®å®šè¿™ä¸ªIPä¸Šéƒ½è·‘äº†ä»€ä¹ˆæœåŠ¡ã€‚</p>
<p>æ¯”å¦‚è¯´æˆ‘éšä¾¿è¾“å…¥ä¸€ä¸ªåŸŸåï¼Œå³ä½¿è¿™ä¸ªåŸŸååœ¨Cloudflareä¹‹åï¼Œä¹Ÿå¯èƒ½çœ‹åˆ°ç›¸å…³çš„ç»“æœ</p>
<p><img src="/images/2024072722290512.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç‚¹è¿›å»ï¼Œé€šè¿‡è¯ä¹¦ä¿¡æ¯å°±èƒ½ç¡®è®¤ï¼Œè¿™ä¸ªIPå¤§æ¦‚ç‡æ˜¯è¿™ä¸ªç½‘ç«™çš„ï¼Œé‚£è¿˜ä¸å¿«æ‰“ï¼Ÿ</p>
<h2 id="é’“é±¼æ³„æ¼"><a href="#é’“é±¼æ³„æ¼" class="headerlink" title="é’“é±¼æ³„æ¼"></a>é’“é±¼æ³„æ¼</h2><p>åˆ©ç”¨ç›®æ ‡ç½‘ç«™çš„åŠŸèƒ½æ¥æ‰§è¡ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªç½‘ç«™å…è®¸ç”¨æˆ·è¾“å…¥ä¸€ä¸ª URL æ¥è·å–è¯¥ URL çš„å†…å®¹ï¼ˆå¦‚ç½‘é¡µæŠ“å–æˆ– URL é¢„è§ˆåŠŸèƒ½ï¼‰ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªç”±è‡ªå·±æ§åˆ¶çš„ URLã€‚</p>
<p>æ¯”å¦‚ WebP Cloud Serviceså§ï¼Œè¿™ä¸ªæœåŠ¡æ˜¯åšç½‘ç«™å›¾ç‰‡åŠ é€Ÿçš„ï¼Œé‚£ä¹ˆè‡ªç„¶è¦å»ç”¨æˆ·ç»™çš„åœ°å€å»è·å–å›¾ç‰‡ï¼Œè¿™æ ·IPä¹Ÿå°±ä¼šè¢«æ³„éœ²å•¦ã€‚å½“ç„¶äº†èªæ˜å¦‚ <a target="_blank" rel="noopener" href="https://nova.moe/">Nova Kowk</a>æ€ä¹ˆä¼šè®©è¿™ç§äº‹æƒ…å‘ç”Ÿï¼Ÿ</p>
<h2 id="å…¶ä»–æ³„æ¼æ–¹å¼"><a href="#å…¶ä»–æ³„æ¼æ–¹å¼" class="headerlink" title="å…¶ä»–æ³„æ¼æ–¹å¼"></a>å…¶ä»–æ³„æ¼æ–¹å¼</h2><h3 id="å­åŸŸå"><a href="#å­åŸŸå" class="headerlink" title="å­åŸŸå"></a>å­åŸŸå</h3><p>æœ‰ä¸€äº›ç¨‹åºå¯ä»¥é€šè¿‡å¸¸ç”¨çš„è¯è¯­æ¥æš´åŠ›çŒœæµ‹å­åŸŸåï¼Œæœ‰å¯èƒ½é…ç½®çš„æ—¶å€™ä¸å°å¿ƒå¿˜è®°ç‚¹äº®å°äº‘æœµï¼Œæˆ–è€…è‡ªå·±æŒæœ‰çš„å…¶ä»–åŸŸåè§£æä¸å°å¿ƒå¿˜è®°æ‰“ç ï¼Œé‚£ä¹ˆå°±æš´éœ²äº†ã€‚</p>
<h3 id="å†å²DNSè®°å½•"><a href="#å†å²DNSè®°å½•" class="headerlink" title="å†å²DNSè®°å½•"></a>å†å²DNSè®°å½•</h3><p>æœ‰äº›ç½‘ç«™æä¾›å†å²DNSè®°å½•ï¼Œæœ‰æ¦‚ç‡æ‰¾åˆ°</p>
<h3 id="é‚®ä»¶MXè®°å½•"><a href="#é‚®ä»¶MXè®°å½•" class="headerlink" title="é‚®ä»¶MXè®°å½•"></a>é‚®ä»¶MXè®°å½•</h3><p>å¦‚æœè‡ªå»ºé‚®ä»¶æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ˜¯è‚¯å®šä¼šæš´éœ²IPäº†ã€‚</p>
<h3 id="Cloudflareä¿¡æ¯æ³„éœ²æˆ–è€…å†…éƒ¨ä½œæ¡ˆ"><a href="#Cloudflareä¿¡æ¯æ³„éœ²æˆ–è€…å†…éƒ¨ä½œæ¡ˆ" class="headerlink" title="Cloudflareä¿¡æ¯æ³„éœ²æˆ–è€…å†…éƒ¨ä½œæ¡ˆ"></a>Cloudflareä¿¡æ¯æ³„éœ²æˆ–è€…å†…éƒ¨ä½œæ¡ˆ</h3><p>è¿™ä¸ªæ¦‚ç‡åº”è¯¥å¾ˆä½ã€‚</p>
<hr>
<h1 id="éšè—IPçš„æ–¹å¼"><a href="#éšè—IPçš„æ–¹å¼" class="headerlink" title="éšè—IPçš„æ–¹å¼"></a>éšè—IPçš„æ–¹å¼</h1><h2 id="å±è”½censyså¹¶ä¸å®Œç¾"><a href="#å±è”½censyså¹¶ä¸å®Œç¾" class="headerlink" title="å±è”½censyså¹¶ä¸å®Œç¾"></a>å±è”½censyså¹¶ä¸å®Œç¾</h2><p>ç½‘ä¸Šä¸€æœcensys ä½ å°±ä¼šå‘ç°æœ‰å¾ˆå¤šç§åŠæ³•ï¼Œè¯´æ ¹æ®UAå±è”½å•¦ï¼Œæ ¹æ®IPå±è”½å•¦ç­‰ç­‰ã€‚</p>
<p>è¿™ç§åšæ³•æ²»æ ‡ä¸æ²»æœ¬çš„ã€‚ä»Šå¤©å±è”½äº†censysï¼Œæ˜å¤©è¿˜æœ‰densysï¼Œç”šè‡³ç®€å•å†™ä¸ªä»£ç ï¼ŒèŠ±æœ€å¤šå‡ ç™¾Gçš„æµé‡æ‰«ä¸€éå…¨çƒçš„IPv4åœ°å€ä¹Ÿæ²¡ä»€ä¹ˆéš¾åº¦ã€‚</p>
<h2 id="åªå…è®¸-Cloudflareçš„è®¿é—®å¾ˆéº»çƒ¦"><a href="#åªå…è®¸-Cloudflareçš„è®¿é—®å¾ˆéº»çƒ¦" class="headerlink" title="åªå…è®¸ Cloudflareçš„è®¿é—®å¾ˆéº»çƒ¦"></a>åªå…è®¸ Cloudflareçš„è®¿é—®å¾ˆéº»çƒ¦</h2><p>Cloudflareå…¬å¼€äº†ä»–ä»¬çš„<a target="_blank" rel="noopener" href="https://www.cloudflare.com/zh-cn/ips/">IPåœ°å€</a>ï¼Œå› æ­¤ä¸€ç§åŠæ³•æ˜¯æŠŠä»–ä»¬çš„å…¨éƒ¨IPåœ°å€åŠ å…¥ç™½åå•ä¸­ï¼Œç„¶åå…¶ä»–æ‰€æœ‰çš„IPåœ°å€çš„è¯·æ±‚å…¨éƒ¨æ‹’ç»ã€‚</p>
<p>è¿™æ˜¯ä¸€ç§åˆ‡å®å¯è¡Œçš„åŠæ³•ï¼Œç„¶è€Œæœ‰å¦‚ä¸‹ç¼ºç‚¹ï¼š</p>
<ol>
<li>éœ€è¦è·Ÿè¸ª Cloudflare IPå˜åŒ–</li>
<li>éœ€è¦é…ç½®ç¹ççš„iptablesã€nginxæˆ–è€…WAFç­‰è§„åˆ™ï¼Œé…ç½®èµ·æ¥ä¼šæ¯”è¾ƒéº»çƒ¦</li>
<li>80å’Œ443çš„è§„åˆ™éƒ½è¦é…ä¸€é</li>
<li>è´¹å¿ƒè´¹æ—¶è´¹åŠ›</li>
<li>ä¸€ä¸å°å¿ƒæ‰‹æŠ–é…ç½®é”™äº†å¯èƒ½è‡ªå·±éƒ½æ²¡æ³•SSH</li>
<li>å¦‚æœä½ ç”¨dockerï¼Œè¿˜ä¼šå‘ç°<a target="_blank" rel="noopener" href="https://dmesg.app/ufw-vs-docker.html">dockerèƒ½ç»™ä½ çš„iptableså¼€ä¸ªæ´ ğŸ¤¦</a></li>
</ol>
<h2 id="Cloudflare-Argo-Tunnelæ˜¯æœªæ¥"><a href="#Cloudflare-Argo-Tunnelæ˜¯æœªæ¥" class="headerlink" title="Cloudflare Argo Tunnelæ˜¯æœªæ¥"></a>Cloudflare Argo Tunnelæ˜¯æœªæ¥</h2><p>Argo Tunnelä¼šåœ¨ä½ çš„æœåŠ¡å™¨å’ŒCloudflare ä¹‹é—´åˆ›å»ºä¸€ä¸ªåŠ å¯†çš„å®‰å…¨éš§é“ï¼Œç„¶åè¿™ä¸ªéš§é“å¯ä»¥ç”¨æ¥æ‰¿è½½å¾ˆå¤šä¸åŒç§ç±»å‹çš„æµé‡ï¼Œæ¯”å¦‚ httpï¼Œtcpï¼Œsshï¼Œsmbï¼Œrdpï¼Œç”šè‡³æ˜¯ unix å¥—æ¥å­—éƒ½å¯ä»¥</p>
<p>ä½ çš„æœºå™¨æ²¡æœ‰å…¬ç½‘IPéƒ½æ²¡å…³ç³»çš„ï¼Œåªè¦ä½ çš„æœåŠ¡å™¨èƒ½å¤Ÿè¿æ¥åˆ°Cloudflareçš„ç½‘ç»œå°±å¯ä»¥ã€‚ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œç”šè‡³éƒ½ä¸ç”¨å­¦ä¹ å¥‡å¥‡æ€ªæ€ªçš„å‘½ä»¤ã€‚</p>
<p>å» Cloudflare Zero Trust â€“ Networks â€“ Tunnel åˆ›å»º Tunnelï¼ŒæœåŠ¡å™¨å®‰è£… cloudflaredï¼Œç„¶åæ·»åŠ  Public hostnameå°±å¯ä»¥äº†</p>
<p><img src="/images/2024072722290647.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ä½ çš„åº”ç”¨ç¨‹åºç”šè‡³åªç”¨ç›‘å¬åœ¨ localhostè€Œä¸æ˜¯0.0.0.0ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ çš„æœåŠ¡å™¨åªå¼€ä¸€ä¸ªSSHå°±å¤Ÿäº†</p>
<h2 id="éšè—SSH"><a href="#éšè—SSH" class="headerlink" title="éšè—SSH"></a>éšè—SSH</h2><p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥è¿SSHéƒ½éšè—èµ·æ¥ã€‚åœ¨public hostnameé‚£é‡Œåˆ›å»ºä¸€ä¸ªåŸŸåï¼Œå¦‚æœæ‹…å¿ƒå­åŸŸåè¢«æ‰«åˆ°ï¼Œé‚£å°±èµ·ä¸ªéšæœºçš„å­åŸŸå</p>
<p>åè®®é€‰æ‹© SSHï¼ŒURLé€‰æ‹© <code>127.0.0.1:22</code></p>
<p>ç„¶ååœ¨ä½ çš„ç”µè„‘ä¸Šè¿è¡Œ cloudflaredå»ºç«‹éš§é“</p>
<p>cloudflared access ssh â€“hostname something.dmesg.app â€“url 127.0.0.1:10022</p>
<h1 id="æ¥åˆ°ä½ çš„æœåŠ¡å™¨"><a href="#æ¥åˆ°ä½ çš„æœåŠ¡å™¨" class="headerlink" title="æ¥åˆ°ä½ çš„æœåŠ¡å™¨"></a>æ¥åˆ°ä½ çš„æœåŠ¡å™¨</h1><p>ssh <a href="mailto:&#x72;&#111;&#x6f;&#116;&#x40;&#x31;&#50;&#55;&#x2e;&#x30;&#46;&#48;&#x2e;&#49;">&#x72;&#111;&#x6f;&#116;&#x40;&#x31;&#50;&#55;&#x2e;&#x30;&#46;&#48;&#x2e;&#49;</a> -p 10022 </p>
<p>ä¹‹åå»å‚å•†çš„WAFé‡Œï¼Œæ¯”å¦‚ Azureæ˜¯è¿™æ ·çš„ï¼Œå…¥ç½‘å…¨éƒ¨æ‹’ç»</p>
<p><img src="/images/2024072722290775.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>Vultræ˜¯è¿™æ ·çš„ï¼Œéšä¾¿æ·»åŠ ä¸€ä¸ªdummy å…¥ç½‘è§„åˆ™</p>
<p><img src="/images/2024072722290851.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>è¿™æ ·ä½ çš„IPåœ¨å…¶ä»–äººçœ‹æ¥å®Œå…¨æ˜¯é»‘æ´ï¼Œpingä¸é€šï¼Œä»€ä¹ˆç«¯å£éƒ½æ²¡å¼€ï¼Œå°±åƒæ²¡è¢«ä½¿ç”¨ä¸€æ ·ï¼Œåªæœ‰ CloudflareçŸ¥é“èƒŒåçš„çœŸç›¸ã€‚</p>
<h2 id="éšè—åº”ç”¨ç¨‹åºå‘å¤–å‘èµ·çš„è¯·æ±‚"><a href="#éšè—åº”ç”¨ç¨‹åºå‘å¤–å‘èµ·çš„è¯·æ±‚" class="headerlink" title="éšè—åº”ç”¨ç¨‹åºå‘å¤–å‘èµ·çš„è¯·æ±‚"></a>éšè—åº”ç”¨ç¨‹åºå‘å¤–å‘èµ·çš„è¯·æ±‚</h2><p>å¦‚æœä½ çš„åº”ç”¨ç¨‹åºä¼šå‘å¤–å‘è¯·æ±‚ï¼Œè€Œè¿™ä¸ªå¤–éƒ¨æ˜¯å¯ä»¥è¢«ç”¨æˆ·è‡ªå®šä¹‰çš„ï¼Œé‚£ä¹ˆå°±å­˜åœ¨è¢«é’“é±¼çš„æƒ…å†µã€‚å³ä½¿ä½ é…ç½®çš„å†å¥½ï¼Œé‚£ä¹ˆä¹Ÿä¼šè¢«æŠ“åˆ°IPã€‚</p>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œè¦åšçš„äº‹æƒ…è‡ªç„¶æ˜¯å…¨æ–¹é¢å®¡æŸ¥ä»£ç ï¼Œå¦‚æœé‡åˆ°ä¼šè¢«é’“é±¼çš„åœ°æ–¹ï¼Œé‚£ä¹ˆéœ€è¦è®©æµé‡èµ°ä»£ç†ã€‚</p>
<p>è‡³äºèµ°ä»€ä¹ˆä»£ç†ï¼Œä¸€ç§æ–¹å¼æ˜¯èµ°å•†ä¸šVPNï¼Œæ¯”å¦‚Surfsharkä¹‹ç±»çš„ï¼Œé€šè¿‡wireguardè½¬socks5ï¼›å¦ä¸€ç§æ–¹å¼æ˜¯èµ° Cloudflare WARPï¼ŒWARPå¯ä»¥è¿è¡Œåœ¨ proxy modeè€Œä¸æ˜¯æ¥ç®¡å…¨å±€æµé‡</p>
<p>warp-cli register</p>
<h1 id="warp-ç›‘å¬æœ¬åœ°çš„11111ç«¯å£"><a href="#warp-ç›‘å¬æœ¬åœ°çš„11111ç«¯å£" class="headerlink" title="warp ç›‘å¬æœ¬åœ°çš„11111ç«¯å£"></a>warp ç›‘å¬æœ¬åœ°çš„11111ç«¯å£</h1><p>warp-cli set-proxy-port 11111</p>
<h1 id="warp-proxy-mode"><a href="#warp-proxy-mode" class="headerlink" title="warp proxy mode"></a>warp proxy mode</h1><p>warp-cli set-mode proxy</p>
<h1 id="æ°¸ä¹…å¼€å¯"><a href="#æ°¸ä¹…å¼€å¯" class="headerlink" title="æ°¸ä¹…å¼€å¯"></a>æ°¸ä¹…å¼€å¯</h1><p>warp-cli enable-always-on</p>
<p>å¯¹äºGoçš„åº”ç”¨ï¼Œè¿™æ ·å°±å¯ä»¥äº†</p>
<p>https_proxy&#x3D;socks5:&#x2F;&#x2F;127.0.0.1:11111 http_proxy&#x3D;socks5:&#x2F;&#x2F;127.0.0.1:11111 go run main.go</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ Cloudflare Workersï¼Œè¯·æ±‚ç”±Workersè½¬å‘ï¼Œä»£ç å¾ˆç®€å•</p>
<p>export default {<br>  async fetch(request: Request): Promise {<br>    &#x2F;**<br>     * Replace `remote` with the host you wish to send requests to<br>     *&#x2F;<br>    const remote &#x3D; â€œ<a href="https://example.com/">https://example.com</a>â€œ;</p>
<pre><code>return await fetch(remote, request);
</code></pre>
<p>  },<br>};</p>
<p>æ›´å…·ä½“çš„ä½¿ç”¨æ–¹å¼å¯ä»¥çœ‹ä¸‹é¢çš„å‚è€ƒé˜…è¯»</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å“è¿™ä¸ªä¸–ç•Œä¸ŠåäººçœŸçš„å¤ªå¤šäº†ï¼Œä½†æ˜¯ Cloudflare çœŸçš„å¸®åŠ©äº†æˆ‘å¾ˆå¤šï¼Œæ›´é‡è¦çš„æ˜¯è¿™ä¸€åˆ‡è¿˜éƒ½æ˜¯å…è´¹çš„ï¼</p>
<blockquote>
<p>ä¸å¾—ä¸æ„Ÿæ…¨ï¼Œã€ŒAt Cloudflare, we have our eyes set on an ambitious goal â€” to help build a better Internet.ã€ï¼ŒçœŸçš„ä¸ä»…ä»…æ˜¯ä¸€å¥å£å·ã€‚</p>
<p>â€”â€” Nova Kowk</p>
</blockquote>
<h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><ul>
<li><a target="_blank" rel="noopener" href="https://nova.moe/cloudflared-distributed/">åˆ†å¸ƒå¼éƒ¨ç½² cloudflared è®©è®¿å®¢å°±è¿‘å›æºï¼Œè¿›ä¸€æ­¥æå‡è®¿é—®é€Ÿåº¦</a></li>
<li><a target="_blank" rel="noopener" href="https://nova.moe/accelerate-and-secure-with-cloudflared/">ä½¿ç”¨ Cloudflare Argo Tunnel(cloudflared) æ¥åŠ é€Ÿå’Œä¿æŠ¤ä½ çš„ç½‘ç«™</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.webp.se/cloudflare-workers-origin-zh/">WebP Cloud ä½¿ç”¨ Cloudflare Workers å›æº</a></li>
<li><a target="_blank" rel="noopener" href="https://dmesg.app/cloudflare-access-gfwed-server.html">ä½¿ç”¨ Cloudflare Zero Trust è¿æ¥è¢«å¢™çš„æœåŠ¡å™¨</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/07/27/hide-in-cf/index/" data-id="clz73fpm100004zjfdxhg9whw" data-title="éšè—äº Cloudflare çš„å…¨çƒç½‘ç»œä¹‹ä¸­" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-azure-waf/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/07/17/azure-waf/index/" class="article-date">
  <time class="dt-published" datetime="2024-07-17T00:00:00.000Z" itemprop="datePublished">2024-07-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/07/17/azure-waf/index/">æ•‘å‘½ï¼æˆ‘çš„ Azure Front Door WAF è§„åˆ™ä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>æœ€è¿‘åœ¨ç”¨ Front DooråŠ é€Ÿç½‘ç«™è®¿é—®ï¼Œæƒ³æ·»åŠ ä¸€ä¸ªè¿™æ ·çš„è§„åˆ™ï¼šåªå…è®¸ <code>/v1</code>ä¸‹çš„è·¯å¾„å’Œç‰¹å®šå›½å®¶çš„IPï¼Œå…¶ä»–å…¨éƒ¨ç¦æ­¢ã€‚</p>
<p>è¿™å…¶å®å¾ˆç®€å•çš„ï¼åªè¦åˆ›å»ºä¸¤æ¡ WAFè§„åˆ™ï¼Œä¸€ä¸ªç¦æ­¢å…¨éƒ¨ä¼˜å…ˆçº§ä½ï¼Œä¸€ä¸ªå…è®¸ç‰¹å®šè·¯å¾„ï¼Œä¼˜å…ˆçº§é«˜ã€‚</p>
<h2 id="100ä¼˜å…ˆçº§çš„å…è®¸è§„åˆ™"><a href="#100ä¼˜å…ˆçº§çš„å…è®¸è§„åˆ™" class="headerlink" title="100ä¼˜å…ˆçº§çš„å…è®¸è§„åˆ™"></a>100ä¼˜å…ˆçº§çš„å…è®¸è§„åˆ™</h2><p><img src="/images/2024071623480019.png"></p>
<p>çœ‹èµ·æ¥ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰å§ï¼Œéå¸¸ç®€å•å®¹æ˜“ç†è§£</p>
<h2 id="500-ä¼˜å…ˆçº§é˜»æ­¢è§„åˆ™"><a href="#500-ä¼˜å…ˆçº§é˜»æ­¢è§„åˆ™" class="headerlink" title="500 ä¼˜å…ˆçº§é˜»æ­¢è§„åˆ™"></a>500 ä¼˜å…ˆçº§é˜»æ­¢è§„åˆ™</h2><p><img src="/images/2024071623480112.png"></p>
<p>ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œé˜»æ­¢å…¨éƒ¨</p>
<h2 id="æ²¡ç”¨ï¼"><a href="#æ²¡ç”¨ï¼" class="headerlink" title="æ²¡ç”¨ï¼"></a>æ²¡ç”¨ï¼</h2><p>é…ç½®ä¸‹æ¥å°±æ˜¯ä¸ç”Ÿæ•ˆï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½è¢«é˜»æ­¢äº†ã€‚ç»™é˜»æ­¢è§„åˆ™åœç”¨ï¼Œå°±å…¨éƒ¨èƒ½è®¿é—®ã€‚</p>
<p>ä»<code>azure-cli</code>é‡Œçœ‹ä¸‹WAFçš„é…ç½®ï¼Œé¿å…ä»–ä»¬å‰ç«¯æœ‰bug</p>
<p>{<br>    â€œrulesâ€: [<br>        {<br>            â€œactionâ€: â€œAllowâ€,<br>            â€œenabledStateâ€: â€œEnabledâ€,<br>            â€œgroupByâ€: [],<br>            â€œmatchConditionsâ€: [<br>                {<br>                    â€œmatchValueâ€: [<br>                        â€œ&#x2F;v1â€<br>                    ],<br>                    â€œmatchVariableâ€: â€œRequestUriâ€,<br>                    â€œnegateConditionâ€: false,<br>                    â€œoperatorâ€: â€œBeginsWithâ€,<br>                    â€œtransformsâ€: []<br>                },<br>                {<br>                    â€œmatchValueâ€: [<br>                        â€œCNâ€<br>                    ],<br>                    â€œmatchVariableâ€: â€œSocketAddrâ€,<br>                    â€œnegateConditionâ€: false,<br>                    â€œoperatorâ€: â€œGeoMatchâ€,<br>                    â€œtransformsâ€: []<br>                }<br>            ],<br>            â€œnameâ€: â€œAllowâ€,<br>            â€œpriorityâ€: 100,<br>            â€œrateLimitDurationInMinutesâ€: 1,<br>            â€œrateLimitThresholdâ€: 100,<br>            â€œruleTypeâ€: â€œMatchRuleâ€<br>        },<br>        {<br>            â€œactionâ€: â€œBlockâ€,<br>            â€œenabledStateâ€: â€œEnabledâ€,<br>            â€œgroupByâ€: [],<br>            â€œmatchConditionsâ€: [<br>                {<br>                    â€œmatchValueâ€: [],<br>                    â€œmatchVariableâ€: â€œRequestUriâ€,<br>                    â€œnegateConditionâ€: false,<br>                    â€œoperatorâ€: â€œAnyâ€,<br>                    â€œtransformsâ€: []<br>                }<br>            ],<br>            â€œnameâ€: â€œDenyâ€,<br>            â€œpriorityâ€: 500,<br>            â€œrateLimitDurationInMinutesâ€: 1,<br>            â€œrateLimitThresholdâ€: 100,<br>            â€œruleTypeâ€: â€œMatchRuleâ€<br>        }<br>    ]<br>}</p>
<p>ä»ç»“æœæ¥çœ‹ï¼Œå®Œå…¨æ²¡é—®é¢˜ã€‚ç»™è§„åˆ™ä» begins with æ”¹æˆ containsåˆå¯ä»¥ï¼Œä½†æ˜¯é‚£ä¹Ÿæ„å‘³ç€<code>https://cn-test.burn.hair/login?id=v1</code>ä¹Ÿä¼šå…è®¸ï¼Œè€Œè¿™ä¸å¤ªè¡Œ</p>
<p><img src="/images/2024071623480151.png"></p>
<h2 id="çœ‹çœ‹-log"><a href="#çœ‹çœ‹-log" class="headerlink" title="çœ‹çœ‹ log"></a>çœ‹çœ‹ log</h2><p>æ²¡åŠæ³•äº†ï¼Œå¼€ log è¯•è¯•çœ‹å§ï¼Œä¸è¡Œå°±è”ç³» Azure Support</p>
<p>å…ˆè¦å» Log Analytics workspaces é‡Œå¼€ä¸€ä¸ªè®°å½•æ—¥å¿—çš„å¥‡æ€ªçš„ä¸œè¥¿</p>
<p><img src="/images/202407162348023.png"></p>
<p>ç„¶åå» Diagnostic settings é‡Œ æŠŠè¿™ä¸ªä¸œè¥¿å’Œ Front Doorã€Workspaceså…³è”èµ·æ¥</p>
<p><img src="/images/2024071623480237.png"></p>
<p>ç„¶åå»logé¡µé¢è¿è¡Œè¿™æ ·çš„ä¸€ä¸ªæŸ¥è¯¢ï¼Œç»äº†è¿çœ‹æ—¥å¿—éƒ½å¾—å­¦ä¹ æŸ¥è¯¢è¯­æ³•ğŸ˜“</p>
<p>AzureDiagnostics<br>| where ResourceProvider &#x3D;&#x3D; â€œMICROSOFT.NETWORKâ€ and Category &#x3D;&#x3D; â€œFrontdoorWebApplicationFirewallLogâ€</p>
<p>ç„¶åå°±èƒ½çœ‹åˆ° WAFçš„æ—¥å¿—äº†</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/07/2024071623525456.png"><img src="/images/2024071623525456.png"></a></p>
<h2 id="ä»€ä¹ˆï¼Ÿï¼Ÿ"><a href="#ä»€ä¹ˆï¼Ÿï¼Ÿ" class="headerlink" title="ä»€ä¹ˆï¼Ÿï¼Ÿ"></a>ä»€ä¹ˆï¼Ÿï¼Ÿ</h2><p>WTFï¼Ÿè°å®¶ <code>requestUri</code>è¿™ä¹ˆå†™å•Š è¿˜å¸¦ç«¯å£çš„ï¼Œæ€ªä¸å¾—æˆ‘é…ç½®çš„ begins with &#x2F;v1 ä¸å¥½ç”¨ï¼Œä½†æ˜¯containså°±è¡Œâ€¦â€¦</p>
<p><img src="/images/202407162348049.png" alt="å›¾ç‰‡åŒ…å« å¾½æ ‡ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç«é€Ÿå» WAF é‡Œï¼Œæ”¹ä¸€ä¸‹è§„åˆ™ï¼Œç»™matches valueæ”¹æˆå®Œæ•´çš„è·¯å¾„å°±å¥½äº†</p>
<p><a target="_blank" rel="noopener" href="https://cn-test.burn.hair/v1">https://cn-test.burn.hair:443/v1</a></p>
<p><img src="/images/2024071623480516.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ğŸ˜¢ é—®é¢˜è§£å†³äº†ï¼Œå¼€çš„å„ç§ä¸œè¥¿å¯ä»¥å» Resource Group é‡Œåˆ é™¤äº†</p>
<hr>
<p>ã€Œä¸æ„§æ˜¯ Azureï¼Œä»å®šä»·ï¼Œåˆ°æ–‡æ¡£ï¼Œåˆ°ä½¿ç”¨ï¼Œæ²¡ä¸€ä¸ªç¬¦åˆç›´è§‰ã€</p>
<p>â€”â€” Nova Kowk</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/07/17/azure-waf/index/" data-id="clyujt8ar00015yjf53hmhquz" data-title="æ•‘å‘½ï¼æˆ‘çš„ Azure Front Door WAF è§„åˆ™ä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-azure-fd/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/07/16/azure-fd/index/" class="article-date">
  <time class="dt-published" datetime="2024-07-16T00:00:00.000Z" itemprop="datePublished">2024-07-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/07/16/azure-fd/index/">ä½¿ç”¨Azure Front Door å’Œ Load Balancer</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ä¸€èˆ¬æ¥è¯´ï¼Œåšä¸ªç½‘ç«™ï¼Œå¹¶å¼€æ”¾ç»™å…¨ä¸–ç•Œï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<ol>
<li>ç›´æ¥ä½¿ç”¨å…¬ç½‘IP+ç«¯å£å·</li>
<li>ä¹°ä¸ªåŸŸåï¼Œåšè§£æï¼Œä½¿ç”¨åŸŸåè®¿é—®</li>
<li>å¥—ä¸Š Cloudflareï¼Œè®© Cloudflareå»åå‘ä»£ç†æºç«™</li>
<li>ç”¨ Cloudflare Argo Tunnelï¼ŒæœåŠ¡å™¨æœ‰æ²¡æœ‰å…¬ç½‘IPéƒ½æ— æ‰€è°“äº†</li>
<li>å…¶ä»–CDNæ–¹æ¡ˆ</li>
</ol>
<p>æœ€è¿‘åœ¨ç”¨ Azureï¼Œä¸€ç›´æƒ³åˆ©ç”¨ä¸€ä¸‹ä»–ä»¬çš„Front Doorã€‚ç®€å•çš„æ‘¸ç´¢äº†ä¸€ä¸‹å¦‚ä½•æŠŠFront Doorã€Load Balancer å’Œ vmä¸‰è€…ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p>
<h2 id="åˆ›å»ºä¸€å°-vm"><a href="#åˆ›å»ºä¸€å°-vm" class="headerlink" title="åˆ›å»ºä¸€å° vm"></a>åˆ›å»ºä¸€å° vm</h2><p>ä¸åˆ†é…å…¬ç½‘ IP æ²¡å…³ç³»ï¼Œç®€å•èµ·è§è¿™é‡Œå…ˆåªåˆ›å»ºä¸€ä¸ªäº†</p>
<h2 id="åˆ›å»º-LB"><a href="#åˆ›å»º-LB" class="headerlink" title="åˆ›å»º LB"></a>åˆ›å»º LB</h2><p><img src="/images/2024071603033180.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç»™ LBçš„ç±»å‹è®¾ç½®ä¸º Publicï¼Œåˆ›å»ºä¸€ä¸ªIPï¼Œå¯ä»¥é€‰Microsoftç½‘ç»œä¹Ÿå¯ä»¥é€‰å…¬ç½‘ï¼Œå…·ä½“åŒºåˆ«å¯ä»¥çœ‹ <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure/virtual-network/ip-services/routing-preference-overview">https://learn.microsoft.com/zh-cn/azure/virtual-network/ip-services/routing-preference-overview</a></p>
<p><img src="/images/2024071603033238.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>æ·»åŠ  NICï¼Œé€‰æ‹©è™šæ‹Ÿæœºçš„é‚£ä¸ªç½‘å¡</p>
<p><img src="/images/2024071603033362.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>æ­¤è´Ÿè½½å‡è¡¡å™¨ä¼šæœ‰ä¸€ä¸ªå…¬ç½‘IPåœ°å€ï¼Œå¹¶ä¸”è¿æ¥åˆ°äº†æˆ‘ä»¬çš„vnetï¼Œåªæ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰å®šä¹‰ NATå‡ºå…¥è§„åˆ™ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»§ç»­é…ç½®</p>
<p>æ‰“å¼€LBçš„Inbound NAT rulesï¼Œç”±äºæˆ‘ä»¬çš„backendå…¶å®åªæœ‰ä¸€å°vmï¼Œå› æ­¤ç±»å‹é€‰æ‹© azure è™šæ‹Ÿæœºå°±å¯ä»¥äº†</p>
<p><img src="/images/2024071603033459.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>è¿™ä¸ªæ—¶å€™ ssh å°±ä¼šå‘ç°èƒ½å¤Ÿè¿åˆ°vmå•¦ï¼Œä½†æ˜¯vmè¿˜ä¸Šä¸äº†ç½‘</p>
<p><img src="/images/2024071603033588.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>è¦æ·»åŠ å‡ºç½‘è§„åˆ™æœºå™¨æ‰èƒ½ä¸Šç½‘ï¼Œoutbound rulesä¸­æ·»åŠ ä¸€ä¸ª</p>
<p><img src="/images/2024071603033620.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>Port allocation é€‰æ‹© defaultå°±è¡Œ</p>
<p>è¿™ä¸ªæ—¶å€™æœºå™¨å°±å¯ä»¥ä¸Šç½‘äº†ï¼Œä½“éªŒäº†ä¸€æŠŠè‡ªå·±é…ç½® SNATçš„å¿«æ„ŸğŸ¤¡</p>
<p>é‚£å°±å…ˆè·‘ä¸ªnginx æ–¹ä¾¿æˆ‘ä»¬åç»­æµ‹è¯• http</p>
<p>sudo docker run -d -p 80:80 nginx:alpine<br>curl localhost</p>
<p>ä¹‹åæ—¶å€™ä½ åœ¨è¿™å°æœºå™¨å¤–é¢ <code>curl</code> è¿˜æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿˜å¾—ç»§ç»­åŠ ä¸€æ¡ inbound 80 è§„åˆ™å’Œä¸Šé¢ä¸€æ ·ï¼Œè¿™æ—¶åœ¨å¤–é¢å°±å¯ä»¥è®¿é—®å•¦ï¼</p>
<h2 id="åˆ›å»º-Front-Door"><a href="#åˆ›å»º-Front-Door" class="headerlink" title="åˆ›å»º Front Door"></a>åˆ›å»º Front Door</h2><p>Front dooræœ‰ä¸‰ç§ï¼ŒClassicã€Standardã€Premium</p>
<p>Classicå³å°†åœ¨2027å¹´3æœˆé€€å½¹</p>
<p>Classic æŒ‰ç…§æµé‡å’Œè·¯ç”±è§„åˆ™ã€WAFç­‰è®¡è´¹ï¼ŒStandardã€Premiumåˆ™æ˜¯æœˆè´¹ã€æµé‡å’Œè¯·æ±‚æ•°é‡è®¡è´¹ã€‚</p>
<p>æŒ‰ç…§æç¤ºæ¥å°±è¡Œï¼Œä¹‹å Front Doorä¼šè®©æˆ‘ä»¬é…ç½®</p>
<h3 id="Domain"><a href="#Domain" class="headerlink" title="Domain"></a>Domain</h3><p>Domain é‚£é‡Œå°±é€‰åˆ›å»º Front Doorçš„æ—¶å€™çš„é‚£ä¸ªåŸŸå</p>
<p><img src="/images/2024071603033773.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="Backend-pools"><a href="#Backend-pools" class="headerlink" title="Backend pools"></a>Backend pools</h3><p>éœ€è¦æ³¨æ„è¿™é‡Œ https portä¹Ÿè¦å†™80</p>
<p>å› ä¸ºåœ¨æˆ‘ä»¬çš„vmä¸Šåªè·‘äº†80ç«¯å£ï¼Œæ‰€ä»¥åªèƒ½éƒ½80ã€‚å¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ˜¯è·‘åœ¨å…¶ä»–ç«¯å£çš„è¯ï¼Œä¹Ÿè¦è·Ÿç€æ›´æ”¹</p>
<p><img src="/images/2024071603033839.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="routing-rules"><a href="#routing-rules" class="headerlink" title="routing rules"></a>routing rules</h3><p>è¦æ³¨æ„ forwarding protocol é€‰æ‹© http onlyï¼ŒåŸå› åŒä¸Š</p>
<p><img src="/images/2024071603033860.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, ç”µå­é‚®ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç„¶åéƒ¨ç½²ï¼Œç­‰å‡ åˆ†é’Ÿï¼Œå°±æœ‰å•¦</p>
<p><img src="/images/2024071603033997.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, ç”µå­é‚®ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>Azure Front Door Premium å¯ä»¥ç”¨ Private Link è¿æ¥åˆ°å†…éƒ¨è´Ÿè½½å‡è¡¡å™¨ã€‚ä½†æ˜¯ Premium æœˆè´¹è¦330ç¾å…ƒï¼Œæˆ‘å¯èƒ½ç¡®å®ç”¨ä¸èµ·â€¦â€¦</li>
<li>å¦‚æœå•æœºæ€§èƒ½è¶³å¤Ÿï¼Œé‚£ä¹ˆç»™vmåˆ†é…ä¸ªå…¬ç½‘IPï¼Œç„¶åé…ç½® Front Doorå†™è¿™ä¸ªIPå°±è¡Œ</li>
<li>å¦‚æœå•æœºæ€§èƒ½ä¸å¤Ÿï¼Œé‚£ä¹ˆå¯ä»¥å†åŠ å¤šå°vmï¼Œç„¶åç”¨LBåšè´Ÿè½½å‡è¡¡ï¼›ä¹Ÿå¯ä»¥ç›´æ¥ Front Door åŠ  backend pool</li>
<li>èµ°å¾®è½¯å…¨çƒç½‘ç»œè·¯ç”±çš„æ€§èƒ½åº”è¯¥ä¸é”™</li>
</ol>
<h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/frontdoor/front-door-faq">https://learn.microsoft.com/en-us/azure/frontdoor/front-door-faq</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure/frontdoor/standard-premium/how-to-enable-private-link-internal-load-balancer">https://learn.microsoft.com/zh-cn/azure/frontdoor/standard-premium/how-to-enable-private-link-internal-load-balancer</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/07/16/azure-fd/index/" data-id="clyujt89y00005yjf7dlbdiq6" data-title="ä½¿ç”¨Azure Front Door å’Œ Load Balancer" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-usdt-trc20-scam/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/30/usdt-trc20-scam/index/" class="article-date">
  <time class="dt-published" datetime="2024-04-30T00:00:00.000Z" itemprop="datePublished">2024-04-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/what/">what</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/30/usdt-trc20-scam/index/">è­¦æƒ•USDT-TRC20 æ•°å­—è´§å¸è¯ˆéª—</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>æœ€è¿‘çœ‹åˆ°ä¸€ç§å¾ˆæœ‰è¶£çš„æ•°å­—è´§å¸è¯ˆéª—æ–¹æ³•ï¼Œæœ‰äººæœ‰æ„æ— æ„åœ¨ç¾¤é‡Œã€è®ºå›æˆ–è€…å…¶ä»–å…¬å¼€çš„åœ°æ–¹ï¼Œæ³„æ¼è‡ªå·±çš„åŠ©è®°è¯ï¼Œå¾€å¾€æ˜¯Tronè¿™ä¸ªé“¾ï¼Œç„¶åè¿™ä¸ªé’±åŒ…é‡Œæœ‰å¤§æ¦‚å‡ ååˆ°å‡ ç™¾USDTï¼Œæ¯”å¦‚ä¸‹å›¾è¿™æ ·</p>
<p><img src="/images/202404300152573.png" alt="A screenshot of a phone Description automatically generated"></p>
<p>ä¸€èˆ¬æ¥è¯´è¿™ç§é’±åŒ…TRXä¼šæ¯”è¾ƒå°‘ï¼Œå¤šä¸€ç‚¹çš„ä¹Ÿæœ‰ï¼Œå…¶å®æ²¡å…³ç³»çš„ã€‚</p>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿›è¡Œ USDT è½¬è´¦æ˜¯éœ€è¦ TRXåšç‡ƒæ–™çš„ã€‚æœ‰äº›äººå¯èƒ½å°±æƒ³åˆ°äº†â€¦â€¦</p>
<ol>
<li>æ—¢ç„¶æœ‰åŠ©è®°è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¯¼å…¥åˆ°è‡ªå·±çš„é’±åŒ…é‡Œ</li>
<li>ä»åˆ«çš„åœ°æ–¹è½¬è¿›æ¥å‡ å TRXåšgas</li>
<li>ç„¶åæŠŠè¿™å‡ ç™¾USDTè½¬èµ°ï¼Œç™½å«–æˆåŠŸ</li>
</ol>
<p>äº‹æƒ…å“ªæœ‰é‚£ä¹ˆç®€å•ï¼</p>
<h2 id="å·å–ç‡ƒæ–™è´¹"><a href="#å·å–ç‡ƒæ–™è´¹" class="headerlink" title="å·å–ç‡ƒæ–™è´¹"></a>å·å–ç‡ƒæ–™è´¹</h2><p>å½“ä½ æŠŠ TRX è½¬è¿›æ¥ä¹‹åï¼Œè¿˜æ²¡ç­‰è¿™ç¬”é’±çƒ­ä¹ï¼Œå°±ä¼šè¢«ç¬é—´è½¬èµ°ï¼</p>
<p>æ¯”å¦‚åœ¨ä¸Šå›¾ä¸­æˆ‘ä»¬çœ‹åˆ°çš„è¿™ä¸ªä¾‹å­ï¼Œä»–çš„åœ°å€æ˜¯ TAvwgoX6zbExfotsgP351QxxCoHGH8mmyb ï¼Œé€šè¿‡æŸ¥è¯¢ tronscanæˆ‘ä»¬å¯ä»¥æŸ¥è¯¢ä¸€ä¸ªåœ°å€çš„æ‰€æœ‰äº¤æ˜“è®°å½•ï¼Œæˆ‘è¿™é‡Œç”¨ä¸åŒé¢œè‰²çš„åšäº†æ ‡è®°ï¼š</p>
<p><img src="/images/2024043001525863.png" alt="A screenshot of a computer Description automatically generated"></p>
<p>æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°ï¼Œå—å®³è€…å‘ mmybçš„åœ°å€è½¬è´¦ï¼Œæ…¢åˆ™5åˆ†é’Ÿï¼Œå¿«åˆ™å‡ åç§’ï¼Œè¿™ç¬”TRXå°±ä¼šè¢«è½¬åˆ° Mh4J çš„åœ°å€ã€‚æˆªæ­¢åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™ä¸ªåœ°å€å·²ç»éª—äº†$90äº†ã€‚</p>
<p>æˆ‘è¿˜æœ‰å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„æ‰‹æ®µ</p>
<p><img src="/images/2024043001525832.png" alt="A screenshot of a computer Description automatically generated"></p>
<h2 id="æ‹¼æ‰‹é€Ÿï¼Ÿ"><a href="#æ‹¼æ‰‹é€Ÿï¼Ÿ" class="headerlink" title="æ‹¼æ‰‹é€Ÿï¼Ÿ"></a>æ‹¼æ‰‹é€Ÿï¼Ÿ</h2><p>å‡å¦‚ä½ ä¹Ÿä¼šå†™ç‚¹ä»£ç ï¼Œä½ å¯èƒ½åœ¨æƒ³ï¼Œå“ä¸å°±æ˜¯æ‹¼æ‰‹é€Ÿå˜›ï¼è½¬ç‚¹TRXè¿›å»ï¼Œç„¶åç¬é—´å†è½¬èµ° USDTï¼Œå…¨ç¨‹ä»£ç æ“ä½œå»¶è¿Ÿ1ç§’ï¼Œé‚£ä¸å°±ç™½å«–æˆåŠŸäº†å˜›ï¼</p>
<p>æœ‰è¿™ç§æƒ³æ³•ä¸å¾—ä¸è¯´éå¸¸èªæ˜ï¼Œç„¶è€Œéª—å­ä¹Ÿæ—©å°±æƒ³åˆ°äº†è¿™ä¸€ç‚¹ï¼Œéª—å­ä¹Ÿä¸æƒ³å·é¸¡ä¸æˆèš€æŠŠç±³ã€‚å¦‚æœä½ æ³¨æ„çœ‹ tronscanåœ°å€ä¸‹çš„æç¤ºä¿¡æ¯ï¼š</p>
<p><img src="/images/2024043001525929.png" alt="A close-up of a computer screen Description automatically generated"></p>
<blockquote>
<p>The current accountâ€™s â€œOwner Permissionâ€ is authorized to:TDtwL9uggJ1qBhWW83z6q7ssNdhi12356L</p>
<p>The current accountâ€™s â€œActive Permissionâ€ is authorized to:TDtwL9uggJ1qBhWW83z6q7ssNdhi12356LView Account Permission</p>
</blockquote>
<p>Tronçš„ä¸€ä¸ªç‰¹æ€§ä¹‹ä¸€æ˜¯ï¼Œå¯ä»¥æŠŠè‡ªå·±åœ°å€çš„æƒé™è½¬ç§»ç»™å¦ä¸€ä¸ªåœ°å€ã€‚æƒé™æœ¬èº«æ˜¯ç‹¬ç«‹çš„ã€å”¯ä¸€å½’å±çš„ï¼Œè¦ä¹ˆå½’ä½ è¦ä¹ˆå½’æˆ‘ã€‚</p>
<p>é€šå¸¸æ¥è¯´æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªåœ°å€å¯¹åº”çš„ç§é’¥ç­¾åçš„ï¼Œä½†æ˜¯æŠŠæƒé™è½¬ç§»ç»™å¦å¤–ä¸€ä¸ªåœ°å€ä¹‹åï¼Œå°±å¯ä»¥ç”¨é‚£ä¸ªåœ°å€çš„ç§é’¥ç­¾åäº†ã€‚</p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ªèœœç½åœ°å€ mmyb çš„å…¨éƒ¨æƒé™éƒ½è¢«è½¬ç§»ç»™äº†å¦å¤–ä¸€ä¸ª 356Lçš„åœ°å€ï¼Œmmybçš„ç§é’¥å› ä¸ºç¼ºå¤±æƒé™ï¼Œæ˜¯æ— æ³•ç­¾åäº¤æ˜“çš„ã€‚ [v_blue]æ›´è¿›ä¸€æ­¥ï¼ŒTronè¿˜å¯ä»¥è®¾ç½®mult-sigï¼ˆå¤šé‡ç­¾åï¼‰ï¼Œéœ€è¦å¤šä¸ªç§é’¥+æƒé‡è®¡ç®—æ‰å¯ä»¥å®ŒæˆæŸä¸ªæ“ä½œï¼Œæœ‰ç‚¹åƒå¤§å®¶å¼€ä¼šè¡¨å†³ã€‚ [&#x2F;v_blue] ğŸ˜‚æ‰€ä»¥ï¼Œå³ä½¿ä½ æ‰‹é€Ÿå¤Ÿå¿«ï¼Œä¹Ÿä¼šå‘ç°è‡ªå·±æ²¡æƒé™åŠ¨è¿™ä¸ªèµ„é‡‘ã€‚</p>
<p>å½“ç„¶äº†ï¼Œå¦‚æœä½ å‘ç°ä¸€ä¸ªåœ°å€çš„æƒé™æ²¡æœ‰è¢«æ›´æ”¹è¿‡ï¼Œé‚£å¯èƒ½ç¡®å®æ˜¯å¤©ä¸Šæ‰é¦…é¥¼äº†ã€‚</p>
<h2 id="æˆ‘è¢«éª—äº†å—"><a href="#æˆ‘è¢«éª—äº†å—" class="headerlink" title="æˆ‘è¢«éª—äº†å—"></a>æˆ‘è¢«éª—äº†å—</h2><p>å“ˆï¼ğŸ˜ğŸ˜ğŸ˜</p>
<p><img src="/images/2024043001530159.png" alt="A screenshot of a video game Description automatically generated"></p>
<p>å“ˆï¼Œä½ ç»ˆäºé¢†æ‚Ÿäº†æˆä¸ºä¼ å¥‡çš„è¯€çªâ€¦â€¦æ‹¿ä¸Šä½ çš„å®¶ä¼™ï¼Œå’±ä»¬èµ°ã€‚</p>
<hr>
<p>æˆ‘å¯æ˜¯ä¼ å¥‡ï¼Œæƒ³è¦éª—æˆ‘å¯æ²¡é‚£ä¹ˆå®¹æ˜“ğŸ˜‰ğŸ˜‰ğŸ˜‰</p>
<h2 id="å‚è€ƒé˜…è¯»"><a href="#å‚è€ƒé˜…è¯»" class="headerlink" title="å‚è€ƒé˜…è¯»"></a>å‚è€ƒé˜…è¯»</h2><p><a target="_blank" rel="noopener" href="https://www.exodus.com/support/en/articles/8598817-what-crypto-scams-should-i-watch-out-for#honeypot">https://www.exodus.com/support/en/articles/8598817-what-crypto-scams-should-i-watch-out-for#honeypot</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/04/30/usdt-trc20-scam/index/" data-id="clyujt8bi00075yjff1921dwp" data-title="è­¦æƒ•USDT-TRC20 æ•°å­—è´§å¸è¯ˆéª—" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-telegram-login-widget-verify-data/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/21/telegram-login-widget-verify-data/index/" class="article-date">
  <time class="dt-published" datetime="2024-04-21T00:00:00.000Z" itemprop="datePublished">2024-04-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/21/telegram-login-widget-verify-data/index/">Telegram Login Widget å¦‚ä½•éªŒè¯ç”¨æˆ·æ•°æ®</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://core.telegram.org/widgets/login">Telegram åšOAuth</a>æ˜¯ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹æƒ…ï¼Œæ¯•ç«Ÿæ•´ä¸ª Telegram API éƒ½ç›¸å½“å¼€æ”¾ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦éªŒè¯ç”¨æˆ·çš„æ•°æ®ç¡®å®æ˜¯æ¥è‡ªäº Telegramè€Œä¸æ˜¯ç¬¬ä¸‰æ–¹ä¼ªé€ çš„ã€‚æ— è®ºæ˜¯åœ¨å›è°ƒå‡½æ•°è¿˜æ˜¯å›è°ƒURLä¸­ï¼ŒTelegraméƒ½ä¼šæä¾›å¦‚ä¸‹å‚æ•°ï¼š id, first_name, last_name, username, photo_url, auth_date, hash æ ¹æ®å®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼ŒéªŒè¯æ•°æ®åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>Â æŠŠè¿™äº›å­—æ®µæŒ‰ç…§å­—æ¯é¡ºåºæ’åºï¼Œç»„æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸€ä¸ªé”®å€¼å¯¹ä¹‹é—´ç”¨æ¢è¡Œç¬¦éš”å¼€ï¼Œå¦‚ <code>&#39;auth_date=&lt;auth_date&gt;\nfirst_name=&lt;first_name&gt;\nid=&lt;id&gt;\nusername=&lt;username&gt;&#39;</code></li>
<li>è®¡ç®— bot token çš„ sha256</li>
<li>è®¡ç®— HMAC_SHA256ï¼Œæ˜æ–‡æ˜¯ä¸Šé¢çš„è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¯†ç æ˜¯bot token çš„sha256ï¼Œç„¶åè®¡ç®—è¿™ä¸ªç»“æœçš„hexï¼Œæ¯”å¯¹ä¸ä»–æä¾›çš„ hashæ˜¯å¦ç›¸ç­‰</li>
</ol>
<p>çœ‹èµ·æ¥å¾ˆç®€å•æ˜¯ä¸æ˜¯ï¼Œéšä¾¿ä¸¢ç»™ ChatGPTå°±èƒ½å‡ºç»“æœã€‚ç”šè‡³å®˜æ–¹è¿˜ç»™äº†ä¸ª<a target="_blank" rel="noopener" href="https://gist.github.com/anonymous/6516521b1fb3b464534fbc30ea3573c2">PHPçš„ä»£ç </a></p>
<p>ä½†æ˜¯å¾ˆæŠ±æ­‰çš„æ˜¯ï¼Œè¿™æ ·å¹¶ä¸èƒ½ç»™ä¿è¯100%éªŒè¯æˆåŠŸï¼Œç”šè‡³å¯èƒ½ä¼šå®Œå…¨æ— æ³•éªŒè¯ã€‚ä»¥ä¸‹æ˜¯æˆ‘è¸©çš„ä¸¤ä¸ªå‘</p>
<h2 id="hashå­—æ®µè¦æ’é™¤"><a href="#hashå­—æ®µè¦æ’é™¤" class="headerlink" title="hashå­—æ®µè¦æ’é™¤"></a>hashå­—æ®µè¦æ’é™¤</h2><p>åœ¨ç»„è£…å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè®°å¾—æ’é™¤hashå­—æ®µï¼Œè¦ä¸ç„¶æ˜¯ä¸å¯èƒ½è®¡ç®—å‡ºæ­£ç¡®çš„ç»“æœçš„ã€‚</p>
<h2 id="å€¼æ˜¯ç©ºçš„å­—æ®µè¦æ’é™¤"><a href="#å€¼æ˜¯ç©ºçš„å­—æ®µè¦æ’é™¤" class="headerlink" title="å€¼æ˜¯ç©ºçš„å­—æ®µè¦æ’é™¤"></a>å€¼æ˜¯ç©ºçš„å­—æ®µè¦æ’é™¤</h2><p>åœ¨ Telegram ä¸­ï¼Œusernameã€photo_url ç­‰å­—æ®µä¸æ˜¯å¿…é¡»çš„ã€‚åœ¨è®¡ç®—æ—¶ï¼Œè¿™ç§ç±»å‹çš„å­—æ®µ<strong>å¦‚æœä¸ºç©ºï¼Œé‚£ä¹ˆä¸éœ€è¦è€ƒè™‘</strong>ã€‚</p>
<p>å¯æ€•çš„æ˜¯ï¼Œæ— è®ºæ˜¯å®˜æ–¹æ–‡æ¡£ï¼Œè¿˜æ˜¯PHPç¤ºä¾‹ä»£ç ï¼Œéƒ½æ²¡æœ‰æåˆ°å€¼æ˜¯ç©ºçš„å­—æ®µä¸å‚ä¸è®¡ç®—çš„äº‹æƒ…ã€‚ğŸ˜¢</p>
<h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><h3 id="Go-çš„ç¤ºä¾‹ä»£ç "><a href="#Go-çš„ç¤ºä¾‹ä»£ç " class="headerlink" title="Go çš„ç¤ºä¾‹ä»£ç "></a>Go çš„ç¤ºä¾‹ä»£ç </h3><p>type TelegramAuthData struct {<br>    Id        int    `json:â€idâ€`<br>    FirstName string `json:â€first_nameâ€`<br>    LastName  string `json:â€last_nameâ€`<br>    Username  string `json:â€usernameâ€`<br>    PhotoUrl  string `json:â€photo_urlâ€`<br>    AuthDate  int    `json:â€auth_dateâ€`<br>    Hash      string `json:â€hashâ€`<br>}</p>
<p>func verifyTelegramAuthData(data TelegramAuthData) bool {<br>    &#x2F;&#x2F; Extracting fields and preparing for sorting.<br>    fields :&#x3D; map[string]string{<br>        â€œauth_dateâ€:  strconv.Itoa(data.AuthDate),<br>        â€œfirst_nameâ€: data.FirstName,<br>        â€œlast_nameâ€:  data.LastName,<br>        â€œidâ€:         strconv.Itoa(data.Id),<br>        â€œphoto_urlâ€:  data.PhotoUrl,<br>        â€œusernameâ€:   data.Username,<br>    }</p>
<pre><code>// Sorting the fields to create the data-check-string.
var keys \[\]string
for key := range fields &#123;
    keys = append(keys, key)
&#125;
sort.Strings(keys)

var dataCheckString string
for \_, key := range keys &#123;
    if fields\[key\] != &quot;&quot; &#123;
        dataCheckString += fmt.Sprintf(&quot;%s=%s\\n&quot;, key, fields\[key\])
    &#125;
&#125;
dataCheckString = dataCheckString\[:len(dataCheckString)-1\] // Remove the last newline character

// Calculate the SHA256 hash of the bot&#39;s token.
hasher := sha256.New()
hasher.Write(\[\]byte(botToken))
secretKey := hasher.Sum(nil)

// Compute the HMAC-SHA-256 signature.
hmacHasher := hmac.New(sha256.New, secretKey)
hmacHasher.Write(\[\]byte(dataCheckString))
computedHash := hex.EncodeToString(hmacHasher.Sum(nil))

// Compare the computed HMAC with the received hash.
return computedHash == data.Hash
</code></pre>
<p>}</p>
<h3 id="Python-ç‰ˆæœ¬"><a href="#Python-ç‰ˆæœ¬" class="headerlink" title="Python ç‰ˆæœ¬"></a>Python ç‰ˆæœ¬</h3><p>def verify_telegram_authdata(data: dict) -&gt; bool:<br>    # Extracting fields and preparing for sorting<br>    fields &#x3D; {<br>        â€œauth_dateâ€: data.get(â€œauth_dateâ€),<br>        â€œfirst_nameâ€: data.get(â€œfirst_nameâ€),<br>        â€œlast_nameâ€: data.get(â€œlast_nameâ€),<br>        â€œidâ€: data.get(â€œidâ€),<br>        â€œphoto_urlâ€: data.get(â€œphoto_urlâ€),<br>        â€œusernameâ€: data.get(â€œusernameâ€),<br>    }</p>
<pre><code># Sorting the fields to create the data-check-string
keys = sorted(fields)
data\_check\_string = &quot;\\n&quot;.join(f&quot;&#123;key&#125;=&#123;fields\[key\]&#125;&quot; for key in keys if fields\[key\])

# Calculate the SHA256 hash of the bot&#39;s token
hasher = hashlib.sha256()
# bot token token
hasher.update(&quot;token&quot;.encode(&quot;utf-8&quot;))
secret\_key = hasher.digest()

# Compute the HMAC-SHA-256 signature
hmac\_hasher = hmac.new(secret\_key, data\_check\_string.encode(&quot;utf-8&quot;), hashlib.sha256)
computed\_hash = hmac\_hasher.hexdigest()

# Compare the computed HMAC with the received hash
return computed\_hash == data.get(&quot;hash&quot;)
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/04/21/telegram-login-widget-verify-data/index/" data-id="clyujt8bh00055yjf43e151d5" data-title="Telegram Login Widget å¦‚ä½•éªŒè¯ç”¨æˆ·æ•°æ®" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-physical-esim/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/23/physical-esim/index/" class="article-date">
  <time class="dt-published" datetime="2024-03-23T00:00:00.000Z" itemprop="datePublished">2024-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/what/">what</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/23/physical-esim/index/">ç‰©ç†åŒ– eSIM</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå›½è¡Œ iPhone æ˜¯ä¸æ”¯æŒ eSIMçš„ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è®©å›½è¡Œ iPhoneä¹Ÿèƒ½è¿‡è¯•ç”¨ eSIMè¿è¥å•†å‘¢ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰çš„å•¦ã€‚</p>
<p>å›½å†…æœ‰å‡ ä¸ªå‚å•†åœ¨åšè¿™ä¸ªï¼Œæ¯”å¦‚ ESTK.meï¼Œ 5ber å›½å¤–è¿˜æœ‰ä¸€ä¸ª eSIM.meã€‚ä½¿ç”¨èµ·æ¥ä¸å¤æ‚ï¼Œä¹°ä»–ä»¬çš„SIMå¡ï¼Œç„¶åé€šè¿‡è½¯ä»¶ï¼Œé€šå¸¸æ˜¯Androidæ‰‹æœºæŠŠeSIM Profileå†™åˆ°è¿™å¼ å¡é‡Œï¼Œç„¶åæŠŠè¿™ä¸ªå¡æ’åˆ°æ‰‹æœºé‡Œå°±å¯ä»¥äº†ã€‚</p>
<p>é—®é¢˜æ¥äº†ï¼Œæˆ‘åˆæ²¡æœ‰ Android æ‰‹æœºï¼Œè€Œä¸”è¿™äº›å‚å•†å¾€å¾€éƒ½ä¼šé€šè¿‡è½¯ä»¶æ‰‹æ®µé™åˆ¶å†™å…¥ã€‚æ¯”å¦‚ 5berè¿™é‡Œï¼ŒæŒ‰ç…§ä¸‹è½½æ¬¡æ•°æ”¶è´¹çš„</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304270581.png"><img src="/images/2024032304270581.png"></a></p>
<p>Â </p>
<p>æœ‰æ²¡æœ‰åˆ«çš„åŠæ³•å‘¢ï¼Ÿå½“ç„¶æœ‰çš„å•¦ï¼Œè¯»å¡å™¨</p>
<p>Â </p>
<h2 id="æ™ºèƒ½å¡è¯»å¡å™¨"><a href="#æ™ºèƒ½å¡è¯»å¡å™¨" class="headerlink" title="æ™ºèƒ½å¡è¯»å¡å™¨"></a>æ™ºèƒ½å¡è¯»å¡å™¨</h2><p>å»ç¥å¥‡çš„æ·˜å®å¯ä»¥ä¹°åˆ°è¿™ç§è®¾å¤‡ï¼Œä»·æ ¼ä¸è´µï¼Œå¤§æ¦‚20-30äººæ°‘å¸</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304291564.jpg"><img src="/images/2024032304291564.jpg"></a></p>
<p>Â </p>
<h2 id="eSIM-card"><a href="#eSIM-card" class="headerlink" title="eSIM card"></a>eSIM card</h2><p>å¯ä»¥å»ä¸Šé¢æåˆ°çš„é‚£äº›å‚å•†ä¹°ï¼Œä¹Ÿæœ‰ä¸€äº›å…¶ä»–çš„å‚å•†ï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ã€‚</p>
<p>å¦‚æœè´­ä¹°5berçš„è¯ï¼Œä»–ä»¬çš„å®˜ç½‘åœ¨è¿™é‡Œ <a target="_blank" rel="noopener" href="https://esim.5ber.com/?language=en-US">https://esim.5ber.com/?language=en-US</a></p>
<p>ä½¿ç”¨é‚€è¯·ç  <strong>E6ARJX</strong> å¯èƒ½ä¼šæœ‰ä¼˜æƒ ã€‚å¦å¤–ï¼Œè”æƒ³æœ‰ä¸€æ¬¾ ThinkPad Thales eSIM card äº²æµ‹å¯ç”¨</p>
<p>å†™å¡</p>
<p>æˆ‘ç›´æ¥ç”¨äº† EasyLPACï¼Œå›¾å½¢ç•Œé¢æ–¹ä¾¿æ“ä½œã€‚æŠŠå¡ç‰‡æ’è¿›å»ï¼Œè½¯ä»¶å°±åº”è¯¥èƒ½è¯»åˆ°ã€‚500KBå¤§æ¦‚å¤Ÿå†™åå‡ ä¸ªäº†</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304411623.png"><img src="/images/2024032304411623.png"></a></p>
<p>Â </p>
<p>åˆ‡æ¢åˆ° Profileé€‰é¡¹å¡ï¼Œç‚¹Download è¾“å…¥è¿è¥å•†ç»™çš„ä¿¡æ¯ï¼Œç„¶åEnableï¼Œæ‹”å¡æ’æ‰‹æœºå³å¯</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304422821.png"><img src="/images/2024032304422821.png"></a></p>
<p>Â </p>
<p>å†™å¡æ¬¡æ•°é™åˆ¶ï¼Ÿä¸å­˜åœ¨çš„ï¼Œæƒ³å†™å¤šå°‘å†™å¤šå°‘ï¼Œåˆ«è¶…äº†å°±è¡Œã€‚ğŸ¤·</p>
<p>å½“ç„¶äº†æ¯æ¬¡è¦æ¢å¡ä¹Ÿæ¯”è¾ƒéº»çƒ¦å°±æ˜¯äº†â€¦â€¦è¿™ä¸ªæ²¡åŠæ³•ï¼Œæ—©æ—¥æ¢æ”¯æŒ eSIMçš„è®¾å¤‡å°±å¥½äº†</p>
<p>Â </p>
<h2 id="ç›¸å…³èµ„æ–™"><a href="#ç›¸å…³èµ„æ–™" class="headerlink" title="ç›¸å…³èµ„æ–™"></a>ç›¸å…³èµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://sparktour.me/2022/11/20/configure-esim-me-card-with-pc-sc-reader/">é€šè¿‡PC&#x2F;SCæ™ºèƒ½å¡è¯»å¡å™¨é…ç½®esim.meçš„SIMå¡</a>Â </li>
<li><a target="_blank" rel="noopener" href="https://iecho.cc/2023/10/20/Convert-eSIM-to-physical-SIM/">eSIM è½¬ SIM å®ä½“å¡</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/23/physical-esim/index/" data-id="clyujt8bf00035yjffif8ho0y" data-title="ç‰©ç†åŒ– eSIM" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/">azure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/09/28/worker-image-metadata/index/">ä½¿ç”¨ Cloudflare Workerè·å–å›¾ç‰‡å…ƒæ•°æ®</a>
          </li>
        
          <li>
            <a href="/2024/09/27/workers-function/index/">å°† Cloudflare Workers è¿ç§»åˆ° Azure Function</a>
          </li>
        
          <li>
            <a href="/2024/09/21/one-api-clickhouse/index/">one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ</a>
          </li>
        
          <li>
            <a href="/2024/08/03/stripe-fraud/index/">Stripe å¦‚ä½•å®‰å…¨æ”¶æ¬¾å¹¶é¿å…ç›—åˆ·ä¸æµ‹å¡</a>
          </li>
        
          <li>
            <a href="/2024/07/27/hide-in-cf/index/">éšè—äº Cloudflare çš„å…¨çƒç½‘ç»œä¹‹ä¸­</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Bennyå°åœŸè±†<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>