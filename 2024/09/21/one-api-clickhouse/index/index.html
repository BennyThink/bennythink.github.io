<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ | åœŸè±†ä¸å¥½åƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="one-api&#x2F;new-apiæ˜¯ä¸€æ¬¾å¼€æºçš„OpenAI æ¥å£ç®¡ç† &amp; åˆ†å‘ç³»ç»Ÿï¼Œæ”¯æŒOpenAIã€Anthropicã€Geminiç­‰å¤šç§æ¨¡å‹ã€‚ è¿™å¥—ç³»ç»Ÿï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦æ¥çœ‹ï¼Œç”¨èµ·æ¥å€’è¿˜å¥½ï¼ŒUIå¾ˆç®€æ´ï¼›ä»å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œä½œè€…æŒºä¸å®¹æ˜“çš„è¦ç”¨Goæ¥å¤„ç†å„ç§å¥‡å¥‡æ€ªæ€ªçš„åºåˆ—åŒ–é—®é¢˜ï¼Œä¸€æ—¦è¯·æ±‚æ•°é‡è¿‡å¤šå¹¶å‘å°±æ— æ³•æå‡ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿæœ‰å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„åœ°æ–¹å•¦â€¦â€¦  æˆ‘çš„OpenAIæ¥å£è½¬å‘ç«™ ã€Œå¤´é¡¶å†’">
<meta property="og:type" content="article">
<meta property="og:title" content="one-api&#x2F;new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ">
<meta property="og:url" content="http://example.com/2024/09/21/one-api-clickhouse/index/index.html">
<meta property="og:site_name" content="åœŸè±†ä¸å¥½åƒ">
<meta property="og:description" content="one-api&#x2F;new-apiæ˜¯ä¸€æ¬¾å¼€æºçš„OpenAI æ¥å£ç®¡ç† &amp; åˆ†å‘ç³»ç»Ÿï¼Œæ”¯æŒOpenAIã€Anthropicã€Geminiç­‰å¤šç§æ¨¡å‹ã€‚ è¿™å¥—ç³»ç»Ÿï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦æ¥çœ‹ï¼Œç”¨èµ·æ¥å€’è¿˜å¥½ï¼ŒUIå¾ˆç®€æ´ï¼›ä»å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œä½œè€…æŒºä¸å®¹æ˜“çš„è¦ç”¨Goæ¥å¤„ç†å„ç§å¥‡å¥‡æ€ªæ€ªçš„åºåˆ—åŒ–é—®é¢˜ï¼Œä¸€æ—¦è¯·æ±‚æ•°é‡è¿‡å¤šå¹¶å‘å°±æ— æ³•æå‡ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿæœ‰å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„åœ°æ–¹å•¦â€¦â€¦  æˆ‘çš„OpenAIæ¥å£è½¬å‘ç«™ ã€Œå¤´é¡¶å†’">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/2024092119325495.jpg">
<meta property="og:image" content="http://example.com/images/202409212031366.png">
<meta property="og:image" content="http://example.com/images/2024092119153889.png">
<meta property="article:published_time" content="2024-09-21T00:00:00.000Z">
<meta property="article:modified_time" content="2024-09-21T22:37:10.146Z">
<meta property="article:author" content="Bennyå°åœŸè±†">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/2024092119325495.jpg">
  
    <link rel="alternate" href="/atom.xml" title="åœŸè±†ä¸å¥½åƒ" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">åœŸè±†ä¸å¥½åƒ</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-one-api-clickhouse/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/21/one-api-clickhouse/index/" class="article-date">
  <time class="dt-published" datetime="2024-09-21T00:00:00.000Z" itemprop="datePublished">2024-09-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>one-api&#x2F;new-apiæ˜¯ä¸€æ¬¾å¼€æºçš„OpenAI æ¥å£ç®¡ç† &amp; åˆ†å‘ç³»ç»Ÿï¼Œæ”¯æŒOpenAIã€Anthropicã€Geminiç­‰å¤šç§æ¨¡å‹ã€‚</p>
<p>è¿™å¥—ç³»ç»Ÿï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦æ¥çœ‹ï¼Œç”¨èµ·æ¥å€’è¿˜å¥½ï¼ŒUIå¾ˆç®€æ´ï¼›ä»å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œä½œè€…æŒºä¸å®¹æ˜“çš„è¦ç”¨Goæ¥å¤„ç†å„ç§å¥‡å¥‡æ€ªæ€ªçš„åºåˆ—åŒ–é—®é¢˜ï¼Œä¸€æ—¦è¯·æ±‚æ•°é‡è¿‡å¤šå¹¶å‘å°±æ— æ³•æå‡ï¼Œé™¤æ­¤ä¹‹å¤–ä¹Ÿæœ‰å¾ˆå¤š<a target="_blank" rel="noopener" href="https://t.me/mikuri520/2836">å¥‡å¥‡æ€ªæ€ªçš„åœ°æ–¹å•¦</a>â€¦â€¦</p>
<hr>
<p>æˆ‘çš„<a target="_blank" rel="noopener" href="https://burn.hair/">OpenAIæ¥å£è½¬å‘ç«™ ã€Œå¤´é¡¶å†’ç«ã€</a> å°±æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¹‹ä¸Šæ­å»ºçš„ã€‚åªä¸è¿‡ç»è¿‡äº†æˆ‘çš„å¤§é‡ä¿®æ”¹ï¼Œæ¯”å¦‚åŠ ä¸ªæ•°æ®çœ‹æ¿è¿™ç§å‰ç«¯çš„åŠŸèƒ½</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/09/2024092119325495.jpg"><img src="/images/2024092119325495.jpg"></a></p>
<p>ä»¥åŠé»˜é»˜çš„çœ‹ä¸è§çš„åå°ä¼˜åŒ–ã€‚ç»è¿‡æˆ‘çš„ä¸€ç•ªè°ƒæ•™ä¹‹åï¼Œç›®å‰åœ¨Hetzner 2C 2Gçš„æœºå™¨ä¸Šå·²ç»èƒ½è¾¾åˆ°å‡ ç™¾çš„QPSäº†ã€‚å½“ç„¶å®é™…ä½¿ç”¨ï¼Œè¿˜å¾—çœ‹çœŸæ­£çš„APIèƒ½å¤Ÿæä¾›å¤šå°‘TPMå’ŒRPMã€‚</p>
<hr>
<p>åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæœ¬æ¥æ•°æ®åº“çš„å‹åŠ›å°±æ¯”è¾ƒå¤§ï¼Œå¦‚æœè¿˜å¼€å¯äº†æ—¥å¿—è®°å½•åŠŸèƒ½ï¼Œé‚£ä¹ˆæ•°æ®åº“å°±ä¼šè¢«å¤§é‡çš„æ—¥å¿—å†™å…¥ç›´æ¥æ’‘çˆ†ï¼›å¦å¤–ï¼Œå³ä½¿åœ¨éé«˜è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œåœ¨æ—¥å¿—æ¡ç›®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼ŒæŸ¥çœ‹æ¯ä¸€é¡µæ—¥å¿—çš„è¯·æ±‚é€Ÿåº¦ä¹Ÿä¼šå¾ˆæ…¢ã€‚</p>
<p>ä¼˜åŒ–å¹¶å‘æœ€ç®€å•ã€å¹¶ä¸”å¤§æ¦‚ç‡å¥½ç”¨çš„åŠæ³•ä¹‹ä¸€æ˜¯ç”¨æ›´é«˜é…ç½®çš„æœºå™¨ã€‚ä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>æå‡åˆ°ä¸€å®šé…ç½®ä¹‹åï¼Œå†æå‡åŸºæœ¬æ²¡å¸®åŠ©ï¼Œä¹Ÿå°±æ˜¯é™·å…¥è¾¹é™…æ•ˆåº”é€’å‡</strong>ã€‚è€Œä¸”å¯¹äºæˆ‘è¿™ç§ç©·äººï¼Œè‡ªç„¶åªèƒ½é å˜å¼‚ä¼˜åŒ–äº†ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ ClickHouseæ›¿æ¢åŸæœ‰çš„æ—¥å¿—ç³»ç»Ÿï¼Œé¿å…åœ¨é«˜å¹¶å‘çš„æ—¶å€™æ¸…ç©ºæ¶åŒ–å¹¶é™ä½æ€§èƒ½ã€‚è‡³äºå…¶ä»–æ–¹é¢çš„ä¼˜åŒ–ï¼Œç­‰ä»¥åå†è¯´ï½</p>
<h2 id="one-apiçš„æ•°æ®åº“"><a href="#one-apiçš„æ•°æ®åº“" class="headerlink" title="one-apiçš„æ•°æ®åº“"></a>one-apiçš„æ•°æ®åº“</h2><p>one-apié»˜è®¤æ”¯æŒä¸‰ç§æ•°æ®åº“ï¼ŒSQLiteï¼ŒMySQLå’ŒPostgreSQLã€‚</p>
<ul>
<li>SQLiteï¼šåµŒå…¥å¼çš„æ•°æ®åº“ï¼Œåªæœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨é«˜å¹¶å‘ä¸‹ï¼Œå³ä½¿å…è®¸å¤šçº¿ç¨‹è¯»å†™ï¼Œå…¶æ€§èƒ½ä¹Ÿä¸ä¼šå¥½åˆ°å“ªé‡Œå»ã€‚</li>
<li>MySQLï¼šçŸ¥åçš„RDBMS</li>
<li>PostgreSQLï¼šPostgreSQLåº”è¯¥æœ‰æ›´ä¸°å¯Œçš„åŠŸèƒ½å’Œç‰¹æ€§ã€‚</li>
</ul>
<p>å¦‚æœä½ å®åœ¨æ‡’å¾—è‡ªå·±ä¼˜åŒ–ï¼Œç›´æ¥æ¢æˆ PostgreSQL+é«˜é…ç½®çš„æœºå™¨å§ï¼ŒPostgreSQLçš„æ€§èƒ½åº”è¯¥ä¼šå¥½è¿‡MySQLä¸€äº›ã€‚</p>
<h2 id="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥"><a href="#one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥" class="headerlink" title="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥"></a>one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šå†™å…¥</h2><p>One-apiçš„æ™®é€šæ•°æ®å’Œæ—¥å¿—é»˜è®¤æƒ…å†µä¸‹å‡è®°å½•åœ¨åŒä¸€ä¸ªæ•°æ®åº“ä¹‹ä¸­ï¼Œå…¶Go Struct Model å¦‚ä¸‹</p>
<p>type Log struct {<br>    Id               int    `json:â€idâ€`<br>    UserId           int    `json:â€user_idâ€ gorm:â€indexâ€`<br>    CreatedAt        int64  `json:â€created_atâ€ gorm:â€bigint;index:idx_created_at_typeâ€`<br>    Type             int    `json:â€typeâ€ gorm:â€index:idx_created_at_typeâ€`<br>    Content          string `json:â€contentâ€`<br>    Username         string `json:â€usernameâ€ gorm:â€index:index_username_model_name,priority:2;default:â€™â€™â€`<br>    TokenName        string `json:â€token_nameâ€ gorm:â€index;default:â€™â€™â€`<br>    ModelName        string `json:â€model_nameâ€ gorm:â€index;index:index_username_model_name,priority:1;default:â€™â€™â€`<br>    Quota            int    `json:â€quotaâ€ gorm:â€default:0â€`<br>    PromptTokens     int    `json:â€prompt_tokensâ€ gorm:â€default:0â€`<br>    CompletionTokens int    `json:â€completion_tokensâ€ gorm:â€default:0â€`<br>    ChannelId        int    `json:â€channelâ€ gorm:â€indexâ€`<br>}</p>
<p>é»˜è®¤é…ç½®ä¸‹ï¼Œæ¯ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šè°ƒç”¨ <code>RecordConsumeLog</code> å†™å…¥æ—¥å¿—ï¼Œå…¶ä»£ç éå¸¸ç®€å•</p>
<p>log :&#x3D; &amp;Log{<br>    UserId:           userId,<br>    Username:         GetUsernameById(userId),<br>    CreatedAt:        helper.GetTimestamp(),<br>    Type:             LogTypeConsume,<br>    Content:          content,<br>    PromptTokens:     promptTokens,<br>    CompletionTokens: completionTokens,<br>    TokenName:        tokenName,<br>    ModelName:        modelName,<br>    Quota:            int(quota),<br>    ChannelId:        channelId,<br>}<br>err :&#x3D; LOG_DB.Create(log).Error</p>
<h3 id="é€æ¡å†™å…¥æ—¥å¿—"><a href="#é€æ¡å†™å…¥æ—¥å¿—" class="headerlink" title="é€æ¡å†™å…¥æ—¥å¿—"></a>é€æ¡å†™å…¥æ—¥å¿—</h3><p>åœ¨è¯·æ±‚æ•°é‡æ¯”è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€æ¡ä¸€æ¡çš„æ‰§è¡Œ insert è¯­å¥ã€‚è¿™ç§æƒ…å†µä¸‹ä¸»è¦æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p>
<ol>
<li>ç½‘ç»œå»¶è¿Ÿï¼šæ¯æ¬¡æ“ä½œéƒ½æœ‰å¾€è¿”çš„RTTã€é€šä¿¡å¼€é”€</li>
<li>äº‹åŠ¡å¼€é”€ï¼šæ¯æ¬¡æ“ä½œéƒ½è¦å¼€å¯å’Œå…³é—­äº‹åŠ¡</li>
<li>è´Ÿè½½ï¼šé¢‘ç¹æ’å…¥ä¼šå¯¼è‡´CPUå’ŒIOè´Ÿè½½å¢åŠ </li>
</ol>
<p>å³ä½¿ä½ å¾ˆæœ‰é’±ï¼Œç”¨åˆ°äº†æ¯ä¸ªæœˆå‡ ç™¾å‡ åƒç¾å…ƒé…ç½®å’Œä»·æ ¼å¥‡é«˜çš„Managed databaseï¼Œ1å’Œ2çš„é—®é¢˜è¿˜æ˜¯æ— æ³•é¿å…</p>
<h3 id="insert-manyä¼˜åŒ–"><a href="#insert-manyä¼˜åŒ–" class="headerlink" title="insert_manyä¼˜åŒ–"></a>insert_manyä¼˜åŒ–</h3><p>ä½¿ç”¨ insert_manyï¼Œç§¯æ”’ä¸€å®šçš„æ•°æ®ä¹‹åä¸€èµ·æ’å…¥ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸ç®€å•çš„ä¼˜åŒ–æ€è·¯ã€‚è¿™ç§åŠæ³•ä¹Ÿæœ‰äº›ç¼ºç‚¹ï¼š</p>
<ol>
<li>è¦ç­‰æ•°æ®ç§¯æ”’åˆ°ä¸€å®šç¨‹åº¦ï¼Œä¼šæœ‰ä¸€å®šçš„å»¶è¿Ÿ</li>
<li>ç§¯æ”’æ•°æ®åˆ°æ—¶å€™å¯èƒ½ä¼šæœ‰å†…å­˜æ¶ˆè€—è¿‡å¤šçš„é£é™©</li>
<li>å¯èƒ½ä¼šæœ‰æ›´é«˜çš„å¤±è´¥æ¦‚ç‡ï¼Œä¸€æ¬¡æ€§æ’å…¥æ•°æ®è¿‡å¤šï¼Œå¯èƒ½ä¼šæœ‰ <code>max_allowed_packet</code> ä¹‹ç±»çš„é—®é¢˜</li>
</ol>
<p>ä¼˜ç‚¹å¾ˆæ˜æ˜¾ï¼Œä¸€æ¬¡æ€§å†™å…¥æ•°æ®å¯æ¯”ä¸€æ¡ä¸€æ¡å†™è¦å¿«ä¸Šå¾ˆå¤šå€äº†ã€‚</p>
<p>one-apiè‡ªå¸¦äº†ä¸€ä¸ªç±»ä¼¼çš„åŠŸèƒ½ï¼Œç¯å¢ƒå˜é‡<code>BATCH_UPDATE_ENABLED</code> å’Œ <code>BATCH_UPDATE_INTERVAL</code> ã€‚ä¸è¿‡æˆªæ­¢åˆ°æˆ‘å†™æœ¬æ–‡çš„æ—¶å€™ï¼Œå†™æ—¥å¿—çš„è¿™éƒ¨åˆ†åŠŸèƒ½ä¸åŒ…å«åœ¨<code>batchUpdate</code>å†…â€¦è€Œæ˜¯åœ¨ä¸€ä¸ªgo routineå†…æ‰§è¡Œçš„â€¦</p>
<p>æ›´è¦å‘½çš„æ˜¯ï¼Œè¿™ä¸ª<code>batchUpdate</code>ä»è®¾è®¡ä¸Šæ¥çœ‹ï¼Œåªèƒ½èšåˆæ•°å€¼ç±»å‹çš„æ•°æ®ğŸ˜‚</p>
<p>func addNewRecord(type_ int, id int, value int64) {<br>    batchUpdateLocks[type_].Lock()<br>    defer batchUpdateLocks[type_].Unlock()<br>    if _, ok :&#x3D; batchUpdateStores[type_][id]; !ok {<br>        batchUpdateStores[type_][id] &#x3D; value<br>    } else {<br>        batchUpdateStores[type_][id] +&#x3D; value<br>    }<br>}</p>
<p>æ”¹é€ ä¸€ä¸‹å½“ç„¶å¯è¡Œï¼Œæ”’å¤Ÿ1000æ¡æˆ–åˆ°ä¸€å®šæ—¶é—´é—´éš”ä¸€èµ·å†™å…¥æ•°æ®åº“ï¼Œéš¾åº¦ä¸é«˜ï¼ŒChatGPTå¯ä»¥å¸®å¿™ã€‚</p>
<h2 id="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–"><a href="#one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–" class="headerlink" title="one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–"></a>one-apiçš„æ—¥å¿—ç³»ç»Ÿï¼šè¯»å–</h2><p>å‡å¦‚æ—¥å¿—å¾ˆå°‘ï¼Œé‚£ä¹ˆè¯»å–æ—¥å¿—å¹¶ä¸ä¼šé€ æˆä»€ä¹ˆå¤§é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæ•°æ®é‡å¾ˆå¤§ï¼Œå¹¶ä¸”è¿˜ç”¨æˆ·ç‚¹å‡»äº†ä¸‹ä¸€é¡µï¼Œç”šè‡³æ˜¯æœ€åä¸€é¡µè¿›è¡Œäº†åˆ†é¡µæ“ä½œï¼Œé‚£ä¹ˆ <code>OFFSET</code>å’Œ<code>LIMIT</code> ä¼šæ˜¾è‘—å½±å“æ•°æ®åº“çš„æ€§èƒ½ã€‚</p>
<p>MySQL åœ¨æ‰§è¡Œ <code>OFFSET</code> æ—¶ï¼Œå¿…é¡»ä»å¤´å¼€å§‹æ‰«æå¹¶ä¸¢å¼ƒå‰ <code>OFFSET</code> æ¡è®°å½•ï¼Œç„¶åè¿”å› <code>LIMIT</code> æ¡è®°å½•ï¼Œå¯¼è‡´è¾ƒå¤§çš„æ—¶é—´å¼€é”€ï¼Œå°¤å…¶æ˜¯ <code>OFFSET</code> æ•°å€¼è¾ƒå¤§æ—¶ã€‚</p>
<p>ä¼˜åŒ–æ–¹æ³•åº”è¯¥æ˜¯æœ‰ä¸€äº›çš„ï¼Œæ¯”å¦‚é€šè¿‡ä¸»é”®è€Œä¸æ˜¯<code>OFFSET</code> ï¼Œå…·ä½“å¯ä»¥é—®é—®ChatGPTï¼Œæˆ‘ä¸æ˜¯å¾ˆæ„¿æ„è¿›è¡Œè¿™ä¸ªæ–¹å‘çš„ç ”ç©¶ğŸ˜‚</p>
<h2 id="ClickHouseä»‹ç»"><a href="#ClickHouseä»‹ç»" class="headerlink" title="ClickHouseä»‹ç»"></a>ClickHouseä»‹ç»</h2><p>ClickHouseæ˜¯yandexå¼€å‘çš„ä¸€ä¸ªå¼€æºåˆ—å¼æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œä¸“é—¨ä¸ºé«˜æ€§èƒ½çš„åˆ†ææŸ¥è¯¢è€Œè®¾è®¡ï¼Œåœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶æœ‰å‡ºè‰²çš„è¡¨ç°ã€‚</p>
<p>ClickHouseé‡‡ç”¨åˆ—å¼å­˜å‚¨ï¼Œä¸åƒMySQLç­‰æ˜¯è¡Œå¼å­˜å‚¨ï¼Œç‰¹åˆ«é€‚åˆå­˜å‚¨æ—¥å¿—ã€‚åœ¨ WebP Cloud Services ä¸­æˆ‘ä»¬çš„ç»Ÿè®¡ä¿¡æ¯æ¥æºä¾¿æ˜¯ ClickHouse</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/09/202409212031366.png"><img src="/images/202409212031366.png"></a></p>
<p>æ›´é‡è¦çš„æ˜¯ï¼ŒClickHouseçš„æŸ¥è¯¢è¯­å¥å’ŒMySQLã€PostgreSQLç­‰å‡ ä¹æ²¡ä»€ä¹ˆå·®åˆ«ï¼ŒåŸºæœ¬ä¸Šæ”¹æ”¹å°±èƒ½ç”¨ï¼Œå­¦ä¹ æ›²çº¿å¾ˆå¹³ç¼“ã€‚</p>
<h2 id="ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨"><a href="#ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨"></a>ClickHouseåˆ›å»ºæ•°æ®åº“è¡¨</h2><p>æ ¹æ®ä¸Šé¢çš„Go Structå’Œå·²æœ‰çš„æ•°æ®ç»“æ„ï¼Œæ”¹æ”¹åŸºæœ¬ä¸Šå°±å¯ä»¥äº†ã€‚ä¸ºäº†ä¿æŒä¸€è‡´ï¼Œ<code>created_at</code> å°±ç”¨æ•°å­—æ—¶é—´æˆ³äº†ï¼Œè™½ç„¶ä½¿ç”¨ <code>datetime</code>æ˜¯æ›´å¥½çš„åŠæ³•ã€‚</p>
<p>CREATE TABLE logs<br>(<br>    user_id           Nullable(Int64),<br>    created_at        Int64  DEFAULT toUnixTimestamp(now()),<br>    type              Nullable(Int64),<br>    content           Nullable(String),<br>    username          String DEFAULT â€˜â€™,<br>    token_name        String DEFAULT â€˜â€™,<br>    model_name        String DEFAULT â€˜â€™,<br>    quota             Int64  DEFAULT 0,<br>    prompt_tokens     Int64  DEFAULT 0,<br>    completion_tokens Int64  DEFAULT 0,<br>    ip                Nullable(String),<br>    user_agent        Nullable(String)<br>) ENGINE &#x3D; MergeTree()<br>      ORDER BY (created_at, username, token_name, model_name);</p>
<h2 id="è¿æ¥åˆ°ClickHouse"><a href="#è¿æ¥åˆ°ClickHouse" class="headerlink" title="è¿æ¥åˆ°ClickHouse"></a>è¿æ¥åˆ°ClickHouse</h2><p>ä½¿ç”¨å®˜æ–¹çš„ github.com&#x2F;ClickHouse&#x2F;clickhouse-go</p>
<p>var ch, err &#x3D; clickhouse.Open(&amp;clickhouse.Options{<br>    Addr: []string{â€œclickhouse:9000â€},<br>    Auth: clickhouse.Auth{<br>        Database: â€œopenaiâ€,<br>        Username: â€œdefaultâ€,<br>        Password: â€œâ€,<br>    },<br>})</p>
<h2 id="å†™å…¥æ•°æ®"><a href="#å†™å…¥æ•°æ®" class="headerlink" title="å†™å…¥æ•°æ®"></a>å†™å…¥æ•°æ®</h2><p>query :&#x3D; `INSERT INTO logs ( user_id, created_at, type, content, username, token_name, model_name,quota, prompt_tokens, completion_tokens, ip, user_agent)`<br>ch.Exec(ctx, query, 1, timestamp, â€¦)</p>
<h2 id="æ‰¹é‡å†™å…¥æ•°æ®"><a href="#æ‰¹é‡å†™å…¥æ•°æ®" class="headerlink" title="æ‰¹é‡å†™å…¥æ•°æ®"></a>æ‰¹é‡å†™å…¥æ•°æ®</h2><p>Clickhouseæœ€å‰å®³çš„åœ°æ–¹ä¹‹ä¸€æ˜¯å¯ä»¥æ‰¹é‡å†™å…¥æ•°æ®ï¼Œå®˜ç½‘ä¸Š<a target="_blank" rel="noopener" href="https://clickhouse.com/docs/en/cloud/bestpractices/bulk-inserts">æ˜¯è¿™ä¹ˆè¯´çš„</a>ï¼š</p>
<blockquote>
<p>Generally, we recommend inserting data in fairly large batches of at least 1,000 rows at a time, and ideally between 10,000 to 100,000 rows.</p>
</blockquote>
<p>ä½ çœ‹ä»–ä»¬å¤šè‡ªä¿¡ï¼Œè®©ä½ æ”’å¤Ÿäº†å†å†™ï¼Œä¸€æ¬¡å†™å‡ ä¸‡æ²¡é—®é¢˜</p>
<h3 id="åˆ›å»ºbatch"><a href="#åˆ›å»ºbatch" class="headerlink" title="åˆ›å»ºbatch"></a>åˆ›å»ºbatch</h3><p>åœ¨Goé‡Œæ‰¹é‡å†™å…¥ï¼Œè¦å…ˆåˆ›å»ºbatch</p>
<p>var batch, err &#x3D; ch.PrepareBatch(ctx, `INSERT INTO logs ( user_id, created_at, type, content, username, token_name, model_name,<br>    quota, prompt_tokens, completion_tokens, ip, user_agent)<br>VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`)</p>
<h3 id="è¿½åŠ æ•°æ®"><a href="#è¿½åŠ æ•°æ®" class="headerlink" title="è¿½åŠ æ•°æ®"></a>è¿½åŠ æ•°æ®</h3><p>ç„¶åå¾€è¿™ä¸ª batché‡Œç–¯ç‹‚<code>append</code>æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åœ¨åŸæ¥çš„<code>RecordConsumeLog</code> ä¸­è¿½åŠ æ•°æ®åˆ°è¿™ä¸ªbatch</p>
<p>batch.Append(userId, helper.GetTimestamp(),<br>    LogTypeConsume, content, username, tokenName, modelName, quota, promptTokens, completionTokens, ip, ua,<br>)</p>
<h3 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h3><p>æ—¶é—´å·®ä¸å¤šäº†ï¼Œæˆ–è€…æ•°æ®è¶³å¤Ÿäº†ï¼Œæäº¤</p>
<p>batch.Send()</p>
<h3 id="å®šæ—¶å™¨"><a href="#å®šæ—¶å™¨" class="headerlink" title="å®šæ—¶å™¨"></a>å®šæ—¶å™¨</h3><p>å®šæ—¶å™¨å¯ä»¥ç”¨<code>ticker</code></p>
<p>func ClickHouseTicker() {<br>    var ticker &#x3D; time.NewTicker(time.Second * 60)<br>    for {<br>        select {<br>        case &lt;-ticker.C:<br>            FlushLog()<br>        }<br>    }<br>}</p>
<p>åœ¨ mainé‡Œ <code>go ClickHouseTicker()</code>å³å¯</p>
<h3 id="æ¸…ç©ºbatch"><a href="#æ¸…ç©ºbatch" class="headerlink" title="æ¸…ç©ºbatch"></a>æ¸…ç©ºbatch</h3><p>å†™å®Œæ•°æ®ä¹‹åï¼Œç„¶åæ¸…ç©ºbatchï¼Œä¸èƒ½è¶Šå†™è¶Šå¤š</p>
<p>batch&#x3D;createBatch()</p>
<h3 id="ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ"><a href="#ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ" class="headerlink" title="ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ"></a>ç¨‹åºé€€å‡ºæ¸…ç†å·¥ä½œ</h3><p>æœ€åï¼Œè¦æ•è· SIGINTå’ŒSIGTERMä¿¡å·ï¼Œä¸èƒ½é‡å¯ç¨‹åºçš„ä¸¢æ—¥å¿—å•Šï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°IIFE+goroutineäº†</p>
<p>sigChan :&#x3D; make(chan os.Signal, 1)<br>signal.Notify(sigChan, syscall.SIGTERM, syscall.SIGINT)<br>go func() {<br>    for {<br>        sig :&#x3D; &lt;-sigChan<br>        switch sig {<br>        case syscall.SIGINT, syscall.SIGTERM:<br>            logger.SysLog(â€œCleaning upâ€¦â€)<br>            model.FlushLog()<br>            model.ConsolidateConsumeQuota()<br>            time.Sleep(time.Second * 2)<br>            syscall.Exit(0)<br>        }<br>    }<br>}()</p>
<h2 id="è¯»æ•°æ®"><a href="#è¯»æ•°æ®" class="headerlink" title="è¯»æ•°æ®"></a>è¯»æ•°æ®</h2><p>æŸ¥è¯¢è¯­æ³•åŸºæœ¬å’ŒMySQLä¸€æ ·ï¼Œ<code>ch.Query(ctx, query, paramsâ€¦)</code>å°±è¡Œï¼Œorder byï¼Œoffsetï¼Œlimitï¼Œcountç­‰éƒ½æœ‰</p>
<h2 id="åˆ é™¤æ—¥å¿—"><a href="#åˆ é™¤æ—¥å¿—" class="headerlink" title="åˆ é™¤æ—¥å¿—"></a>åˆ é™¤æ—¥å¿—</h2><p>æ—¥å¿—æ€»å¾—åˆ æ‰ï¼Œè¦ä¸ç„¶ç£ç›˜æ—©æ™šä¼šè¢«æ’‘çˆ†ã€‚ç”¨ç±»ä¼¼å¦‚ä¸‹è¯­å¥å°±è¡Œï¼Œæœ€åçš„ <code>max_execution_time</code> å¯é€‰ï¼Œé¿å…æ—¥å¿—çœŸçš„å¤ªå¤šåˆ é™¤ä¹Ÿå¾ˆè´¹æ—¶é—´</p>
<p>DELETE FROM logs WHERE type &#x3D; 2 AND created_at &lt; timestamp SETTINGS max_execution_time&#x3D;3600</p>
<h2 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h2><p>é€šè¿‡ Grafana + Clickhouseä½œä¸ºæ•°æ®æºï¼Œå¯ä»¥ç›´æ¥ç”»å›¾è¡¨ã€‚ä¹‹å‰ QPS çš„æ•°æ®æ˜¯å†™å…¥åˆ° influxdbçš„ï¼Œä¸€æ—¦è¶…è¿‡7å¤©æŸ¥è¯¢å°±å¾ˆæ…¢ï¼Œç°åœ¨æˆ‘å•ç‹¬æŠŠæœ¬åº”å†™åˆ° influxdbçš„æ•°æ®å†™åˆ°äº†ä¸€ä¸ªåä¸º stats çš„ClickHouseè¡¨ï¼Œåªä¿å­˜å…³é”®çš„ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚æ—¶é—´ï¼Œæ¨¡å‹åç§°ç­‰ã€‚</p>
<p>æ¯”å¦‚çœ‹çœ‹å¤§å®¶ç”¨å¾—æœ€å¤šçš„æ¨¡å‹ï¼Œæœ€å¤šçš„ç«Ÿç„¶æ˜¯miniï¼Œç„¶åæ˜¯4oï¼›ä½†æ˜¯æ¶ˆè´¹æ˜¯åè¿‡æ¥çš„ï¼Œå› ä¸º4oçš„ä»·æ ¼æ¯”è¾ƒè´µï¼Œminiæ¯”è¾ƒä¾¿å®œ</p>
<p><img src="/images/2024092119153889.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, é¥¼å›¾ ä¸­åº¦å¯ä¿¡åº¦æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æŸ¥è¯¢æ€§èƒ½èƒ½æå‡"><a href="#æŸ¥è¯¢æ€§èƒ½èƒ½æå‡" class="headerlink" title="æŸ¥è¯¢æ€§èƒ½èƒ½æå‡"></a>æŸ¥è¯¢æ€§èƒ½èƒ½æå‡</h2><p>ç®€å•çš„æ‰§è¡Œä¸‰ä¸ªæŸ¥è¯¢ï¼Œä¸€å…±æœ‰354ä¸‡çš„æ•°æ®ã€‚ä¸»è¦æµ‹ä¸€ä¸‹å¤§é‡ç¿»é¡µï¼Œå¯ä»¥çœ‹å‡ºå³ä½¿æœ€å·®çš„<code>select *</code> çš„æƒ…å†µä¸‹ï¼ŒClickHouseå¤§æ¦‚ä¹Ÿæœ‰4-5å€çš„æ€§èƒ½æå‡ã€‚</p>
<table><tbody><tr><td>æŸ¥è¯¢</td><td>MySQL</td><td>ClickHouse</td><td>æ¯”ç‡</td></tr><tr><td>select count(*) from openai.logs;</td><td>2.73</td><td>0.002</td><td>1365.00</td></tr><tr><td>select user_id from openai.logs limit 3 offset 3000000;</td><td>4.19</td><td>0.022</td><td>190.45</td></tr><tr><td>select * from openai.logs limit 3 offset 3000000;</td><td>12.16</td><td>2.778</td><td>4.38</td></tr></tbody></table>

<p>mysql&gt; select count(*) from openai.logs;<br>+â€”â€”â€”-+<br>| count(*) |<br>+â€”â€”â€”-+<br>|  3540771 |<br>+â€”â€”â€”-+<br>1 row in set (2.73 sec)</p>
<p>mysql&gt; select user_id from openai.logs limit 3 offset 3000000;<br>â€¦.<br>3 rows in set (4.19 sec)</p>
<p>mysql&gt; select * from openai.logs limit 3 offset 3000000;<br>â€¦.                                                                                                                                                                                                                                                   |<br>3 rows in set (12.16 sec)</p>
<p>c387e15ec5c6 :) select count(*) from openai.logs;</p>
<p>SELECT count(*)<br>FROM openai.logs</p>
<p>Query id: 9382c843-927d-471f-8f6c-85a049d58294</p>
<p>   â”Œâ”€count()â”€â”</p>
<ol>
<li>â”‚ 3540771 â”‚ â€“ 3.54 million<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</li>
</ol>
<p>1 row in set. Elapsed: 0.002 sec.</p>
<p>c387e15ec5c6 :) select user_id from openai.logs limit 3 offset 3000000;</p>
<p>SELECT user_id<br>FROM openai.logs<br>LIMIT 3000000, 3</p>
<p>Query id: 66d0ea52-6b30-4a73-b313-fc45bdcbaaf2<br>â€¦.</p>
<p>3 rows in set. Elapsed: 0.022 sec. Processed 3.29 million rows, 29.64 MB (146.90 million rows&#x2F;s., 1.32 GB&#x2F;s.)<br>Peak memory usage: 4.26 MiB.</p>
<p>c387e15ec5c6 :) select * from openai.logs limit 3 offset 3000000;</p>
<p>SELECT *<br>FROM openai.logs<br>LIMIT 3000000, 3</p>
<p>Query id: 0faf62f4-5203-434a-8b3d-d1bcf032a8d0<br>â€¦.<br>3 rows in set. Elapsed: 2.778 sec. Processed 3.01 million rows, 9.26 GB (1.08 million rows&#x2F;s., 3.33 GB&#x2F;s.)<br>Peak memory usage: 258.79 MiB.</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>é‚£å½“ç„¶æ˜¯è¦è‡ªæˆ‘å®£ä¼ ä¸€ä¸‹å•¦ï¼</p>
<p>ğŸŒŸğŸŒŸğŸŒŸæ¬¢è¿æ³¨å†Œå¹¶ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://burn.hair/?lang=zh-CN&utm_source=dmesg">å¤´é¡¶å†’ç« OpenAI æ¥å£è½¬å‘ç«™</a>ï¼Œç¨³å®šã€å¿«é€Ÿã€é«˜å¹¶å‘ï¼Œæ³¨å†Œå³èµ é€ $0.5 æµ‹è¯•é¢åº¦ ğŸŒŸğŸŒŸğŸŒŸ</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/21/one-api-clickhouse/index/" data-id="cm1cqczkf0000ymjf4qnmejvy" data-title="one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2024/09/27/workers-function/index/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          å°† Cloudflare Workers è¿ç§»åˆ° Azure Function
        
      </div>
    </a>
  
  
    <a href="/2024/08/03/stripe-fraud/index/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Stripe å¦‚ä½•å®‰å…¨æ”¶æ¬¾å¹¶é¿å…ç›—åˆ·ä¸æµ‹å¡</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/">azure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/12/candlestick-llm/index/">ä½¿ç”¨Python é€šè¿‡Kçº¿è®¡ç®—æŠ€æœ¯æŒ‡æ ‡ï¼Œå¹¶ç”¨ LLM é¢„æµ‹è¶‹åŠ¿</a>
          </li>
        
          <li>
            <a href="/2024/11/03/warp-http-proxy/index/">æŠŠ Cloudflare WARP è½¬æ¢ä¸º http ä»£ç†</a>
          </li>
        
          <li>
            <a href="/2024/10/12/aca-php/index/">ç”¨ Azure Container Apps è¿è¡ŒPHPç½‘ç«™</a>
          </li>
        
          <li>
            <a href="/2024/10/06/aca-vm-scale/index/">Azure Container Apps è¿æ¥åˆ°è™šæ‹Ÿæœºå¹¶é…ç½®CPUè‡ªåŠ¨ç¼©æ”¾</a>
          </li>
        
          <li>
            <a href="/2024/09/28/worker-image-metadata/index/">ä½¿ç”¨ Cloudflare Workerè·å–å›¾ç‰‡å…ƒæ•°æ®</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Bennyå°åœŸè±†<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>