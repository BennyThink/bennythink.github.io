<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Graylog æ˜¾ç¤ºGeo IP | åœŸè±†ä¸å¥½åƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="å‡ å‘¨å‰ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œyyetsçš„å†…å­˜ä½¿ç”¨ç‡æš´æ¶¨ï¼Œç›´æ¥ç»™æˆ‘æœºå™¨å¼„æ²¡äº†ã€‚  å†…æ ¸çš„OOMæœºåˆ¶éƒ½æ²¡èµ·ä½œç”¨ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯dockerdçš„é»˜è®¤çš„OOM scoreæ˜¯-500ï¼Œå¯¼è‡´æ²¡äººæ•¢æ€å§ã€‚æœ€è¿‘è¿™å‡ å¤©é…ç½®ä¸Šäº†Graylogæ¥æ”¶é›†æ—¥å¿—ï¼Œä¸‹æ¬¡å†å‡ºç°é—®é¢˜å¯ä»¥çœ‹æ—¥å¿—äº†ï¼Œå¤§æ¦‚è¿™æ ·ï¼š  GraylogåŸºç¡€é…ç½®ã€æ”¶é›†dockeræ—¥å¿—é…ç½®Graylogå€’æ˜¯å¾ˆå®¹æ˜“ï¼Œdocker-composeä¸€æŠŠæ¢­ï¼Œdockerä¹Ÿæ°å·§æ”¯æŒGE">
<meta property="og:type" content="article">
<meta property="og:title" content="Graylog æ˜¾ç¤ºGeo IP">
<meta property="og:url" content="http://example.com/2023/03/25/graylog-geo-ip/index/index.html">
<meta property="og:site_name" content="åœŸè±†ä¸å¥½åƒ">
<meta property="og:description" content="å‡ å‘¨å‰ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œyyetsçš„å†…å­˜ä½¿ç”¨ç‡æš´æ¶¨ï¼Œç›´æ¥ç»™æˆ‘æœºå™¨å¼„æ²¡äº†ã€‚  å†…æ ¸çš„OOMæœºåˆ¶éƒ½æ²¡èµ·ä½œç”¨ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯dockerdçš„é»˜è®¤çš„OOM scoreæ˜¯-500ï¼Œå¯¼è‡´æ²¡äººæ•¢æ€å§ã€‚æœ€è¿‘è¿™å‡ å¤©é…ç½®ä¸Šäº†Graylogæ¥æ”¶é›†æ—¥å¿—ï¼Œä¸‹æ¬¡å†å‡ºç°é—®é¢˜å¯ä»¥çœ‹æ—¥å¿—äº†ï¼Œå¤§æ¦‚è¿™æ ·ï¼š  GraylogåŸºç¡€é…ç½®ã€æ”¶é›†dockeræ—¥å¿—é…ç½®Graylogå€’æ˜¯å¾ˆå®¹æ˜“ï¼Œdocker-composeä¸€æŠŠæ¢­ï¼Œdockerä¹Ÿæ°å·§æ”¯æŒGE">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/2023032503200423.png">
<meta property="og:image" content="http://example.com/images/2023032503200476.jpeg">
<meta property="og:image" content="http://example.com/images/2023032503200540.png">
<meta property="og:image" content="http://example.com/images/2023032503200526.png">
<meta property="og:image" content="http://example.com/images/2023032503200693.png">
<meta property="og:image" content="http://example.com/images/2023032503200764.png">
<meta property="og:image" content="http://example.com/images/2023032503200763.png">
<meta property="og:image" content="http://example.com/images/2023032503200910.png">
<meta property="og:image" content="http://example.com/images/2023032503201012.png">
<meta property="og:image" content="http://example.com/images/2023032503201113.png">
<meta property="og:image" content="http://example.com/images/2023032519363232.png">
<meta property="og:image" content="http://example.com/images/202303250320135.png">
<meta property="og:image" content="http://example.com/images/2023032503201479.png">
<meta property="og:image" content="http://example.com/images/2023032503201563.png">
<meta property="og:image" content="http://example.com/images/2023032503201596.png">
<meta property="og:image" content="http://example.com/images/202303250320151.png">
<meta property="og:image" content="http://example.com/images/2023032503201693.png">
<meta property="og:image" content="http://example.com/images/2023032503201789.png">
<meta property="og:image" content="http://example.com/images/2023032503201861.jpeg">
<meta property="article:published_time" content="2023-03-25T00:00:00.000Z">
<meta property="article:modified_time" content="2023-05-15T18:16:52.045Z">
<meta property="article:author" content="Bennyå°åœŸè±†">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/2023032503200423.png">
  
    <link rel="alternate" href="/atom.xml" title="åœŸè±†ä¸å¥½åƒ" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">åœŸè±†ä¸å¥½åƒ</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-graylog-geo-ip/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/25/graylog-geo-ip/index/" class="article-date">
  <time class="dt-published" datetime="2023-03-25T00:00:00.000Z" itemprop="datePublished">2023-03-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Graylog æ˜¾ç¤ºGeo IP
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>å‡ å‘¨å‰ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œyyetsçš„å†…å­˜ä½¿ç”¨ç‡æš´æ¶¨ï¼Œç›´æ¥ç»™æˆ‘æœºå™¨å¼„æ²¡äº†ã€‚</p>
<p><img src="/images/2023032503200423.png" alt="å›¾è¡¨ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>å†…æ ¸çš„OOMæœºåˆ¶éƒ½æ²¡èµ·ä½œç”¨ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯<code>dockerd</code>çš„é»˜è®¤çš„OOM scoreæ˜¯-500ï¼Œå¯¼è‡´æ²¡äººæ•¢æ€å§ã€‚æœ€è¿‘è¿™å‡ å¤©é…ç½®ä¸Šäº†Graylogæ¥æ”¶é›†æ—¥å¿—ï¼Œä¸‹æ¬¡å†å‡ºç°é—®é¢˜å¯ä»¥çœ‹æ—¥å¿—äº†ï¼Œå¤§æ¦‚è¿™æ ·ï¼š</p>
<p><img src="/images/2023032503200476.jpeg" alt="å›¾ç‰‡åŒ…å« äºº, ç”·äºº, æ±½è½¦, å‰ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="GraylogåŸºç¡€é…ç½®ã€æ”¶é›†dockeræ—¥å¿—"><a href="#GraylogåŸºç¡€é…ç½®ã€æ”¶é›†dockeræ—¥å¿—" class="headerlink" title="GraylogåŸºç¡€é…ç½®ã€æ”¶é›†dockeræ—¥å¿—"></a>GraylogåŸºç¡€é…ç½®ã€æ”¶é›†dockeræ—¥å¿—</h2><p>é…ç½®Graylogå€’æ˜¯å¾ˆå®¹æ˜“ï¼Œ<code>docker-compose</code>ä¸€æŠŠæ¢­ï¼Œdockerä¹Ÿæ°å·§æ”¯æŒGELFåè®®ã€‚Graylogè£…å¥½ä¹‹åï¼Œé…ç½®ä¸€ä¸ªGELFçš„inputï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="/images/2023032503200540.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>å°æç¤ºï¼Œå¦‚æœä½ çš„Graylogæ˜¯ç”¨dockerèµ·çš„ï¼Œé‚£ä¹ˆåœ¨publish portæ—¶è¦é¢å¤–æ³¨æ„ï¼Œdockeré»˜è®¤åªpublish TCPï¼Œæ‰€ä»¥è¦ <code>-p 127.0.0.1:12201:12201/udp</code></p>
<p>ç¡®è®¤è¿è¡Œèµ·æ¥ä¹‹åï¼Œå¯ä»¥å¼€ä¸€ä¸ªå®¹å™¨è¯•è¯•çœ‹ï¼Œæ³¨æ„è¿™é‡Œè¦å†™<code>127.0.0.1</code>ï¼Œå†™<code>localhost</code>çš„è¯ï¼Œdockerdå¯èƒ½ä¼šç»™æå¾ˆå¤šå¹ºè›¾å­(è§£æåˆ°IPv6ç»™ä½ é¢œè‰²çœ‹çœ‹ï¼‰ã€‚</p>
<p>docker run â€“log-driver gelf â€“log-opt gelf-address&#x3D;udp:&#x2F;&#x2F;127.0.0.1:12201 alpine echo hello world</p>
<p>ä¹Ÿå¯ä»¥é€‰æ‹©ç”¨<code>nc</code>å‘ä¸€æ¡æ¶ˆæ¯çœ‹çœ‹</p>
<p>echo -n â€˜{ â€œversionâ€: â€œ1.1â€, â€œhostâ€: â€œexample.orgâ€, â€œshort_messageâ€: â€œA short message againâ€, â€œlevelâ€: 5, â€œ_some_infoâ€: â€œfooâ€ }â€™ | nc -w1 -u localhost 12201</p>
<p>é…ç½®æ— è¯¯çš„è¯å°±åº”è¯¥å·²ç»èƒ½åœ¨æœç´¢é¡µé¢çœ‹åˆ°æ—¥å¿—äº†</p>
<p><img src="/images/2023032503200526.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, ç”µå­é‚®ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="é…ç½®GeoIP"><a href="#é…ç½®GeoIP" class="headerlink" title="é…ç½®GeoIP"></a>é…ç½®GeoIP</h2><p>Graylogå¸¦æœ‰GeoIPçš„æ”¯æŒï¼Œå¯ä»¥è‡ªåŠ¨é€šè¿‡MaxMindçš„æ•°æ®åº“æ˜¾ç¤ºè®¿å®¢çš„IPåœ°å€ã€‚é…ç½®èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œå¹¶ä¸”æ–‡æ¡£éå¸¸æ¨¡ç³Šä¸æ¸…ğŸ¤£</p>
<h3 id="å¯ç”¨Geo-Location-Processor"><a href="#å¯ç”¨Geo-Location-Processor" class="headerlink" title="å¯ç”¨Geo-Location Processor"></a>å¯ç”¨Geo-Location Processor</h3><p>é¦–å…ˆè¦å¯ç”¨è¿™ä¸ªæ¨¡å—ï¼Œåœ¨System - Configurationsæœ€ä¸‹é¢å¯ä»¥çœ‹åˆ°ã€‚éœ€è¦è‡ªå·±å»ä¸‹è½½æ•°æ®åº“</p>
<p>æ‡’å¾—æ³¨å†Œè´¦å·çš„å¯ä»¥å»è¿™é‡Œä¸‹è½½</p>
<p><a target="_blank" rel="noopener" href="https://github.com/P3TERX/GeoLite.mmdb">https://github.com/P3TERX/GeoLite.mmdb</a></p>
<p>è¿™é‡Œçš„Cityåº“æ¯”è¾ƒæ–°</p>
<p><a target="_blank" rel="noopener" href="https://github.com/wp-statistics/GeoLite2-City">https://github.com/wp-statistics/GeoLite2-City</a></p>
<p>ä¸‹è½½å¥½ä¹‹åæ”¾åˆ°æŸä¸ªç›®å½•ï¼Œç¡®ä¿Graylogæœ‰æƒé™è®¿é—®ï¼Œç¡®è®¤å°±è¡Œäº†ï¼Œæˆ‘å°±ç›´æ¥ä¸¢åˆ°äº†å®¿ä¸»æœºçš„volumeçš„ç›®å½•</p>
<p><img src="/images/2023032503200693.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="è°ƒæ•´å¤„ç†é¡ºåº"><a href="#è°ƒæ•´å¤„ç†é¡ºåº" class="headerlink" title="è°ƒæ•´å¤„ç†é¡ºåº"></a>è°ƒæ•´å¤„ç†é¡ºåº</h3><p>System- Configurationsï¼Œæœ€ä¸Šé¢çœ‹ Message Processors Configuration ç¡®ä¿GeoIP Resolveè€Œå·²ç»å¯ç”¨ï¼Œå¹¶ä¸”é¡ºåºæ­£ç¡®ï¼Œè‡³å°‘è¦æ”¾åˆ°pipelineåï¼Œæˆ‘ç»™æ”¾åˆ°æœ€åäº†</p>
<p><img src="/images/2023032503200764.png" alt="åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="Lookup-Table-â€“-Adapters"><a href="#Lookup-Table-â€“-Adapters" class="headerlink" title="Lookup Table â€“ Adapters"></a>Lookup Table â€“ Adapters</h3><p>è¦åˆ›å»ºAdaptersï¼Œè·¯å¾„æ˜¯ System- Lookup Tables- Data Adaptersï¼ŒData Adapter Typeé€‰æ‹© GeoIPçš„é‚£ä¸ª</p>
<p><img src="/images/2023032503200763.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, ç”µå­é‚®ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="Lookup-Table-â€“-Cache"><a href="#Lookup-Table-â€“-Cache" class="headerlink" title="Lookup Table â€“ Cache"></a>Lookup Table â€“ Cache</h3><p>ä¸­é—´çš„é‚£ä¸ªæ ‡ç­¾é¡µï¼Œåˆ›å»ºä¸€ä¸ªcache</p>
<p><img src="/images/2023032503200910.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h3 id="Lookup-Tables"><a href="#Lookup-Tables" class="headerlink" title="Lookup Tables"></a>Lookup Tables</h3><p>ç»ˆäºå¯ä»¥åˆ›å»ºLookup Tablesäº†ï¼Œæœ€å·¦ä¾§çš„æ ‡ç­¾é¡µï¼Œé€‰æ‹©åˆšåˆšåˆ›å»ºå¥½çš„adapterå’Œcacheã€‚è¿™ä¸ªNameæ˜¯å”¯ä¸€çš„ï¼Œä¸‹ä¸€æ­¥è¦ç”¨ï¼Œè®°ä¸‹æ¥å“¦ã€‚</p>
<p><img src="/images/2023032503201012.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="åˆ›å»ºPipelines"><a href="#åˆ›å»ºPipelines" class="headerlink" title="åˆ›å»ºPipelines"></a>åˆ›å»ºPipelines</h2><p>ğŸ˜“è¿˜æ²¡å®Œï¼Œè¿˜è¦åˆ›å»º<code>pipeline</code>å»è°ƒç”¨<code>Lookup Table</code></p>
<h3 id="åˆ›å»ºpipeline-rules"><a href="#åˆ›å»ºpipeline-rules" class="headerlink" title="åˆ›å»ºpipeline rules"></a>åˆ›å»ºpipeline rules</h3><p>System - Pipelines - Manage rules - Create rule</p>
<p>rule sourceæ˜¯æ ¸å¿ƒï¼Œå®šä¹‰äº†æ€ä¹ˆå–IPã€è§£æåæ€æ ·å‘ˆç°æ•°æ®ã€‚æ‹¿æˆ‘çš„ä¸€è¡Œlogä¸ºä¾‹ï¼š</p>
<p><img src="/images/2023032503201113.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>å¦‚æœä½ çš„IPåœ°å€æ˜¯å•ç‹¬çš„ä¸€ä¸ªå­—æ®µä¸­ï¼Œæ¯”å¦‚ä¸Šé¢çš„<code>source</code>ã€<code>container_name</code>è¿™ç§å•ç‹¬çš„ä¸€è¡Œï¼Œé‚£ä¹ˆå°±å¾ˆå®¹æ˜“äº†ï¼Œæ¯”å¦‚è¯´ä½ çš„å­—æ®µå« <code>src_ip</code></p>
<p>rule â€œGeoIP lookupâ€<br>when<br>    has_field(â€œsrc_ipâ€)<br>then<br>    let geo &#x3D; lookup(â€œgeoipâ€, $message.src_ip);<br>    set_field(â€œsrc_ip_geo_locationâ€, geo[â€œcoordinatesâ€]);<br>    set_field(â€œsrc_ip_geo_countryâ€, geo[â€œcountryâ€].iso_code);<br>    set_field(â€œsrc_ip_geo_cityâ€, geo[â€œcityâ€].names.en);<br>end</p>
<p>å¾ˆå¥½ç†è§£ï¼Œå¦‚æœ<code>src_ip</code> å­—æ®µå­˜åœ¨ï¼Œå°±ç”¨<code>geoip</code>è¿™ä¸ªLookup TableæŸ¥è¯¢ï¼Œè¿˜è®°å¾—å§ï¼Œè¿™ä¸ª<code>geoip</code>æ˜¯ä¸Šä¸€æ­¥Lookup Tableçš„Nameã€‚</p>
<p>å¦‚æœä½ çš„æ—¥å¿—æ˜¯åƒæˆ‘è¿™ç§ï¼ŒIPè®°å½•åœ¨messageä¸­ï¼Œé‚£å°±è¿™æ ·ï¼Œå…ˆç”¨<code>grok</code>å»æå–IPåœ°å€ï¼Œç„¶åå†è¿›è¡ŒæŸ¥è¯¢</p>
<p>rule â€œGeoIP lookupâ€<br>when<br>    has_field(â€œmessageâ€)<br>then<br>    let ipObj &#x3D; grok(pattern: â€œ(%{IP})â€, value: to_string($message.message));<br>    &#x2F;&#x2F; ipObj.IP å°±æ˜¯çœŸæ­£çš„IPåœ°å€ï¼Œå¯èƒ½æ˜¯IPv4 ä¹Ÿå¯èƒ½æ˜¯IPv6<br>    let geo &#x3D; lookup(â€œgeoipâ€, ipObj.IP);<br>    set_field(â€œsrc_ip_geo_locationâ€, geo[â€œcoordinatesâ€]);<br>    set_field(â€œsrc_ip_geo_countryâ€, geo[â€œcountryâ€].iso_code);<br>    set_field(â€œsrc_ip_geo_cityâ€, geo[â€œcityâ€].names.en);<br>end</p>
<p>ä½†æ˜¯è¿™æ ·è¿˜ä¸æ˜¯å¾ˆå®Œç¾ï¼Œä»”ç»†è§‚å¯Ÿï¼Œæˆ‘çš„logçš„IPæ˜¯åœ¨<code>()</code>åŒ…å›´ä¸­çš„ï¼Œæœ‰äº›æ—¶å€™æˆ‘ä¹Ÿä¼šç”¨<code>logging.info</code>å»è®°å½•IPï¼Œé‚£ä¹ˆè¿™æ ·å­å°±ä¼šé‡å¤äº†ã€‚æƒ³å½“ç„¶çš„ï¼Œè¿™ä¸œè¥¿çœ‹èµ·æ¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„æ ·å­ï¼Œé‚£ä¹ˆ<code>(\(%&#123;IP&#125;\))</code>ğŸ˜è¾£é¸¡Graylogä¼šç›´æ¥ç»™ä½ æŠ¥é”™ï¼Œæ— æ³•ä¿å­˜</p>
<p>è¿™ä¸ªæ—¶å€™è¦åšçš„äº‹æƒ…æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ Grokè§„åˆ™ï¼Œç„¶åå»åº”ç”¨ï¼Œå¦‚å›¾æ‰€ç¤ºï¼ŒPatternä¸º <code>\(%&#123;IP&#125;\)</code>åå­—éšä¾¿èµ·ä¸€ä¸ª</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/03/2023032519363232.png"><img src="/images/2023032519363232.png"></a></p>
<p>ç„¶åè§„åˆ™é‡Œç”¨<code>(%&#123;Tornado&#125;)</code>å°±å¯ä»¥äº†</p>
<p>é‡åˆ°é—®é¢˜å¯ä»¥ç”¨<code>debug(ip)</code>è¿™ç§å»æ’é”™ï¼ŒGraylogçš„logğŸ¤ªä¼šæ˜¾ç¤ºè¿™ä¸ªå˜é‡çš„å†…å®¹</p>
<h3 id="åˆ›å»ºpipeline"><a href="#åˆ›å»ºpipeline" class="headerlink" title="åˆ›å»ºpipeline"></a>åˆ›å»ºpipeline</h3><p>è¿˜æ²¡å®Œï¼Œåœ¨Manage rulesæ—è¾¹æœ‰ä¸€ä¸ªManage pipelinesï¼Œåˆ›å»ºä¸€ä¸ªpipeline</p>
<p>åå­—éšä¾¿èµ·ï¼Œåˆ›å»ºå¥½ä¹‹å Edit Connections â€“ Default Stream</p>
<p><img src="/images/202303250320135.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç„¶ååˆ›å»ºstageï¼Œrulesé€‰æ‹©åˆšåˆšå¼„å¥½çš„rule</p>
<p><img src="/images/2023032503201479.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº, ç”µå­é‚®ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>Stage 0æ²¡ç”¨å¯ä»¥åˆ æ‰</p>
<p>ä¿å­˜å¥½ï¼Œå›åˆ°ä¸»ç•Œé¢åº”è¯¥èƒ½çœ‹åˆ°IPå’Œåœ°ç†ä½ç½®äº†</p>
<p><img src="/images/2023032503201563.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æ·»åŠ Geo-Location-Map"><a href="#æ·»åŠ Geo-Location-Map" class="headerlink" title="æ·»åŠ Geo Location Map"></a>æ·»åŠ Geo Location Map</h2><p>Graylogæœ‰ä¸€ä¸ªæœ‰ç‚¹æœ‰è¶£çš„åŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®logæ¥åšèšåˆæŸ¥è¯¢ï¼ŒåŒ…æ‹¬GeoIPçš„ä¿¡æ¯ã€‚åœ¨ä¸»ç•Œé¢çš„ä¾§è¾¹å¯ä»¥çœ‹åˆ°aggregation</p>
<p><img src="/images/2023032503201596.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>ç‚¹è¿›å»è¿™æ ·é…ç½®</p>
<p><img src="/images/202303250320151.png" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, æ–‡æœ¬, åº”ç”¨ç¨‹åº æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<p>Update widget å°±æœ‰äº†ï¼Œå¤§æ¦‚è¿™æ ·</p>
<p><img src="/images/2023032503201693.png" alt="æˆªå›¾é‡Œæœ‰å›¾ç‰‡ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ol>
<li>logæœåŠ¡å™¨å’Œåº”ç”¨æœåŠ¡å™¨ä¸è¦åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå¦åˆ™åˆ°æ—¶å€™ä¸€èµ·æŒ‚äº†ï¼Œéƒ½æ²¡å¾—çœ‹</li>
<li>ğŸ˜ <a target="_blank" rel="noopener" href="https://dmesg.app/yyets-hack.html">è‡ªä»è¢«æ‰“ä¹‹å</a>ï¼Œæˆ‘å†ä¹Ÿä¸ç›‘å¬<code>0.0.0.0</code>äº†ï¼Œä¸€åˆ‡å…¨é  Cloudflare Argo Tunnel è§£å†³ï¼Œè¿nginxéƒ½ä¸éœ€è¦</li>
<li>æ–°ç‰ˆæœ¬çš„dockerï¼ˆ20.10èµ·ï¼‰ä¹Ÿå¯ä»¥çœ‹GELFçš„logï¼Œä½†æ˜¯<code>docker-compose</code>ä¸å¯ä»¥</li>
<li>è¿™<a target="_blank" rel="noopener" href="https://www.graylog.org/post/how-to-set-up-graylog-geoip-configuration/">Graylogçš„æ–‡æ¡£</a>æ˜¯çœŸçš„ç»ï¼Œè¯´å¾—ä¸æ˜ä¸ç™½çš„ï¼Œç”šè‡³è¿˜æœ‰å…¨è§’å¼•å·</li>
</ol>
<p><img src="/images/2023032503201789.png" alt="æ–‡æœ¬, ä¿¡ä»¶ æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>
<ol start="8">
<li><p>æ²¡å¤ªå¤šæœ‰ç”¨çš„èµ„æ–™ï¼Œæœåˆ°çš„å°±æ˜¯ä»–ä»¬å®˜æ–¹çš„è®ºå›</p>
</li>
<li><p>ğŸ¤¡è¿˜æœ‰undefinedçš„bugï¼Œåæ¥åˆ°MongoDBé‡Œæ‰‹åŠ¨åˆ é™¤çš„</p>
</li>
</ol>
<p><img src="/images/2023032503201861.jpeg" alt="å›¾å½¢ç”¨æˆ·ç•Œé¢, åº”ç”¨ç¨‹åº, Teams æè¿°å·²è‡ªåŠ¨ç”Ÿæˆ"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/25/graylog-geo-ip/index/" data-id="clhp7rtgh003ds2qr2coj3mro" data-title="Graylog æ˜¾ç¤ºGeo IP" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/04/01/cf-zero-trust/index/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ä½¿ç”¨Cloudflare Zero Truståˆ›å»ºå¤§å†…ç½‘
        
      </div>
    </a>
  
  
    <a href="/2023/03/14/argo-real-ip/index/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Nginxä¸æ˜¾ç¤ºArgo Tunnelåç”¨æˆ·çœŸå®IPï¼Ÿ</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/">azure</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/12/aca-php/index/">ç”¨ Azure Container Apps è¿è¡ŒPHPç½‘ç«™</a>
          </li>
        
          <li>
            <a href="/2024/10/06/aca-vm-scale/index/">Azure Container Apps è¿æ¥åˆ°è™šæ‹Ÿæœºå¹¶é…ç½®CPUè‡ªåŠ¨ç¼©æ”¾</a>
          </li>
        
          <li>
            <a href="/2024/09/28/worker-image-metadata/index/">ä½¿ç”¨ Cloudflare Workerè·å–å›¾ç‰‡å…ƒæ•°æ®</a>
          </li>
        
          <li>
            <a href="/2024/09/27/workers-function/index/">å°† Cloudflare Workers è¿ç§»åˆ° Azure Function</a>
          </li>
        
          <li>
            <a href="/2024/09/21/one-api-clickhouse/index/">one-api/new-apiæ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ ClickHouse ä½œä¸ºæ—¥å¿—ç³»ç»Ÿ</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Bennyå°åœŸè±†<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>