<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>土豆不好吃</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="土豆不好吃">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="土豆不好吃">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Benny小土豆">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="土豆不好吃" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">土豆不好吃</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-azure-waf/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/07/17/azure-waf/index/" class="article-date">
  <time class="dt-published" datetime="2024-07-17T00:00:00.000Z" itemprop="datePublished">2024-07-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/07/17/azure-waf/index/">救命！我的 Azure Front Door WAF 规则不生效怎么办！</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近在用 Front Door加速网站访问，想添加一个这样的规则：只允许 <code>/v1</code>下的路径和特定国家的IP，其他全部禁止。</p>
<p>这其实很简单的！只要创建两条 WAF规则，一个禁止全部优先级低，一个允许特定路径，优先级高。</p>
<h2 id="100优先级的允许规则"><a href="#100优先级的允许规则" class="headerlink" title="100优先级的允许规则"></a>100优先级的允许规则</h2><p><img src="/images/2024071623480019.png"></p>
<p>看起来一点问题都没有吧，非常简单容易理解</p>
<h2 id="500-优先级阻止规则"><a href="#500-优先级阻止规则" class="headerlink" title="500 优先级阻止规则"></a>500 优先级阻止规则</h2><p><img src="/images/2024071623480112.png"></p>
<p>也很好理解，阻止全部</p>
<h2 id="没用！"><a href="#没用！" class="headerlink" title="没用！"></a>没用！</h2><p>配置下来就是不生效，所有的请求都被阻止了。给阻止规则停用，就全部能访问。</p>
<p>从<code>azure-cli</code>里看下WAF的配置，避免他们前端有bug</p>
<p>{<br>    “rules”: [<br>        {<br>            “action”: “Allow”,<br>            “enabledState”: “Enabled”,<br>            “groupBy”: [],<br>            “matchConditions”: [<br>                {<br>                    “matchValue”: [<br>                        “&#x2F;v1”<br>                    ],<br>                    “matchVariable”: “RequestUri”,<br>                    “negateCondition”: false,<br>                    “operator”: “BeginsWith”,<br>                    “transforms”: []<br>                },<br>                {<br>                    “matchValue”: [<br>                        “CN”<br>                    ],<br>                    “matchVariable”: “SocketAddr”,<br>                    “negateCondition”: false,<br>                    “operator”: “GeoMatch”,<br>                    “transforms”: []<br>                }<br>            ],<br>            “name”: “Allow”,<br>            “priority”: 100,<br>            “rateLimitDurationInMinutes”: 1,<br>            “rateLimitThreshold”: 100,<br>            “ruleType”: “MatchRule”<br>        },<br>        {<br>            “action”: “Block”,<br>            “enabledState”: “Enabled”,<br>            “groupBy”: [],<br>            “matchConditions”: [<br>                {<br>                    “matchValue”: [],<br>                    “matchVariable”: “RequestUri”,<br>                    “negateCondition”: false,<br>                    “operator”: “Any”,<br>                    “transforms”: []<br>                }<br>            ],<br>            “name”: “Deny”,<br>            “priority”: 500,<br>            “rateLimitDurationInMinutes”: 1,<br>            “rateLimitThreshold”: 100,<br>            “ruleType”: “MatchRule”<br>        }<br>    ]<br>}</p>
<p>从结果来看，完全没问题。给规则从 begins with 改成 contains又可以，但是那也意味着<code>https://cn-test.burn.hair/login?id=v1</code>也会允许，而这不太行</p>
<p><img src="/images/2024071623480151.png"></p>
<h2 id="看看-log"><a href="#看看-log" class="headerlink" title="看看 log"></a>看看 log</h2><p>没办法了，开 log 试试看吧，不行就联系 Azure Support</p>
<p>先要去 Log Analytics workspaces 里开一个记录日志的奇怪的东西</p>
<p><img src="/images/202407162348023.png"></p>
<p>然后去 Diagnostic settings 里 把这个东西和 Front Door、Workspaces关联起来</p>
<p><img src="/images/2024071623480237.png"></p>
<p>然后去log页面运行这样的一个查询，绝了连看日志都得学习查询语法😓</p>
<p>AzureDiagnostics<br>| where ResourceProvider &#x3D;&#x3D; “MICROSOFT.NETWORK” and Category &#x3D;&#x3D; “FrontdoorWebApplicationFirewallLog”</p>
<p>然后就能看到 WAF的日志了</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/07/2024071623525456.png"><img src="/images/2024071623525456.png"></a></p>
<h2 id="什么？？"><a href="#什么？？" class="headerlink" title="什么？？"></a>什么？？</h2><p>WTF？谁家 <code>requestUri</code>这么写啊 还带端口的，怪不得我配置的 begins with &#x2F;v1 不好用，但是contains就行……</p>
<p><img src="/images/202407162348049.png" alt="图片包含 徽标 描述已自动生成"></p>
<p>火速去 WAF 里，改一下规则，给matches value改成完整的路径就好了</p>
<p><a target="_blank" rel="noopener" href="https://cn-test.burn.hair/v1">https://cn-test.burn.hair:443/v1</a></p>
<p><img src="/images/2024071623480516.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>😢 问题解决了，开的各种东西可以去 Resource Group 里删除了</p>
<hr>
<p>「不愧是 Azure，从定价，到文档，到使用，没一个符合直觉」</p>
<p>—— Nova Kowk</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/07/17/azure-waf/index/" data-id="clyujt8ar00015yjf53hmhquz" data-title="救命！我的 Azure Front Door WAF 规则不生效怎么办！" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-azure-fd/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/07/16/azure-fd/index/" class="article-date">
  <time class="dt-published" datetime="2024-07-16T00:00:00.000Z" itemprop="datePublished">2024-07-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/07/16/azure-fd/index/">使用Azure Front Door 和 Load Balancer</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>一般来说，做个网站，并开放给全世界，有以下几种方式：</p>
<ol>
<li>直接使用公网IP+端口号</li>
<li>买个域名，做解析，使用域名访问</li>
<li>套上 Cloudflare，让 Cloudflare去反向代理源站</li>
<li>用 Cloudflare Argo Tunnel，服务器有没有公网IP都无所谓了</li>
<li>其他CDN方案</li>
</ol>
<p>最近在用 Azure，一直想利用一下他们的Front Door。简单的摸索了一下如何把Front Door、Load Balancer 和 vm三者结合起来使用。</p>
<h2 id="创建一台-vm"><a href="#创建一台-vm" class="headerlink" title="创建一台 vm"></a>创建一台 vm</h2><p>不分配公网 IP 没关系，简单起见这里先只创建一个了</p>
<h2 id="创建-LB"><a href="#创建-LB" class="headerlink" title="创建 LB"></a>创建 LB</h2><p><img src="/images/2024071603033180.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>给 LB的类型设置为 Public，创建一个IP，可以选Microsoft网络也可以选公网，具体区别可以看 <a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure/virtual-network/ip-services/routing-preference-overview">https://learn.microsoft.com/zh-cn/azure/virtual-network/ip-services/routing-preference-overview</a></p>
<p><img src="/images/2024071603033238.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>添加 NIC，选择虚拟机的那个网卡</p>
<p><img src="/images/2024071603033362.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>此负载均衡器会有一个公网IP地址，并且连接到了我们的vnet，只是我们还没有定义 NAT出入规则，所以还需要继续配置</p>
<p>打开LB的Inbound NAT rules，由于我们的backend其实只有一台vm，因此类型选择 azure 虚拟机就可以了</p>
<p><img src="/images/2024071603033459.png" alt="图形用户界面, 应用程序 描述已自动生成"></p>
<p>这个时候 ssh 就会发现能够连到vm啦，但是vm还上不了网</p>
<p><img src="/images/2024071603033588.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>要添加出网规则机器才能上网，outbound rules中添加一个</p>
<p><img src="/images/2024071603033620.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<p>Port allocation 选择 default就行</p>
<p>这个时候机器就可以上网了，体验了一把自己配置 SNAT的快感🤡</p>
<p>那就先跑个nginx 方便我们后续测试 http</p>
<p>sudo docker run -d -p 80:80 nginx:alpine<br>curl localhost</p>
<p>之后时候你在这台机器外面 <code>curl</code> 还是不行的，因为还得继续加一条 inbound 80 规则和上面一样，这时在外面就可以访问啦！</p>
<h2 id="创建-Front-Door"><a href="#创建-Front-Door" class="headerlink" title="创建 Front Door"></a>创建 Front Door</h2><p>Front door有三种，Classic、Standard、Premium</p>
<p>Classic即将在2027年3月退役</p>
<p>Classic 按照流量和路由规则、WAF等计费，Standard、Premium则是月费、流量和请求数量计费。</p>
<p>按照提示来就行，之后 Front Door会让我们配置</p>
<h3 id="Domain"><a href="#Domain" class="headerlink" title="Domain"></a>Domain</h3><p>Domain 那里就选创建 Front Door的时候的那个域名</p>
<p><img src="/images/2024071603033773.png" alt="图形用户界面, 文本, 应用程序, Teams 描述已自动生成"></p>
<h3 id="Backend-pools"><a href="#Backend-pools" class="headerlink" title="Backend pools"></a>Backend pools</h3><p>需要注意这里 https port也要写80</p>
<p>因为在我们的vm上只跑了80端口，所以只能都80。如果我们的应用是跑在其他端口的话，也要跟着更改</p>
<p><img src="/images/2024071603033839.png" alt="图形用户界面, 文本, 应用程序 描述已自动生成"></p>
<h3 id="routing-rules"><a href="#routing-rules" class="headerlink" title="routing rules"></a>routing rules</h3><p>要注意 forwarding protocol 选择 http only，原因同上</p>
<p><img src="/images/2024071603033860.png" alt="图形用户界面, 文本, 应用程序, 电子邮件 描述已自动生成"></p>
<p>然后部署，等几分钟，就有啦</p>
<p><img src="/images/2024071603033997.png" alt="图形用户界面, 文本, 应用程序, 电子邮件 描述已自动生成"></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li>Azure Front Door Premium 可以用 Private Link 连接到内部负载均衡器。但是 Premium 月费要330美元，我可能确实用不起……</li>
<li>如果单机性能足够，那么给vm分配个公网IP，然后配置 Front Door写这个IP就行</li>
<li>如果单机性能不够，那么可以再加多台vm，然后用LB做负载均衡；也可以直接 Front Door 加 backend pool</li>
<li>走微软全球网络路由的性能应该不错</li>
</ol>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/azure/frontdoor/front-door-faq">https://learn.microsoft.com/en-us/azure/frontdoor/front-door-faq</a></li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure/frontdoor/standard-premium/how-to-enable-private-link-internal-load-balancer">https://learn.microsoft.com/zh-cn/azure/frontdoor/standard-premium/how-to-enable-private-link-internal-load-balancer</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/07/16/azure-fd/index/" data-id="clyujt89y00005yjf7dlbdiq6" data-title="使用Azure Front Door 和 Load Balancer" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-usdt-trc20-scam/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/30/usdt-trc20-scam/index/" class="article-date">
  <time class="dt-published" datetime="2024-04-30T00:00:00.000Z" itemprop="datePublished">2024-04-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/what/">what</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/30/usdt-trc20-scam/index/">警惕USDT-TRC20 数字货币诈骗</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近看到一种很有趣的数字货币诈骗方法，有人有意无意在群里、论坛或者其他公开的地方，泄漏自己的助记词，往往是Tron这个链，然后这个钱包里有大概几十到几百USDT，比如下图这样</p>
<p><img src="/images/202404300152573.png" alt="A screenshot of a phone Description automatically generated"></p>
<p>一般来说这种钱包TRX会比较少，多一点的也有，其实没关系的。</p>
<p>众所周知，进行 USDT 转账是需要 TRX做燃料的。有些人可能就想到了……</p>
<ol>
<li>既然有助记词，那么就可以导入到自己的钱包里</li>
<li>从别的地方转进来几十 TRX做gas</li>
<li>然后把这几百USDT转走，白嫖成功</li>
</ol>
<p>事情哪有那么简单！</p>
<h2 id="偷取燃料费"><a href="#偷取燃料费" class="headerlink" title="偷取燃料费"></a>偷取燃料费</h2><p>当你把 TRX 转进来之后，还没等这笔钱热乎，就会被瞬间转走！</p>
<p>比如在上图中我们看到的这个例子，他的地址是 TAvwgoX6zbExfotsgP351QxxCoHGH8mmyb ，通过查询 tronscan我们可以查询一个地址的所有交易记录，我这里用不同颜色的做了标记：</p>
<p><img src="/images/2024043001525863.png" alt="A screenshot of a computer Description automatically generated"></p>
<p>我们可以很清楚地看到，受害者向 mmyb的地址转账，慢则5分钟，快则几十秒，这笔TRX就会被转到 Mh4J 的地址。截止到目前为止，这个地址已经骗了$90了。</p>
<p>我还有另外一个例子，也是一样的手段</p>
<p><img src="/images/2024043001525832.png" alt="A screenshot of a computer Description automatically generated"></p>
<h2 id="拼手速？"><a href="#拼手速？" class="headerlink" title="拼手速？"></a>拼手速？</h2><p>假如你也会写点代码，你可能在想，哎不就是拼手速嘛！转点TRX进去，然后瞬间再转走 USDT，全程代码操作延迟1秒，那不就白嫖成功了嘛！</p>
<p>有这种想法不得不说非常聪明，然而骗子也早就想到了这一点，骗子也不想偷鸡不成蚀把米。如果你注意看 tronscan地址下的提示信息：</p>
<p><img src="/images/2024043001525929.png" alt="A close-up of a computer screen Description automatically generated"></p>
<blockquote>
<p>The current account’s “Owner Permission” is authorized to:TDtwL9uggJ1qBhWW83z6q7ssNdhi12356L</p>
<p>The current account’s “Active Permission” is authorized to:TDtwL9uggJ1qBhWW83z6q7ssNdhi12356LView Account Permission</p>
</blockquote>
<p>Tron的一个特性之一是，可以把自己地址的权限转移给另一个地址。权限本身是独立的、唯一归属的，要么归你要么归我。</p>
<p>通常来说我们使用这个地址对应的私钥签名的，但是把权限转移给另外一个地址之后，就可以用那个地址的私钥签名了。</p>
<p>在这个例子中，这个蜜罐地址 mmyb 的全部权限都被转移给了另外一个 356L的地址，mmyb的私钥因为缺失权限，是无法签名交易的。 [v_blue]更进一步，Tron还可以设置mult-sig（多重签名），需要多个私钥+权重计算才可以完成某个操作，有点像大家开会表决。 [&#x2F;v_blue] 😂所以，即使你手速够快，也会发现自己没权限动这个资金。</p>
<p>当然了，如果你发现一个地址的权限没有被更改过，那可能确实是天上掉馅饼了。</p>
<h2 id="我被骗了吗"><a href="#我被骗了吗" class="headerlink" title="我被骗了吗"></a>我被骗了吗</h2><p>哈！😏😏😏</p>
<p><img src="/images/2024043001530159.png" alt="A screenshot of a video game Description automatically generated"></p>
<p>哈，你终于领悟了成为传奇的诀窍……拿上你的家伙，咱们走。</p>
<hr>
<p>我可是传奇，想要骗我可没那么容易😉😉😉</p>
<h2 id="参考阅读"><a href="#参考阅读" class="headerlink" title="参考阅读"></a>参考阅读</h2><p><a target="_blank" rel="noopener" href="https://www.exodus.com/support/en/articles/8598817-what-crypto-scams-should-i-watch-out-for#honeypot">https://www.exodus.com/support/en/articles/8598817-what-crypto-scams-should-i-watch-out-for#honeypot</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/04/30/usdt-trc20-scam/index/" data-id="clyujt8bi00075yjff1921dwp" data-title="警惕USDT-TRC20 数字货币诈骗" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-telegram-login-widget-verify-data/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/21/telegram-login-widget-verify-data/index/" class="article-date">
  <time class="dt-published" datetime="2024-04-21T00:00:00.000Z" itemprop="datePublished">2024-04-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/21/telegram-login-widget-verify-data/index/">Telegram Login Widget 如何验证用户数据</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>使用<a target="_blank" rel="noopener" href="https://core.telegram.org/widgets/login">Telegram 做OAuth</a>是一件很容易的事情，毕竟整个 Telegram API 都相当开放。</p>
<p>需要注意的一件事情就是，我们需要验证用户的数据确实是来自于 Telegram而不是第三方伪造的。无论是在回调函数还是回调URL中，Telegram都会提供如下参数： id, first_name, last_name, username, photo_url, auth_date, hash 根据官方文档的说法，验证数据分如下几步：</p>
<ol>
<li> 把这些字段按照字母顺序排序，组成一个字符串，每一个键值对之间用换行符隔开，如 <code>&#39;auth_date=&lt;auth_date&gt;\nfirst_name=&lt;first_name&gt;\nid=&lt;id&gt;\nusername=&lt;username&gt;&#39;</code></li>
<li>计算 bot token 的 sha256</li>
<li>计算 HMAC_SHA256，明文是上面的这个字符串，密码是bot token 的sha256，然后计算这个结果的hex，比对与他提供的 hash是否相等</li>
</ol>
<p>看起来很简单是不是，随便丢给 ChatGPT就能出结果。甚至官方还给了个<a target="_blank" rel="noopener" href="https://gist.github.com/anonymous/6516521b1fb3b464534fbc30ea3573c2">PHP的代码</a></p>
<p>但是很抱歉的是，这样并不能给保证100%验证成功，甚至可能会完全无法验证。以下是我踩的两个坑</p>
<h2 id="hash字段要排除"><a href="#hash字段要排除" class="headerlink" title="hash字段要排除"></a>hash字段要排除</h2><p>在组装字符串的时候，记得排除hash字段，要不然是不可能计算出正确的结果的。</p>
<h2 id="值是空的字段要排除"><a href="#值是空的字段要排除" class="headerlink" title="值是空的字段要排除"></a>值是空的字段要排除</h2><p>在 Telegram 中，username、photo_url 等字段不是必须的。在计算时，这种类型的字段<strong>如果为空，那么不需要考虑</strong>。</p>
<p>可怕的是，无论是官方文档，还是PHP示例代码，都没有提到值是空的字段不参与计算的事情。😢</p>
<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h2><h3 id="Go-的示例代码"><a href="#Go-的示例代码" class="headerlink" title="Go 的示例代码"></a>Go 的示例代码</h3><p>type TelegramAuthData struct {<br>    Id        int    `json:”id”`<br>    FirstName string `json:”first_name”`<br>    LastName  string `json:”last_name”`<br>    Username  string `json:”username”`<br>    PhotoUrl  string `json:”photo_url”`<br>    AuthDate  int    `json:”auth_date”`<br>    Hash      string `json:”hash”`<br>}</p>
<p>func verifyTelegramAuthData(data TelegramAuthData) bool {<br>    &#x2F;&#x2F; Extracting fields and preparing for sorting.<br>    fields :&#x3D; map[string]string{<br>        “auth_date”:  strconv.Itoa(data.AuthDate),<br>        “first_name”: data.FirstName,<br>        “last_name”:  data.LastName,<br>        “id”:         strconv.Itoa(data.Id),<br>        “photo_url”:  data.PhotoUrl,<br>        “username”:   data.Username,<br>    }</p>
<pre><code>// Sorting the fields to create the data-check-string.
var keys \[\]string
for key := range fields &#123;
    keys = append(keys, key)
&#125;
sort.Strings(keys)

var dataCheckString string
for \_, key := range keys &#123;
    if fields\[key\] != &quot;&quot; &#123;
        dataCheckString += fmt.Sprintf(&quot;%s=%s\\n&quot;, key, fields\[key\])
    &#125;
&#125;
dataCheckString = dataCheckString\[:len(dataCheckString)-1\] // Remove the last newline character

// Calculate the SHA256 hash of the bot&#39;s token.
hasher := sha256.New()
hasher.Write(\[\]byte(botToken))
secretKey := hasher.Sum(nil)

// Compute the HMAC-SHA-256 signature.
hmacHasher := hmac.New(sha256.New, secretKey)
hmacHasher.Write(\[\]byte(dataCheckString))
computedHash := hex.EncodeToString(hmacHasher.Sum(nil))

// Compare the computed HMAC with the received hash.
return computedHash == data.Hash
</code></pre>
<p>}</p>
<h3 id="Python-版本"><a href="#Python-版本" class="headerlink" title="Python 版本"></a>Python 版本</h3><p>def verify_telegram_authdata(data: dict) -&gt; bool:<br>    # Extracting fields and preparing for sorting<br>    fields &#x3D; {<br>        “auth_date”: data.get(“auth_date”),<br>        “first_name”: data.get(“first_name”),<br>        “last_name”: data.get(“last_name”),<br>        “id”: data.get(“id”),<br>        “photo_url”: data.get(“photo_url”),<br>        “username”: data.get(“username”),<br>    }</p>
<pre><code># Sorting the fields to create the data-check-string
keys = sorted(fields)
data\_check\_string = &quot;\\n&quot;.join(f&quot;&#123;key&#125;=&#123;fields\[key\]&#125;&quot; for key in keys if fields\[key\])

# Calculate the SHA256 hash of the bot&#39;s token
hasher = hashlib.sha256()
# bot token token
hasher.update(&quot;token&quot;.encode(&quot;utf-8&quot;))
secret\_key = hasher.digest()

# Compute the HMAC-SHA-256 signature
hmac\_hasher = hmac.new(secret\_key, data\_check\_string.encode(&quot;utf-8&quot;), hashlib.sha256)
computed\_hash = hmac\_hasher.hexdigest()

# Compare the computed HMAC with the received hash
return computed\_hash == data.get(&quot;hash&quot;)
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/04/21/telegram-login-widget-verify-data/index/" data-id="clyujt8bh00055yjf43e151d5" data-title="Telegram Login Widget 如何验证用户数据" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-physical-esim/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/03/23/physical-esim/index/" class="article-date">
  <time class="dt-published" datetime="2024-03-23T00:00:00.000Z" itemprop="datePublished">2024-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/what/">what</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/03/23/physical-esim/index/">物理化 eSIM</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>众所周知，国行 iPhone 是不支持 eSIM的。那么有没有办法让国行 iPhone也能过试用 eSIM运营商呢？答案当然是有的啦。</p>
<p>国内有几个厂商在做这个，比如 ESTK.me， 5ber 国外还有一个 eSIM.me。使用起来不复杂，买他们的SIM卡，然后通过软件，通常是Android手机把eSIM Profile写到这张卡里，然后把这个卡插到手机里就可以了。</p>
<p>问题来了，我又没有 Android 手机，而且这些厂商往往都会通过软件手段限制写入。比如 5ber这里，按照下载次数收费的</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304270581.png"><img src="/images/2024032304270581.png"></a></p>
<p> </p>
<p>有没有别的办法呢？当然有的啦，读卡器</p>
<p> </p>
<h2 id="智能卡读卡器"><a href="#智能卡读卡器" class="headerlink" title="智能卡读卡器"></a>智能卡读卡器</h2><p>去神奇的淘宝可以买到这种设备，价格不贵，大概20-30人民币</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304291564.jpg"><img src="/images/2024032304291564.jpg"></a></p>
<p> </p>
<h2 id="eSIM-card"><a href="#eSIM-card" class="headerlink" title="eSIM card"></a>eSIM card</h2><p>可以去上面提到的那些厂商买，也有一些其他的厂商，可以自行搜索。</p>
<p>如果购买5ber的话，他们的官网在这里 <a target="_blank" rel="noopener" href="https://esim.5ber.com/?language=en-US">https://esim.5ber.com/?language=en-US</a></p>
<p>使用邀请码 <strong>E6ARJX</strong> 可能会有优惠。另外，联想有一款 ThinkPad Thales eSIM card 亲测可用</p>
<p>写卡</p>
<p>我直接用了 EasyLPAC，图形界面方便操作。把卡片插进去，软件就应该能读到。500KB大概够写十几个了</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304411623.png"><img src="/images/2024032304411623.png"></a></p>
<p> </p>
<p>切换到 Profile选项卡，点Download 输入运营商给的信息，然后Enable，拔卡插手机即可</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/03/2024032304422821.png"><img src="/images/2024032304422821.png"></a></p>
<p> </p>
<p>写卡次数限制？不存在的，想写多少写多少，别超了就行。🤷</p>
<p>当然了每次要换卡也比较麻烦就是了……这个没办法，早日换支持 eSIM的设备就好了</p>
<p> </p>
<h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><ul>
<li><a target="_blank" rel="noopener" href="https://sparktour.me/2022/11/20/configure-esim-me-card-with-pc-sc-reader/">通过PC&#x2F;SC智能卡读卡器配置esim.me的SIM卡</a> </li>
<li><a target="_blank" rel="noopener" href="https://iecho.cc/2023/10/20/Convert-eSIM-to-physical-SIM/">eSIM 转 SIM 实体卡</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/03/23/physical-esim/index/" data-id="clyujt8bf00035yjffif8ho0y" data-title="物理化 eSIM" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-immersion/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/03/immersion/index/" class="article-date">
  <time class="dt-published" datetime="2024-02-03T00:00:00.000Z" itemprop="datePublished">2024-02-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/03/immersion/index/">沉浸感</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>我很喜欢玩赛博朋克2077，在往日之影发布之前很久已经清完了所有的支线和委托。往日之影发布之后，我熬了两个晚上，玩完了全部四个分支。</p>
<p>随后我就出去旅游了。往日之影的结局是在是太让我感到无力了，那个时候我就坐在酒店的阳台上发呆。为什么会这样啊，我很难过。与其这样生活，真的不如再活半年，或者把身体留给强尼，至少这样不会失去朋友啊。</p>
<p>人们总是很容易把艺术作品中的情形代入到自己的生活中，或者反之。</p>
<p>那个时候我在日记里写道</p>
<blockquote>
<p>这也像极了现在的我。我在一点点失去我的朋友，我找不到生活的目标，这样的生活，远远不如以前开心。可生活不是游戏，没办法轻松重新选择故事走向。每次重新选择，都要承担巨大的代价和后果。</p>
</blockquote>
<hr>
<p>在赛博朋克之后，我再也没有精力去如此品玩任何其他的游戏。可能是怕试错成本太高，很难找到符合我的喜好的游戏。Game Pass Ultimate过期之后也没有再续费，因为感觉自己完全找不到能玩的游戏。</p>
<p>在影视作品中，我有些时候也会有这种感觉。</p>
<p>最近白嫖了 Apple TV+，然后熬了三四个晚上看完了灵异女仆。 电视剧的节奏挺慢的，至少说在惊悚悬疑题材里这个节奏很慢，还好我没有追剧。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/01/2024013122284421-scaled.jpg"><img src="/images/2024013122284421-scaled.jpg"></a></p>
<p>我很喜欢女主Leanne的人设和演员的演绎，Leanne只不过是童年破碎的受害者，她把自己对亲生母亲的期望全部投射到Dorothy身上。 男主一家人里如果有一个人能稍微正常点，那么结局会不会好一点？ 只有厨师小弟对 Leanne 很好，没有理由也没有利益的羁绊，只是可惜那场约会永远也不会到来……</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2024/02/2024020605495956-scaled.jpg"><img src="/images/2024020605495956-scaled.jpg"></a></p>
<hr>
<p>哎所以我总是很怕这样。一方面是怕自己陷得太深，另一方面是怕自己以后很难发现更好的文艺作品。</p>
<p>我毫不犹豫的熬夜，只是想把自己沉浸在这些作品所营造的背景和氛围之内，这样我就可以暂时忘记发生在现实生活中的种种烦恼与问题，这样我就可以忽略问题，像鸵鸟一样把头埋在沙子里。 然而一旦看完这部电影，玩通那个游戏，这样的沙子也就不复存在，也就只能面对现实和无奈。🤷</p>
<p>有时候可能看看爽剧，玩一玩那些无脑爽游戏（比如最近几年的使命召唤），只是娱乐放松而没有沉浸，这样可能会对我的心理状态有更好的帮助。沉浸感太强，有的时候可能也不是一件好事🫠</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/03/immersion/index/" data-id="clyujt8au00025yjfb1atdv1w" data-title="沉浸感" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2023-end/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/31/2023-end/index/" class="article-date">
  <time class="dt-published" datetime="2023-12-31T00:00:00.000Z" itemprop="datePublished">2023-12-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/31/2023-end/index/">2023 年终总结</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>很多年没有写年终总结了。有很多事情都是2022年年底的发生的，四舍五入也算2023年的吧！</p>
<h2 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h2><p>2023年一共写了16篇博文，从数量上看起来比较少，从质量上看则更是堪忧🙃️</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023122902195115.png"><img src="/images/2023122902195115.png"></a></p>
<p>这一年学习到了很多有用没用的知识。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/stripe-telegram.html">如何使用 Stripe API</a> ，应用到了 WebP Cloud Services 上</p>
</li>
<li><p>meilisearch，<a target="_blank" rel="noopener" href="https://dmesg.app/meilisearch.html">一个轻量级的全文搜索引擎</a>，支持CJK，正好拿来给 <a target="_blank" rel="noopener" href="https://dmesg.app/telegram-cjk-search.html">SearchGram</a> 用</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/graylog-geo-ip.html">学习配置了一下 Graylog</a>。是挺炫酷，但是从来不看，现在已经被我删掉了</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/cloudflare">学习使用 Cloudflare Zero Trust</a>中的一些组件。其实我是一周左右就弄懂了，但是故意隔开几天发博客</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/lede-shadowtls.html">在 LEDE&#x2F;OpenWRT 上使用ShadowTLS</a>，由于我用的是cnroute，所以打环了需要额外配置一下</p>
</li>
</ul>
<p>在这之后，我的博客就停更了差不多半年左右。这半年里我和 <a target="_blank" rel="noopener" href="https://github.com/n0vad3v">Nova</a> 还有 <a target="_blank" rel="noopener" href="https://github.com/tukideng">Tuki</a> 开发并运营了 **<a target="_blank" rel="noopener" href="https://webp.se/">WebP Cloud Services</a>**。这个想法来自于3年前的WebP Server Go，区别是Cloud Services功能更多更强大，而且是托管的SaaS服务。</p>
<p>这半年里我也写了博文，只不过放在了 <a target="_blank" rel="noopener" href="https://blog.webp.se/">WebP Cloud Services Blog</a> 上。为了增加受众，并且我们的目标是出海，我们还用 ChatGPT 翻译了英文版本的。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/golang-libvips-cgo-zh/">libvips, cgo, purego</a> 切换到 libvips 之后我们一直希望能够实现交叉编译（静态链接就别想了，这永远只是一个梦），然而，即便交叉编译，那也是梦里才有的事情……</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/govips-filter-zh/">使用 libvips 实现CSS滤镜</a>，看了 W3C的文档，学会了如何做渐变，甚至还学习了一些高等数学的知识</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/cve-2023-4863-fix-zh/">手动编译了一下 libwebp</a>，啥也没学会，只听见电表起飞的声音</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://blog.webp.se/change-loglevel-runtime-zh/">在运行时通过UNIX 信号 修改loglevel</a>，UNIX哲学。不过，这个过程中我写出来了一个 bug，会<a target="_blank" rel="noopener" href="https://blog.webp.se/goroutine-leak-zh/">导致goroutine泄漏</a>，然后CPU使用率缓慢升高。哎，有时还是不能太相信AI啊。</p>
</li>
</ul>
<p>然后，我就又回到了🥔不好吃</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/es-ee-se-unicode.html">西班牙、爱沙尼亚吞并了瑞典的故事</a>，unicode真是太神奇且深奥啦</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/steam-deck-stuck.html">steam deck 游戏卡logo</a>，从 steam community翻到了然后抄过来的🤣</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/nodejs-dual-stack.html">Nodejs 双栈协议踩坑</a>，nodejs 真™️™️的草台班子。和JavaScript一样草台</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://dmesg.app/tron-trx.html">Tron（TRX）收款</a>，本王终于进入币圈了，学习了 HD钱包的原理，给 go <a target="_blank" rel="noopener" href="https://github.com/ranjbar-dev/tron-wallet">tron-wallet</a> 贡献了代码。 WebP Cloud Services 也支持通过 TRX 付款啦💰</p>
</li>
</ul>
<p>这一年的写作到这里就结束了。</p>
<h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><p>换了一份工作，薪水比上份工作多一些。然而我觉得这份工作并没有上一份工作那么令我满意，主要集中在以下这几点吧：</p>
<ul>
<li><p>工作流程：上一份工作的公司刚刚被某芯片大厂收购，工作流程非常规范（因此也很慢），任何变更要通过 PR来，需要2个 review，Test Coverage大概有个70-80%左右</p>
</li>
<li><p>技术栈的变化：前司是Python + Clarity + PostgreSQL，我还接手了一个 Java的Play framework 的东西，感谢老板对我的信任，我都没想到能弄明白🤣 现在则是 Nodejs + Angular+ Elm 。JavaScript 懂得都懂黑点无数，大家也乐此不疲的黑JS，但是无论怎么说JS还是发展非常迅速的一门语言，生态也挺不错。Elm那我只能😄啦，只提一点：标准库上次更新是2021年2月。</p>
</li>
<li><p>氛围和企业文化：这个没什么可说的，都很棒，同事们都挺好的。也没有什么996的事，到点就走。但是不知为何我还是更喜欢前司😂</p>
</li>
</ul>
<p>别的倒也没什么，俗话说钱难挣嘛，这个道理都懂……</p>
<h2 id="旅游"><a href="#旅游" class="headerlink" title="旅游"></a>旅游</h2><p>从来不爱旅游的我，今年竟然破天荒的去了5个城市旅游。收获了什么忘记了，无论是「这个楼也太他妈牛逼了」还是「落霞与孤鹜齐飞」都不记得了。 我也没写xxx游记，只记得买了很多明信片😓</p>
<h2 id="开源项目"><a href="#开源项目" class="headerlink" title="开源项目"></a>开源项目</h2><ul>
<li><p>YYeTs：基本没什么太大的变化，dependabot的commit比我还多。前段时间转手给别人之后我更是不管了</p>
</li>
<li><p>WebP Server Go：虽然有持续的更新，并且有一些 issue，但是主要都是 Nova 大佬在处理，我基本打酱油了</p>
</li>
<li><p>ytdlbot：更新了一大堆东西，每天跑 200G 流量。收获0.</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/202312290332433.png"><img src="/images/202312290332433.png"></a></p>
<p>总体来看，基本上可以说还是那些，没什么新的变化，“僵尸”状态可能是一个比较恰当的形容词。</p>
<h2 id="游戏"><a href="#游戏" class="headerlink" title="游戏"></a>游戏</h2><p>电子阳痿。</p>
<p>等了很久的《往日之影》发布了，熬夜两天玩完，后劲太大直接让我郁闷的好几天。假如我是V，我会怎样做出选择？接受治疗活下去，然后失去一切。真的是一切都变了，物是人非，曾经的V震天甚至还会被街边的小混混揍，而这只是短短的两年。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023122903214866.png"><img src="/images/2023122903214866.png"></a></p>
<p>曾经的V可是这样的啊（这套服装是往日之影里那个法国黑客奥罗尔的复刻，还蛮好看的，我好喜欢。这把刀好像叫爪磨？）</p>
<p>与其这样生活，真的不如再活半年，或者把身体留给强尼。甚至，不如信了荒坂。</p>
<p>人呐难免会把艺术作品中的事情联想到自己身上，这个高塔结局说的不就是现在的我吗？</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023123001413713-scaled.jpeg"><img src="/images/2023123001413713-scaled.jpeg"></a></p>
<h3 id="Steam-Deck"><a href="#Steam-Deck" class="headerlink" title="Steam Deck"></a>Steam Deck</h3><p>买了个 Steam Deck，淘了个显示器键盘和1 TB SSD，然后装了个双系统。这玩意就是一个标准的x86机器，所以装双系统甚至三系统这种事情对于我来说自然不在话下。惊叹于 Windows 11，和Windows 10比起来还是变化了很多的。</p>
<p>装完系统我也没怎么用，看起来也电子阳痿了。</p>
<h2 id="影视作品"><a href="#影视作品" class="headerlink" title="影视作品"></a>影视作品</h2><p>看了挺多，大部分都是 Netflix上的</p>
<ul>
<li><p>VIVANT： 堺雅人主演的电视剧，前几集挺好看，后面略差。堺雅人的英文不太好，可能不如中文吧</p>
</li>
<li><p>石子和羽男 ：有村架纯真的是太可爱了，我好爱她😍</p>
</li>
<li><p>V世代：黑袍纠察队的衍生电视剧，很不错</p>
</li>
<li><p>上载新生第三季：略差了，但是比第二季好多了</p>
</li>
<li><p>最后生还者：改编于同名游戏，那个被魔山捏爆脑子的王子还真是挺忙</p>
</li>
<li><p>曼达洛人第三季：电视剧总体水平还不错，但是不知道为何我不太喜欢了，可能毕竟不是星战粉吧。主演还是上面那个王子</p>
</li>
<li><p>阿妮亚传奇啊不，间谍过家家：我很少看动漫，但是这部动漫竟然坚持下来了</p>
</li>
<li><p>赛博朋克 边缘行者：听说看完这部动漫的人都打开游戏锤爆亚当·重锤，我也不例外😂</p>
</li>
<li><p>噬亡村：柳乐优弥和吉冈里帆主演的电视剧。吉冈妹子真的好美，不知道第二季什么时候，这都快一年了</p>
</li>
<li><p>弥留之国的爱丽丝：第二季不太行……</p>
</li>
<li><p>甜蜜家园第二季：更不行</p>
</li>
<li><p>谁是被害者：台剧，还不错嗷</p>
</li>
<li><p>模仿犯：也是台剧，不错</p>
</li>
<li><p>罪后真相：台湾电影，还好，看预告片不错</p>
</li>
<li><p>黑暗荣耀：宋慧乔主演的，不错</p>
</li>
<li><p>黑镜第六季：琼糟透了、海之彼岸还不错，其他的一般般</p>
</li>
<li><p>关注者：不知道讲了什么，全程被池田 エライザ吸引🤩</p>
</li>
<li><p>初恋：这年头的纯爱剧，还真的能看进去（其中有一点点18🈲️镜头哈哈哈），主题曲和灵感均是宇多田光的 First Love，光妹真的浑身发光啊</p>
</li>
<li><p>重启人生：假如我能重启人生，那么我要做的事情会不会是，在高考结束之后的那天，把上交的志愿改掉？</p>
</li>
</ul>
<p>还有一堆乱七八糟的，不记得了想不起来了</p>
<h2 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h2><p>新增了很多 OST，都是赛博朋克的，最喜欢的还是 <a target="_blank" rel="noopener" href="https://music.163.com/song?id=2083630443">Gate K9</a>（往日之影）和 <a target="_blank" rel="noopener" href="https://music.163.com/song?id=1804292550">The Rebel Path</a>（单挑荒坂塔）</p>
<p>剩下的歌曲基本都是日本流行乐，基本全是 uru，我最喜欢的可能是 「ドライフラワー 」吧，这种小小伤感的歌曲最让我喜欢了：</p>
<ul>
<li><p>なんでもないよ</p>
</li>
<li><p>ドライフラワー</p>
</li>
<li><p>無機質</p>
</li>
<li><p>恋</p>
</li>
<li><p>再会</p>
</li>
<li><p>ポジティ部入部</p>
</li>
<li><p>ランドマーク</p>
</li>
<li><p>紙一重</p>
</li>
<li><p>君の幸せを</p>
</li>
<li><p>セレナーデ</p>
</li>
</ul>
<h2 id="猫"><a href="#猫" class="headerlink" title="猫"></a>猫</h2><p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/12/2023122903434288.jpg"><img src="/images/2023122903434288.jpg"></a></p>
<p>还是挺恩爱的。但是酸奶后背脱毛了😫，并且从昨天开始呕吐腹泻😫😫😫</p>
<h2 id="期待"><a href="#期待" class="headerlink" title="期待"></a>期待</h2><p>希望酸奶早日好起来，猫咪身体健康。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/12/31/2023-end/index/" data-id="clqxhsve30000w1qr2oac5v4z" data-title="2023 年终总结" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-tron-trx/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/12/09/tron-trx/index/" class="article-date">
  <time class="dt-published" datetime="2023-12-09T00:00:00.000Z" itemprop="datePublished">2023-12-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/what/">what</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/12/09/tron-trx/index/">使用 Tron(TRX) 收款</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>今年年初的时候，我写过<a target="_blank" rel="noopener" href="https://dmesg.app/stripe-telegram.html">如何用 Stripe 收款</a>。但是 Stripe 的注册门槛确实要高一些，这一点就足够劝退很多人了。</p>
<p>退而求其次，用加密货币来收款也是可以的。区块链上所有的交易都是公开的，因此我们可以通过这一点来验证用户的付款情况。</p>
<p>想要验证用户付款，包括但不限于如下方式：</p>
<ul>
<li>每笔交易都生成一对密钥，对应一个付款地址。密钥管理会非常麻烦</li>
<li>有些交易可以添加一个描述字段，用于区分。像极了给对公账户转账时的OCR&#x2F;Reference</li>
<li>尾数标记，略微改变付款金额，比如同样需要付款1 USDT，可以一个用户需要付款1.000001另外一个需要付款1.000002</li>
</ul>
<p>前几天了解到 HD 钱包（高清钱包 分层确定性钱包 Hierarchical Deterministic Wallet），发现这种技术非常有趣。它允许通过单个种子源生成一整套密钥对（即公钥和私钥），像树形结构一样。有一个根，就可以计算出树上任意一个节点的公私钥。</p>
<p>那这就刚刚好，每一笔交易我都给树上增加一个叶子节点，只要有根和路径，就可以计算出这个节点的公私钥。</p>
<p>这里我选择 Tron的TRX，主要原因还是转账手续费比较低😂</p>
<h2 id="钱包路径"><a href="#钱包路径" class="headerlink" title="钱包路径"></a>钱包路径</h2><p>从树根走到某一个叶子，肯定要一个特定的路径的。对于 tron来说，一个典型的路径是这样的</p>
<p><strong>m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0</strong></p>
<ul>
<li><strong>m&#x2F;44</strong>表示BIP44标准</li>
<li><strong>195</strong>表示 TRON，每种加密货币都分配有一个唯一的编号</li>
<li>**0’**表示钱包的第一个账户，创建多个账户那就是1‘ 2’</li>
<li><strong>0</strong> 链接层级 一般0表示接收 1表示找零</li>
<li><strong>0</strong> 特定地址索引，改变这个数字就会生成新的地址</li>
</ul>
<p>由于我们想每一笔交易都生成不同的地址，那么我们可以这样设想</p>
<ul>
<li><strong>m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0</strong> 这个路径用于保存所有的余额</li>
<li><strong>m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;(0-10000)</strong> 每一笔交易请求都通过1钱包的不同索引生成不同地址</li>
<li>每一笔交易确认后，都计算出这个地址的私钥，然后把钱转到0账户中</li>
</ul>
<h2 id="库"><a href="#库" class="headerlink" title="库"></a>库</h2><p>Python 中有很多库可以处理加密货币。比如 <a target="_blank" rel="noopener" href="https://github.com/meherett/python-hdwallet">python-hdwallet</a> 实现了一百多种货币的HD钱包；我们本次的目的非常简单，只使用 TRON，那么就用 <a target="_blank" rel="noopener" href="https://github.com/andelf/tronpy">tronpy</a> 好了</p>
<h2 id="生成助记词"><a href="#生成助记词" class="headerlink" title="生成助记词"></a>生成助记词</h2><p>[v_tips]mnemonic, m不发音[&#x2F;v_tips] 这个助记词也就是所谓的根密钥，可以拿来生成下面任意节点的密钥。可不能泄漏出去，要不然所有的节点的密钥都可以被推断出来。</p>
<p>from tronpy.hdwallet import generate_mnemonic<br>m &#x3D; generate_mnemonic(12, “english”)<br>print(m)</p>
<h2 id="连接区块链网络"><a href="#连接区块链网络" class="headerlink" title="连接区块链网络"></a>连接区块链网络</h2><p>TRON 有如下几个网络：</p>
<ul>
<li>mainnet 主网，里面的钱是具有经济价值的，意味着可以兑换法币</li>
<li>shasta、nile 测试网，里面的钱没经济价值，完全测试用</li>
</ul>
<p><strong>由于不同国家和地区对于加密货币的法律政策限制不同</strong>，同时我并不想真正的去花钱，那么测试网就是再好不过的了。</p>
<p>from tronpy import Tron</p>
<p>MNEMONIC &#x3D; “slogan reduce clap umbrella liquid crumble outer exchange quiz promote owner buffalo”<br>client &#x3D; Tron(network&#x3D;”nile”)<br>addr &#x3D; client.generate_address_from_mnemonic(MNEMONIC, “”, “m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0”)<br>print(addr[“base58check_address”])</p>
<p>输出如下</p>
<p>TERbSCnpFp4FG6SLpUHpFRBRT69ZhHbLFp</p>
<p>你看我们这里使用了 account path，这个<code>0&#39;/0/0</code>就是我们最终集资的钱包</p>
<h2 id="为每笔交易生成收款地址"><a href="#为每笔交易生成收款地址" class="headerlink" title="为每笔交易生成收款地址"></a>为每笔交易生成收款地址</h2><p>我们使用 1’账户，然后需要在数据库中记录下索引，每笔交易都要生成不同的索引，自增就可以了，要记住这个索引，否则就没办法生成私钥了</p>
<p>addr &#x3D; client.generate_address_from_mnemonic(MNEMONIC, “”, “m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;1”)<br>print(addr[“base58check_address”])</p>
<p>输出如下，这个地址就是用户要打钱的地方</p>
<p>TD2g6siz3NP4wcjP5iAueW9tottaAgP98a</p>
<h2 id="模拟用户"><a href="#模拟用户" class="headerlink" title="模拟用户"></a>模拟用户</h2><p>模拟用户付钱，那么就要先弄到一个有数字货币的钱包地址。可是这又是测试网，没办法真正兑换法币的。不慌，有网站可以免费领用于测试的币，如： <a target="_blank" rel="noopener" href="https://nileex.io/join/getJoinPage">https://nileex.io/join/getJoinPage</a></p>
<p>同样生成一个地址，记住地址和私钥，然后页面提交就好了。</p>
<p>为了方便实用，我们可以封装一个简单的命令行小程序</p>
<h2 id="付款"><a href="#付款" class="headerlink" title="付款"></a>付款</h2><p>client.trx.transfer(from_, to, amount).build().inspect().sign(priv).broadcast()<br>print(t.wait())</p>
<p><code>amount</code>是金额，<code>1_000_000</code> 是 1 TRX</p>
<p><code>priv</code> 是私钥，如果通过助记词和路径生成key，可以使用如下代码</p>
<p>def mnemonic_to_private_key():<br>    seed &#x3D; seed_from_mnemonic(mnemonic, passphrase&#x3D;””)<br>    private_key &#x3D; key_from_seed(seed, account_path&#x3D;”m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0”)<br>    return PrivateKey(private_key)</p>
<h2 id="验证付款"><a href="#验证付款" class="headerlink" title="验证付款"></a>验证付款</h2><p>简单的轮询即可</p>
<p># 获取地址信息<br>client.get_account(“TD2g6siz3NP4wcjP5iAueW9tottaAgP98a”)<br>获取地址余额，返回值类型是 Decimal 避免出现 0.1 + 0.2 &#x3D; 0.30000000000000004 的悲剧<br>client.get_account_balance(“TD2g6siz3NP4wcjP5iAueW9tottaAgP98a”)</p>
<h2 id="验证成功后转钱到集中地址"><a href="#验证成功后转钱到集中地址" class="headerlink" title="验证成功后转钱到集中地址"></a>验证成功后转钱到集中地址</h2><p>和付款一样，把 To 改成自己的地址就好。如果你想也可以弄成交易所给的地址、或者本地钱包软件给的地址。</p>
<p>在转账失败时，应该把金额减少 1.1 TRX用于付矿工费</p>
<h2 id="使用-Telegram-Bot处理"><a href="#使用-Telegram-Bot处理" class="headerlink" title="使用 Telegram Bot处理"></a>使用 Telegram Bot处理</h2><p>理解了以上所有步骤之后，简单封装一下就可以了，下面是一组示例代码，使用 apscheduler 轮询获取付款状态。简单起见没有引入数据库，正常要用起来的话，还是要把一些关键的信息，如付款地址、路径等写入到数据库中的。</p>
<p>import logging</p>
<p>import telebot<br>from apscheduler.schedulers.background import BackgroundScheduler<br>from telebot.types import Message<br>from tronpy import Tron<br>from tronpy.exceptions import TransactionError, ValidationError<br>from tronpy.hdwallet import key_from_seed, seed_from_mnemonic<br>from tronpy.keys import PrivateKey</p>
<p>logging.basicConfig(level&#x3D;logging.INFO)<br>bot &#x3D; telebot.TeleBot(“12345”)</p>
<p>index &#x3D; 0</p>
<h1 id="address-user-id-123-path-“m-x2F-44’-x2F-195’-x2F-1’-x2F-0-x2F-0”"><a href="#address-user-id-123-path-“m-x2F-44’-x2F-195’-x2F-1’-x2F-0-x2F-0”" class="headerlink" title="address: {user_id: 123, path: “m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;0”"></a>address: {user_id: 123, path: “m&#x2F;44’&#x2F;195’&#x2F;1’&#x2F;0&#x2F;0”</h1><p>unpaid_map &#x3D; {}</p>
<p>mnemonic &#x3D; “slogan reduce clap umbrella liquid crumble outer exchange quiz promote owner buffalo”</p>
<p>class TronTrx:<br>    def __init__(self):<br>        self.client &#x3D; Tron(network&#x3D;”nile”)<br>        self.central &#x3D; “m&#x2F;44’&#x2F;195’&#x2F;0’&#x2F;0&#x2F;0”</p>
<pre><code>def mnemonic\_to\_private\_key(self, path):
    seed = seed\_from\_mnemonic(mnemonic, passphrase=&quot;&quot;)
    private\_key = key\_from\_seed(seed, account\_path=path)
    return PrivateKey(private\_key)

def central\_wallet(self):
    return self.client.generate\_address\_from\_mnemonic(mnemonic, &quot;&quot;, self.central)\[&quot;base58check\_address&quot;\]

def generate\_address(self, user\_id):
    global index
    path = f&quot;m/44&#39;/195&#39;/1&#39;/0/&#123;index&#125;&quot;
    logging.info(&quot;Generating address for user %s with path %s&quot;, user\_id, path)
    addr = self.client.generate\_address\_from\_mnemonic(mnemonic, &quot;&quot;, path)\[&quot;base58check\_address&quot;\]
    unpaid\_map\[addr\] = &#123;&quot;user\_id&quot;: user\_id, &quot;path&quot;: path&#125;
    index += 1
    return addr

def transfer(self, from\_: str, to: str, amount: int):
    logging.info(&quot;Transfer %s TRX from %s to %s&quot;, amount, from\_, to)
    from\_path = unpaid\_map\[from\_\]\[&quot;path&quot;\]
    try:
        (
            self.client.trx.transfer(from\_, to, amount)
            .build()
            .sign(self.mnemonic\_to\_private\_key(from\_path))
            .broadcast()
        )
    except (TransactionError, ValidationError):
        logging.warning(&quot;Balance not enough, try to transfer %s TRX&quot;, amount - 1\_100\_000)
        (
            self.client.trx.transfer(from\_, to, amount - 1\_100\_000)
            .build()
            .sign(self.mnemonic\_to\_private\_key(from\_path))
            .broadcast()
        )

def verify\_payment(self):
    logging.info(&quot;Checking %s unpaid payment&quot;, len(unpaid\_map))
    for addr, meta in unpaid\_map.items():
        try:
            balance = self.client.get\_account\_balance(addr)
        except:
            balance = 0
        if balance:
            logging.info(&quot;addr %s has %s TRX&quot;, addr, balance)
            self.transfer(addr, self.central\_wallet(), int(balance \* 1\_000\_000))
            bot.send\_message(meta\[&quot;user\_id&quot;\], f&quot;You have paid &#123;balance&#125; TRX&quot;)
            del unpaid\_map.copy()\[addr\]
</code></pre>
<p>trx &#x3D; TronTrx()</p>
<p>@bot.message_handler(commands&#x3D;[“pay”])<br>def send_address(message: Message):<br>    bot.send_message(message.chat.id, trx.generate_address(message.chat.id))</p>
<p>@bot.message_handler(commands&#x3D;[“start”])<br>def send_start(message: Message):<br>    bot.send_message(message.chat.id, “hello”)</p>
<p>if __name__ &#x3D;&#x3D; “__main__“:<br>    scheduler &#x3D; BackgroundScheduler()<br>    scheduler.add_job(trx.verify_payment, “interval”, seconds&#x3D;10, max_instances&#x3D;1)<br>    scheduler.start()<br>    bot.infinity_polling()</p>
<p><img src="/images/2023120904562828.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/12/09/tron-trx/index/" data-id="clqxhsveu0005w1qr9o58cj7i" data-title="使用 Tron(TRX) 收款" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-nodejs-dual-stack/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/26/nodejs-dual-stack/index/" class="article-date">
  <time class="dt-published" datetime="2023-11-26T00:00:00.000Z" itemprop="datePublished">2023-11-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/11/26/nodejs-dual-stack/index/">Node.js 18升级：双栈协议踩坑</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>很久之前我就发现了一个现象，有些时候我在使用 nc去探测本地的某些服务是否开启时，会有两个输出，第一次拒绝第二次成功，输出如下所示：</p>
<p>$ nc -v localhost 12345</p>
<p>nc: connectx to localhost port 12345 (tcp) failed: Connection refused<br>Connection to localhost port 12345 [tcp&#x2F;italk] succeeded!</p>
<p>很奇怪，但是又不是不能用，就一直没去深究，甚至连一点点思考都没有。</p>
<p>前几天在把项目的 Node.js 从16升级到18时，突然发现能用 redbird 连不上后端的一个服务了。</p>
<p>于是我就继续 <code>nc</code> 了一下，使用 nc 是作为网络工程师的基本技能。结果输出和上面一样，第一次拒绝第二次成功。</p>
<p>想了几分钟突然懂了，我的服务只监听在了 IPv4的地址，并没有监听 IPv6的地址，而<code>localhost</code> 通常会同时解析为 IPv6的本地环回地址 <code>::1</code> 和 IPv4的<code>127.0.0.1</code> 。同时对于大部分应用程序而言，在双栈的情况下会优先尝试 IPv6，如果失败那么再回落到 IPv4.</p>
<p>$ ping localhost</p>
<p>PING localhost (127.0.0.1): 56 data bytes<br>64 bytes from 127.0.0.1: icmp_seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.115 ms<br>^C<br>— localhost ping statistics —<br>1 packets transmitted, 1 packets received, 0.0% packet loss<br>round-trip min&#x2F;avg&#x2F;max&#x2F;stddev &#x3D; 0.115&#x2F;0.115&#x2F;0.115&#x2F;nan ms</p>
<p>benny@Yogurt ~<br>$ ping6 localhost<br>PING6(56&#x3D;40+8+8 bytes) ::1 –&gt; ::1<br>16 bytes from ::1, icmp_seq&#x3D;0 hlim&#x3D;64 time&#x3D;0.053 ms</p>
<p>当时也没多想，猜测就是 redbird 由于什么原因只尝试了 IPv6 的地址。那就简单点改 hosts 让 <code>localhost</code> 只解析到 <code>127.0.0.1</code>就好了。 [v_tips]可是我没有 IPv6地址呀？ 没关系，即便你没有被分配IPv6地址，只要没有明确禁用IPv6，如 net.ipv6.conf.all.disable_ipv6 &#x3D; 1 那么 ::1 等就是有的！ [&#x2F;v_tips]</p>
<p>这样改 hosts 确实管用，但是知其然，更要知其所以然……</p>
<p>在开始之前，我们需要了解几个概念</p>
<h2 id="127-0-0-1-与-1"><a href="#127-0-0-1-与-1" class="headerlink" title="127.0.0.1 与 ::1"></a>127.0.0.1 与 ::1</h2><p>为表示本地计算机所保留的IP地址，对于 IPv4而言，其范围是 <code>127.0.0.0/8</code>，其地址范围为 <code>127.0.0.0</code> ～ <code>127.255.255.255</code>，除去开头的0表示网络位和结尾255表示广播地址，其余所有地址都可以表示本机。</p>
<p>~: ping 127.255.255.254</p>
<p>PING 127.255.255.254 (127.255.255.254) 56(84) bytes of data.<br>64 bytes from 127.255.255.254: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.028 ms<br>^C<br>— 127.255.255.254 ping statistics —<br>1 packets transmitted, 1 received, 0% packet loss, time 0ms<br>rtt min&#x2F;avg&#x2F;max&#x2F;mdev &#x3D; 0.028&#x2F;0.028&#x2F;0.028&#x2F;0.000 ms</p>
<p>~: ping 127.8.9.2<br>PING 127.8.9.2 (127.8.9.2) 56(84) bytes of data.<br>64 bytes from 127.8.9.2: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.045 ms<br>64 bytes from 127.8.9.2: icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;0.039 ms</p>
<p>至少在 Linux下是这样的！<code>127.0.0.1</code>是常用的标准环回地址，其他地址并不是所有操作系统都支持。</p>
<p>对于 IPv6 来说，事情就简单了，一个 <code>::1</code> 没有其他的花样。</p>
<p>如果我们的应用程序监听在 <code>127.0.0.1</code>，那么意味着只有本机，更准确的说来自于 <code>127.0.0.1</code> 的请求才会被接受；类似地，监听在 <code>::1</code> 也是一样，意味着只有来自 <code>::1</code> 的请求才会被接受。</p>
<p>我们可以使用 nc来做这样一个实验，k表示连接后不断开，l表示listen</p>
<p>nc -klv 127.0.0.1 12345</p>
<p>然后另开一个窗口 <code>nc -v 127.0.0.1 12345</code></p>
<p>$ nc -v 127.0.0.1 12345<br>Connection to 127.0.0.1 port 12345 [tcp&#x2F;italk] succeeded!<br>^C</p>
<p>benny@Yogurt: ~<br>$ nc -v ::1 12345<br>nc: connectx to ::1 port 12345 (tcp) failed: Connection refused</p>
<p>你看，虽然都是一台电脑，但是 <code>::1</code> 却不行，如果你有 docker，<code>docker0</code>网桥的地址是<code>172.17.0.1</code>，开个容器试试</p>
<p>~ # ping 172.17.0.1<br>PING 172.17.0.1 (172.17.0.1): 56 data bytes<br>64 bytes from 172.17.0.1: seq&#x3D;0 ttl&#x3D;64 time&#x3D;0.213 ms<br>^C<br>— 172.17.0.1 ping statistics —<br>1 packets transmitted, 1 packets received, 0% packet loss<br>round-trip min&#x2F;avg&#x2F;max &#x3D; 0.213&#x2F;0.213&#x2F;0.213 ms</p>
<p>~ # nc -vv 172.17.0.1 12345<br>nc: 172.17.0.1 (172.17.0.1:12345): Connection refused<br>sent 0, rcvd 0</p>
<p>也不行！因为请求不是从 127 来的而是172！如果想要从容器内可以访问，那么nc就要监听在网桥的地址，如 <code>nc -klv 172.17.0.1</code></p>
<p>[v_act]咱也不知道为啥要给loopback分配那么多地址，能把这些拿出来做其他的用途可能会更有趣。[&#x2F;v_act]</p>
<h2 id="0-0-0-0与"><a href="#0-0-0-0与" class="headerlink" title="0.0.0.0与 ::"></a>0.0.0.0与 ::</h2><p>[v_act]这里的 0.0.0.0 不是在指默认路由，指的是本机所有的 IPv4地址，:: 类似地指的是本机所有的IPv6 地址。[&#x2F;v_act]</p>
<p>当你的应用监听在 <code>0.0.0.0</code>时，所有的可达的IPv4地址都可以访问到。比如说，本机，docker 容器，你的路由器等等都可以。我们可以试试看<code>nc -klv 0.0.0.0 12345</code></p>
<h3 id="从MacBook连到-PVE-的虚拟机"><a href="#从MacBook连到-PVE-的虚拟机" class="headerlink" title="从MacBook连到 PVE 的虚拟机"></a>从MacBook连到 PVE 的虚拟机</h3><p>[18:17:02] benny:~ $ nc -v 192.168.7.55 12345<br>Connection to 192.168.7.55 port 12345 [tcp&#x2F;italk] succeeded!</p>
<h3 id="从PVE的虚拟机的容器连网桥"><a href="#从PVE的虚拟机的容器连网桥" class="headerlink" title="从PVE的虚拟机的容器连网桥"></a>从PVE的虚拟机的容器连网桥</h3><p>~ # cat &#x2F;etc&#x2F;issue<br>Welcome to Alpine Linux 3.18<br>Kernel \r on an \m (\l)</p>
<p>~ # nc -v 172.17.0.1 12345<br>172.17.0.1 (172.17.0.1:12345) open</p>
<p>噢！有一点需要注意，如果你是 macOS或者Windows的话，由于这两者并不原生支持 docker，所以他们的docker实际上是跑在虚拟机里的。此时你 <code>nc -v 172.17.0.1</code> 也是不行的，因为这里<code>172.17.0.1</code> 代表的是虚拟机的网桥，而不是你的电脑的网桥。此时你需要 <code>host.docker.internal</code>这个内部域名。 [v_blue]Windows 的话，具体情况我没测试，因为有 Hyper V和WSL两种情况。[&#x2F;v_blue]</p>
<h3 id="如果此时我们在本机通过-1-尝试连接"><a href="#如果此时我们在本机通过-1-尝试连接" class="headerlink" title="如果此时我们在本机通过 ::1 尝试连接"></a>如果此时我们在本机通过 <code>::1</code> 尝试连接</h3><p>~ ➤ nc -v ::1 12345<br>nc: connectx to ::1 port 12345 (tcp) failed: Connection refused</p>
<p>当然不行了，nc都明确指明只监听 IPv4的，那么通过v6自然连不上</p>
<p> </p>
<p>那么我们如果指定 nc 只监听 IPv6，那么是不是 <code>nc -v 127.0.0.1 12345</code> 就不行了呢？</p>
<p>nc -klv :: 12345</p>
<p>再开一个新窗口</p>
<p>~ ➤ nc -v 127.0.0.1 12345<br>Connection to 127.0.0.1 port 12345 [tcp&#x2F;italk] succeeded!<br>^C</p>
<p>~ ➤ nc -v ::1 12345<br>Connection to ::1 port 12345 [tcp&#x2F;italk] succeeded!</p>
<p>啊，竟然都可以，意味着无论是IPv4还是IPv6都可以连接！</p>
<p>[v_blue]nc -klv localhost 12345 呢？这取决于 localhost 的解析结果[&#x2F;v_blue]</p>
<p>这是为什么呢？</p>
<h2 id="net-ipv6-bindv6only"><a href="#net-ipv6-bindv6only" class="headerlink" title="net.ipv6.bindv6only"></a>net.ipv6.bindv6only</h2><p>这是 Linux 内核的一个参数，用于定义监听IPv6地址时的行为。默认情况下，这个值是0 禁用，也就意味着，如果你监听了<code>::</code> 那么也相当于监听了 <code>0.0.0.0</code></p>
<p>从 <code>netstat</code> 中我们可以看出</p>
<h3 id="如果是-的话"><a href="#如果是-的话" class="headerlink" title="如果是 :: 的话"></a>如果是 :: 的话</h3><p>tcp6 0 0 :::12345 :::* LISTEN 1925847&#x2F;nc</p>
<h3 id="如果是-0-0-0-0的话"><a href="#如果是-0-0-0-0的话" class="headerlink" title="如果是 0.0.0.0的话"></a>如果是 0.0.0.0的话</h3><p>tcp 0 0 0.0.0.0:12345 0.0.0.0:* LISTEN 1926110&#x2F;nc</p>
<h3 id="如果我们通过-sysctl-启用这个参数"><a href="#如果我们通过-sysctl-启用这个参数" class="headerlink" title="如果我们通过 sysctl 启用这个参数"></a>如果我们通过 <code>sysctl</code> 启用这个参数</h3><p>sysctl net.ipv6.bindv6only&#x3D;1</p>
<p>然后再次监听 <code>nc -klv :: 12345</code></p>
<p>再次通过 nc去连接 <code>127.0.0.1</code></p>
<p>nc -v 127.0.0.1 12345<br>nc: connect to 127.0.0.1 port 12345 (tcp) failed: Connection refused</p>
<p>就会发现连不上了，因为此时只监听 IPv6的地址，对于IPv4的对应端口并没有程序在监听。</p>
<p>在绝大多数 Linux 发行版中， <code>net.ipv6.bindv6only</code> 的默认值都是0，也就意味着监听在 <code>::</code> 也同样意味着监听在 <code>0.0.0.0</code> ；换句话说，在这种情况下，看到 <code>tcp6 :::port</code> 也就意味着通过 IPv4 也可以连接上。</p>
<p>macOS也同样有这样的行为，至于Windows嘛……可能也是，我没有Windows的机器来做测试。</p>
<h2 id="特殊情况"><a href="#特殊情况" class="headerlink" title="特殊情况"></a>特殊情况</h2><p>对于大多数应用程序，<code>localhost</code> 无非就是对应 <code>::1</code> 和或 <code>127.0.0.1</code> .但是MySQL是个例外，当你用 <code>localhost</code> 时，MySQL会通过 UNIX套接字（<code>/var/run/mysqld/mysqld.sock</code>） 去连接</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ul>
<li>监听 <code>127.0.0.1</code> 意味着只有从 127来的请求可以接受，<code>::1</code> 同理</li>
<li>在大多数情况下 <code>net.ipv6.bindv6only=0</code>为默认值。 监听 <code>::</code> 同时意味着监听<code>0.0.0.0</code></li>
<li>在未明确禁用 IPv6的情况下，即便你没有IPv6 地址，那么大多数情况下 <code>localhost</code> 也会被 hosts定义到 <code>::1</code> 和 <code>127.0.0.1</code>；并且你也能监听在 <code>::</code></li>
<li>MySQL的localhost是套接字</li>
<li>如果同时解析到了IPv6和IPv4，那么应该优先 IPv6；如果IPv6连接失败，那么理想情况是应该回落到 IPv4，所谓“<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-cn/Happy_Eyeballs">快乐眼球（Happy eyeballs）</a>”算法</li>
</ul>
<hr>
<h2 id="Node-js-？？？"><a href="#Node-js-？？？" class="headerlink" title="Node.js ？？？"></a>Node.js ？？？</h2><p>你以为事情到这里就结束了吗？并没有。</p>
<p>明明应该支持快乐眼球算法的，但是后端只监听了 <code>0.0.0.0</code> 为什么 redbird的配置中写 <code>localhost</code>还是失败了呢？并且在使用 Node.js 16的时候没问题，18就有问题了。</p>
<h3 id="重新使用-nc-监听到-0-0-0-0"><a href="#重新使用-nc-监听到-0-0-0-0" class="headerlink" title="重新使用 nc 监听到 0.0.0.0"></a>重新使用 nc 监听到 <code>0.0.0.0</code></h3><p>nc -klv 0.0.0.0 12345</p>
<p>并且已经确认只有 IPv4可达，在 <code>nc -v localhost 12345</code> 时会先失败再成功</p>
<h3 id="使用如下简单的-Node-js-代码来测试"><a href="#使用如下简单的-Node-js-代码来测试" class="headerlink" title="使用如下简单的 Node.js 代码来测试"></a>使用如下简单的 Node.js 代码来测试</h3><p>const net &#x3D; require(“net”);<br>const client &#x3D; new net.Socket();<br>client.connect(12345, “localhost”, function () {<br>    client.write(`node js ${process.version}\n`);<br>    console.log(“Connected”);<br>    process.exit(0);<br>});</p>
<p><img src="/images/2023112603044820.jpeg" alt="图形用户界面, 文本, 应用程序, 电子邮件 描述已自动生成"></p>
<p>这是什么情况？</p>
<p><img src="/images/2023112603044973.png" alt="貓貓蟲咖波-開心隨你(上) - Download Stickers from Sigstick"></p>
<p>$ for i in {12..21}; do nvm use $i &amp;&amp; node test.js; done<br>Now using node v12.22.12 (npm v6.14.16)<br>Connected<br>Now using node v13.14.0 (npm v6.14.4)<br>Connected<br>Now using node v14.21.3 (npm v6.14.18)<br>Connected<br>Now using node v15.14.0 (npm v7.7.6)<br>Connected<br>Now using node v16.20.2 (npm v8.19.4)<br>Connected<br>Now using node v17.9.1 (npm v8.11.0)<br>node:events:505<br>      throw er; &#x2F;&#x2F; Unhandled ‘error’ event<br>      ^</p>
<p>Error: connect ECONNREFUSED ::1:12345<br>    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1195:16)<br>Emitted ‘error’ event on Socket instance at:<br>    at emitErrorNT (node:internal&#x2F;streams&#x2F;destroy:164:8)<br>    at emitErrorCloseNT (node:internal&#x2F;streams&#x2F;destroy:129:3)<br>    at processTicksAndRejections (node:internal&#x2F;process&#x2F;task_queues:83:21) {<br>  errno: -61,<br>  code: ‘ECONNREFUSED’,<br>  syscall: ‘connect’,<br>  address: ‘::1’,<br>  port: 12345<br>}</p>
<p>Node.js v17.9.1<br>Now using node v18.18.2 (npm v9.8.1)<br>node:events:495<br>      throw er; &#x2F;&#x2F; Unhandled ‘error’ event<br>      ^</p>
<p>Error: connect ECONNREFUSED ::1:12345<br>    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1555:16)<br>Emitted ‘error’ event on Socket instance at:<br>    at emitErrorNT (node:internal&#x2F;streams&#x2F;destroy:151:8)<br>    at emitErrorCloseNT (node:internal&#x2F;streams&#x2F;destroy:116:3)<br>    at process.processTicksAndRejections (node:internal&#x2F;process&#x2F;task_queues:82:21) {<br>  errno: -61,<br>  code: ‘ECONNREFUSED’,<br>  syscall: ‘connect’,<br>  address: ‘::1’,<br>  port: 12345<br>}</p>
<p>Node.js v18.18.2<br>Now using node v19.9.0 (npm v9.6.3)<br>node:events:491<br>      throw er; &#x2F;&#x2F; Unhandled ‘error’ event<br>      ^</p>
<p>Error: connect ECONNREFUSED ::1:12345<br>    at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1532:16)<br>Emitted ‘error’ event on Socket instance at:<br>    at emitErrorNT (node:internal&#x2F;streams&#x2F;destroy:151:8)<br>    at emitErrorCloseNT (node:internal&#x2F;streams&#x2F;destroy:116:3)<br>    at process.processTicksAndRejections (node:internal&#x2F;process&#x2F;task_queues:82:21) {<br>  errno: -61,<br>  code: ‘ECONNREFUSED’,<br>  syscall: ‘connect’,<br>  address: ‘::1’,<br>  port: 12345<br>}</p>
<p>Node.js v19.9.0<br>Now using node v20.10.0 (npm v10.2.3)<br>Connected<br>Now using node v21.2.0 (npm v10.2.3)<br>Connected</p>
<p>咳，不过是Node.js自从17就弄坏了快乐眼球算法，18、19也是坏着的，直到20才修好。16之前的版本全是好的。</p>
<p>18是LTS啊，哎，这难免有点太<a target="_blank" rel="noopener" href="https://twitter.com/BennyThinks/status/1728062988765335859">草台班子</a>了吧。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://github.com/nodejs/node/issues/41625">https://github.com/nodejs/node/issues/41625</a> <a target="_blank" rel="noopener" href="https://github.com/nodejs/node/issues/40702">https://github.com/nodejs/node/issues/40702</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/26/nodejs-dual-stack/index/" data-id="clqxhsveg0002w1qr4j6o89d1" data-title="Node.js 18升级：双栈协议踩坑" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-steam-deck-stuck/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/25/steam-deck-stuck/index/" class="article-date">
  <time class="dt-published" datetime="2023-11-25T00:00:00.000Z" itemprop="datePublished">2023-11-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/11/25/steam-deck-stuck/index/">Steam Deck 启动游戏卡 logo</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>最近买了个 Steam Deck，在玩游戏的时候发现一个很奇怪的bug。当休眠之后再次打开游戏，就会不停转 steam logo，如下图所示</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/11/2023111419033136.jpeg"><img src="/images/2023111419033136.jpeg"></a></p>
<p>但是如果按菜单键，会发现游戏已经加载成功了</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2023/11/2023111419033188.jpeg"><img src="/images/2023111419033188.jpeg"></a></p>
<p>重启之后可以解决，但是不能每次都重启啊。</p>
<p>后来发现，在 <strong>设置-自定义-用作唤醒影片</strong> 这个关掉就可以了 😂</p>
<p>这种 Bug 也是绝了😓</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a target="_blank" rel="noopener" href="https://steamcommunity.com/app/1675200/discussions/1/6348431004268742880/">https://steamcommunity.com/app/1675200/discussions/1/6348431004268742880/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/25/steam-deck-stuck/index/" data-id="clqxhsvet0003w1qr6tqg2y2l" data-title="Steam Deck 启动游戏卡 logo" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/">azure</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/03/16/py-azure-oai-proxy/index/">使用50行Python代码实现一个Azure OpenAI Proxy</a>
          </li>
        
          <li>
            <a href="/2024/12/12/candlestick-llm/index/">使用Python 通过K线计算技术指标，并用 LLM 预测趋势</a>
          </li>
        
          <li>
            <a href="/2024/11/03/warp-http-proxy/index/">把 Cloudflare WARP 转换为 http 代理</a>
          </li>
        
          <li>
            <a href="/2024/10/12/aca-php/index/">用 Azure Container Apps 运行PHP网站</a>
          </li>
        
          <li>
            <a href="/2024/10/06/aca-vm-scale/index/">Azure Container Apps 连接到虚拟机并配置CPU自动缩放</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Benny小土豆<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>