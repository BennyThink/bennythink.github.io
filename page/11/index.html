<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>土豆不好吃</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="土豆不好吃">
<meta property="og:url" content="http://example.com/page/11/index.html">
<meta property="og:site_name" content="土豆不好吃">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Benny小土豆">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="土豆不好吃" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">土豆不好吃</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-keep-abp-on/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/12/31/keep-abp-on/index/" class="article-date">
  <time class="dt-published" datetime="2018-12-31T00:00:00.000Z" itemprop="datePublished">2018-12-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/share/">share</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/12/31/keep-abp-on/index/">Keep APB on：别碰我的广告屏蔽器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>前几天，在偶然浏览某知名博主的博客时，偶然发现开着ABP竟然无法加载博文正文了，取而代之的是一个大大的div告诉我需要关闭广告屏蔽器然后刷新页面。哦这怎么行？弹个小窗，某个div提示我们加到白名单里这是可以考虑的，直接不显示文章？作为一名优秀的全沾工程师，肯定是受不了这种事情的。</p>
<p>于是<a target="_blank" rel="noopener" href="https://github.com/BennyThink/KeepABPOn">KeepAPBon</a>这个项目因此而生。一句话概括：</p>
<p>网站永远不应该强迫用户去关闭广告屏蔽器，除非用户想主动关闭。</p>
<p>[gt href&#x3D;’<a target="_blank" rel="noopener" href="https://github.com/BennyThink/KeepABPOn'/]%E5%BC%80%E6%BA%90%E5%9C%B0%E5%9D%80/[/gt/]">https://github.com/BennyThink/KeepABPOn&#39;\]开源地址\[/gt\]</a></p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>安装TamperMonkey扩展，然后搜索KAO，安装你所需要反制的网站的脚本即可。</p>
<p>目前此项目还处于测试阶段，日后可能会把所有反制措施都集中到一个脚本中。</p>
<h2 id="处理标准"><a href="#处理标准" class="headerlink" title="处理标准"></a>处理标准</h2><p>所有会影响页面显示、影响阅读体验的“反广告屏蔽器”类网站都会被处理，视频分享类网站排除在外。其他情况的广告不会被处理。</p>
<p>欢迎提交PR、issue，包括但不限于网站提供、反制措施。</p>
<h2 id="目前被反制的网站"><a href="#目前被反制的网站" class="headerlink" title="目前被反制的网站"></a>目前被反制的网站</h2><h3 id="KAO-1-ruanyifeng"><a href="#KAO-1-ruanyifeng" class="headerlink" title="KAO#1:ruanyifeng"></a><a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/376131-kao-1-ruanyifeng">KAO#1:ruanyifeng</a></h3><p>浏览阮一峰博客时，不必关闭广告屏蔽器。</p>
<h2 id="一些观点"><a href="#一些观点" class="headerlink" title="一些观点"></a>一些观点</h2><h3 id="我不讨厌的广告"><a href="#我不讨厌的广告" class="headerlink" title="我不讨厌的广告"></a>我不讨厌的广告</h3><p>在合理展示的情况下，它们为网站所有者创造了收入，为潜在的受众提升了品牌的知名度。可接受的广告，既不会令人烦恼，也不会干扰正在查看的内容</p>
<p>可不，你看我很喜欢吃的明治就是广告看来的？有广告很正常，我也一直开着ABP里的可接受广告。甚至看到有些博客提示请加入白名单，我还会手动加进去。</p>
<h3 id="我讨厌的广告"><a href="#我讨厌的广告" class="headerlink" title="我讨厌的广告"></a>我讨厌的广告</h3><p>从我的个人角度来看，有两种广告是我讨厌的：</p>
<ol>
<li>铺天盖地、眼花缭乱，一页屏幕半页都是广告，影响浏览体验。</li>
<li>不关ABP，就不给看。看都不给看，还体验个屁啊</li>
</ol>
<h3 id="为什么？"><a href="#为什么？" class="headerlink" title="为什么？"></a>为什么？</h3><p>多少年以来，我一直坚定地认为，互联网的精神是自由与传播。</p>
<p>我非常憎恨阻止知识传播的行为，这也是我如此憎恨GFW的众多原因之一。</p>
<p>也许你并不同意我的看法。那很正常。我们有不同的成长环境，接受了不同的教育，形成了不同的观念与想法。我们各自都有不同的想法，那是很正常的事情了。你一句我一句的讨论，找出论据支撑自己的观点，用事实来说明观点，可能经过这样一次讨论，我们对彼此的理解会更加深一点，或者是学习了解到了一些自己的思维体系中原本并不存在的一些观点。所谓思维的碰撞嘛，本应该就是这样美好的设想的。</p>
<p> </p>
<h2 id="其他参考"><a href="#其他参考" class="headerlink" title="其他参考"></a>其他参考</h2><p><a target="_blank" rel="noopener" href="https://reek.github.io/anti-adblock-killer/#">Anti-Adblock Killer</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/12/31/keep-abp-on/index/" data-id="clhp7rtgz004as2qr8ai9375g" data-title="Keep APB on：别碰我的广告屏蔽器" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-tls1_3/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/12/07/tls1_3/index/" class="article-date">
  <time class="dt-published" datetime="2018-12-07T00:00:00.000Z" itemprop="datePublished">2018-12-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/website/">website</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/12/07/tls1_3/index/">为Nginx开启tls 1.3支持，顺便编译openssl1.1.1a</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>8月份的时候，TLS1.3正式发布了（<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8446">RFC 8446</a>），9月份的时候，支持TLS 1.3的Openssl 1.1.1正式发布了。对于我这种喜欢追新的人来说，终于可以升级了……（噢现在是12月哦……）其实……这就是个备忘录。</p>
<h2 id="启用TLS-1-3的要求"><a href="#启用TLS-1-3的要求" class="headerlink" title="启用TLS 1.3的要求"></a>启用TLS 1.3的要求</h2><p>需要重新编译Nginx，加入<code>enable-tls1_3</code>参数，需要浏览器也支持TLS 1.3，如果你使用最新版本的Chrome&amp;Firefox，那么就可以。哦对了，<strong>不需要重新编译openssl哦</strong>。</p>
<p>下表是目前的几个发行版对openssl版本的支持，虽说和本文内容干毫无关系，仅供观赏。</p>
<table><tbody><tr><td><span style="font-size: 12pt;">Ubuntu 18.04</span></td><td><span style="font-size: 12pt;">Openssl 1.1.0g</span></td></tr><tr><td><span style="font-size: 12pt;">Ubuntu 18.10</span></td><td><span style="font-size: 12pt;">Openssl 1.1.1</span></td></tr><tr><td><span style="font-size: 12pt;">Debian sid</span></td><td><span style="font-size: 12pt;">Openssl 1.1.1a</span></td></tr><tr><td><span style="font-size: 12pt;">Debian 9 Stretch</span></td><td><span style="font-size: 12pt;">Openssl 1.1.0j</span></td></tr><tr><td><span style="font-size: 12pt;">CentOS 7</span></td><td><span style="font-size: 12pt;">Openssl 1.0.2k</span></td></tr></tbody></table>

<h2 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h2><p>sudo apt-get install build-essential libpcre3 libpcre3-dev zlib1g-dev unzip git</p>
<h2 id="获取必要组件"><a href="#获取必要组件" class="headerlink" title="获取必要组件"></a>获取必要组件</h2><h3 id="openssl-1-1-1a"><a href="#openssl-1-1-1a" class="headerlink" title="openssl 1.1.1a"></a>openssl 1.1.1a</h3><p>wget <a target="_blank" rel="noopener" href="https://www.openssl.org/source/openssl-1.1.1a.tar.gz">https://www.openssl.org/source/openssl-1.1.1a.tar.gz</a><br>tar xf openssl-1.1.1a.tar.gz &amp;&amp; rm openssl-1.1.1a.tar.gz</p>
<h3 id="Nginx-1-15-7"><a href="#Nginx-1-15-7" class="headerlink" title="Nginx 1.15.7"></a>Nginx 1.15.7</h3><p>wget <a target="_blank" rel="noopener" href="https://nginx.org/download/nginx-1.15.7.tar.gz">https://nginx.org/download/nginx-1.15.7.tar.gz</a><br>tar xf nginx-1.15.7.tar.gz &amp;&amp; rm nginx-1.15.7.tar.gz<br>cd nginx-1.15.7</p>
<h2 id="编译Nginx"><a href="#编译Nginx" class="headerlink" title="编译Nginx"></a>编译Nginx</h2><p>.&#x2F;configure –user&#x3D;www –group&#x3D;www –prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx –with-openssl&#x3D;..&#x2F;openssl-1.1.1a –with-openssl-opt&#x3D;’enable-tls1_3’ –with-http_v2_module –with-http_ssl_module –with-http_gzip_static_module –with-http_stub_status_module –with-http_sub_module –with-stream –with-stream_ssl_module</p>
<p>配置完成之后</p>
<p>make<br>make install</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>在你的站点的配置文件中，如下配置即可：</p>
<p>ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</p>
<p>ssl_ciphers ‘TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA’;</p>
<h2 id="检测与验证"><a href="#检测与验证" class="headerlink" title="检测与验证"></a>检测与验证</h2><h3 id="浏览器"><a href="#浏览器" class="headerlink" title="浏览器"></a>浏览器</h3><p>升级Chrome吧，默认就应该支持了。直接浏览器访问，开F12在security中即可看到。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2018/12/2018120701580146.jpg"><img src="/images/2018120701580146.jpg"></a></p>
<h3 id="ssllabs"><a href="#ssllabs" class="headerlink" title="ssllabs"></a>ssllabs</h3><p><a target="_blank" rel="noopener" href="https://www.ssllabs.com/ssltest/">https://www.ssllabs.com/ssltest/</a></p>
<h3 id="testssl"><a href="#testssl" class="headerlink" title="testssl"></a>testssl</h3><p>需要1.1.1或更高版本的openssl</p>
<p>.&#x2F;testssl –p –P <a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a></p>
<h3 id="Openssl"><a href="#Openssl" class="headerlink" title="Openssl"></a>Openssl</h3><p>注意，同样需要openssl版本为1.1.1或更高</p>
<p>openssl s_client -connect <a target="_blank" rel="noopener" href="http://www.example.com:443/">www.example.com:443</a> -tls1_3</p>
<h2 id="编译openssl-1-1-1"><a href="#编译openssl-1-1-1" class="headerlink" title="编译openssl 1.1.1"></a>编译openssl 1.1.1</h2><h3 id="安装依赖-1"><a href="#安装依赖-1" class="headerlink" title="安装依赖"></a>安装依赖</h3><p>sudo apt update<br>sudo apt install build-essential checkinstall zlib1g-dev -y</p>
<h3 id="下载并解压缩源代码"><a href="#下载并解压缩源代码" class="headerlink" title="下载并解压缩源代码"></a>下载并解压缩源代码</h3><p>wget <a target="_blank" rel="noopener" href="https://www.openssl.org/source/openssl-1.1.1a.tar.gz">https://www.openssl.org/source/openssl-1.1.1a.tar.gz</a><br>tar xf openssl-1.1.1a.tar.gz &amp;&amp; rm openssl-1.1.1a.tar.gz<br>cd openssl-1.1.1a</p>
<h3 id="配置、编译与安装"><a href="#配置、编译与安装" class="headerlink" title="配置、编译与安装"></a>配置、编译与安装</h3><p>.&#x2F;config –prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;ssl –openssldir&#x3D;&#x2F;usr&#x2F;local&#x2F;ssl shared zlib<br>make &amp;&amp; make test<br>make install</p>
<p>关于prefix和openssldir这俩参数</p>
<p><code>prefix</code>和<code>openssldir</code>用于控制openssl安装路径。</p>
<p><strong>1.0.2及之前的版本</strong></p>
<p>一般来说不用指定<code>prefix</code>，如果<code>prefix</code>没指定，那么就会使用<code>openssldir</code></p>
<p>如果未指定<code>openssldir</code>，那么<code>openssldir</code>的默认路径为<code>/usr/local/ssl</code></p>
<p><strong>1.1.0 及之后版本</strong></p>
<p>我们改啦！应该同时指定<code>prefix</code> 和 <code>openssldir</code></p>
<p>简单的办法就是同时指定为<code>/usr/local/ssl</code></p>
<h3 id="更新动态库"><a href="#更新动态库" class="headerlink" title="更新动态库"></a>更新动态库</h3><p>cd &#x2F;etc&#x2F;ld.so.conf.d&#x2F;</p>
<h1 id="创建新文件"><a href="#创建新文件" class="headerlink" title="创建新文件"></a>创建新文件</h1><p>vim openssl-1.1.1a.conf</p>
<h1 id="粘贴如下内容并保存退出"><a href="#粘贴如下内容并保存退出" class="headerlink" title="粘贴如下内容并保存退出"></a>粘贴如下内容并保存退出</h1><p>&#x2F;usr&#x2F;local&#x2F;ssl&#x2F;lib</p>
<h1 id="重新加载动态库"><a href="#重新加载动态库" class="headerlink" title="重新加载动态库"></a>重新加载动态库</h1><p>ldconfig –v</p>
<h3 id="删除（备份）旧的openssl"><a href="#删除（备份）旧的openssl" class="headerlink" title="删除（备份）旧的openssl"></a>删除（备份）旧的openssl</h3><p>mv &#x2F;usr&#x2F;bin&#x2F;c_rehash &#x2F;usr&#x2F;bin&#x2F;c_rehash.BEKUP<br>mv &#x2F;usr&#x2F;bin&#x2F;openssl &#x2F;usr&#x2F;bin&#x2F;openssl.BEKUP</p>
<h3 id="把新的加入PATH"><a href="#把新的加入PATH" class="headerlink" title="把新的加入PATH"></a>把新的加入PATH</h3><p>类似如下语句，或者做软链接</p>
<p>PATH&#x3D;”&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;local&#x2F;games:&#x2F;usr&#x2F;local&#x2F;ssl&#x2F;bin”</p>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://www.howtoforge.com/tutorial/how-to-install-openssl-from-source-on-linux/">https://www.howtoforge.com/tutorial/how-to-install-openssl-from-source-on-linux/</a></p>
<p><a target="_blank" rel="noopener" href="https://wiki.openssl.org/index.php/Compilation_and_Installation#PREFIX_and_OPENSSLDIR">https://wiki.openssl.org/index.php/Compilation_and_Installation#PREFIX_and_OPENSSLDIR</a></p>
<p><a target="_blank" rel="noopener" href="https://imququ.com/post/enable-tls-1-3.html">https://imququ.com/post/enable-tls-1-3.html</a></p>
<p><a target="_blank" rel="noopener" href="https://halfrost.com/tls1-3_start/">https://halfrost.com/tls1-3_start&#x2F;</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/12/07/tls1_3/index/" data-id="clhp7rtmc00a2s2qr9bju6zj3" data-title="为Nginx开启tls 1.3支持，顺便编译openssl1.1.1a" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-one-million-data/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/28/one-million-data/index/" class="article-date">
  <time class="dt-published" datetime="2018-11-28T00:00:00.000Z" itemprop="datePublished">2018-11-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/28/one-million-data/index/">假如给我一百万（的数据）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>很长时间之前我写过一篇<a target="_blank" rel="noopener" href="https://dmesg.app/mysql-es-mongo.html">《使用</a> <a target="_blank" rel="noopener" href="https://dmesg.app/mysql-es-mongo.html">Python 将海量 MySQL 数据导入 Elastic Search&#x2F;MongoDB</a><a target="_blank" rel="noopener" href="https://dmesg.app/mysql-es-mongo.html">》</a>，主要就说了如何把大量MySQL数据写入键值对数据库。</p>
<p>现在回过头看来这篇文章还是很有参考价值的。</p>
<p>有的时候我们会遇到相反的需求，比如说把对应的键值对数据库（或者说是json文件）导入（列数据类型相符）的MySQL表中。通常来说这不是个啥大问题，根据json提取出列，生成SQL语句就可以了。也就这么几行，然后execute加参数就可以了：</p>
<p>placeholders &#x3D; ‘, ‘.join([‘%s’] * len(raw_dict))<br>columns &#x3D; ‘, ‘.join(raw_dict.keys())<br>insert_sql &#x3D; “INSERT INTO %s ( %s ) VALUES ( %s )” % (insert_table, columns, placeholders)</p>
<p>当然了你要是想直接生成能用的sql语句那我也没意见（并抛出一个?的表情）</p>
<p>大量插入数据的时候咋整呢？</p>
<h1 id="首先我们……"><a href="#首先我们……" class="headerlink" title="首先我们……"></a>首先我们……</h1><p>首先我们要知道，性能是由多方面因素决定的，比如说代码效率质量、Python性能、服务器性能（包含MySQL版本，编译优化，宿主机IO&#x2F;CPU&#x2F;RAM等）、表结构的设计、网络速度等，咱要找到短板才可以。为了找到短板，需要使用控制变量法，但是有些变量不可控，那就很不好办了……</p>
<p>然后我需要送上MySQL官方文档两篇，说的非常详细了，我简单总结下</p>
<p>Optimizing INSERT Statements: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/insert-optimization.html">https://dev.mysql.com/doc/refman/8.0/en/insert-optimization.html</a></p>
<p>Bulk Data Loading for InnoDB Tables: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/optimizing-innodb-bulk-data-loading.html">https://dev.mysql.com/doc/refman/8.0/en/optimizing-innodb-bulk-data-loading.html</a></p>
<h2 id="优化INSERT语句"><a href="#优化INSERT语句" class="headerlink" title="优化INSERT语句"></a>优化INSERT语句</h2><p>插入时间由以下因素决定，数字代表权重</p>
<ul>
<li>Connecting: (3)</li>
<li>Sending query to server: (2)</li>
<li>Parsing query: (2)</li>
<li>Inserting row: (1 × size of row)</li>
<li>Inserting indexes: (1 × number of indexes)</li>
<li>Closing: (1)</li>
</ul>
<p>可以使用以下方式加速插入：</p>
<ul>
<li>如果从同一个客户端同时插入，使用多值的INSERT语句一次性插入多行，这比使用单行的INSERT语句要快得多。如果要将数据添加到非空表中，则可以调整该 <code>bulk_insert_buffer_size</code> 变量以使数据插入速度更快。</li>
<li>从文本文件加载表格时，请使用 <code>LOAD DATA INFILE</code>。这通常比使用INSERT语句快20倍</li>
<li>利用列具有默认值的事实。只有当要插入的值不同于默认值时才显式插入值。这减少了MySQL必须执行的解析并提高了插入速度。</li>
</ul>
<h2 id="InnoDB表的批量数据加载"><a href="#InnoDB表的批量数据加载" class="headerlink" title="InnoDB表的批量数据加载"></a>InnoDB表的批量数据加载</h2><h3 id="关闭自动提交"><a href="#关闭自动提交" class="headerlink" title="关闭自动提交"></a>关闭自动提交</h3><p>关闭自动提交，因为它为每个操作执行日志刷新。</p>
<p>实际上默认情况下pymysql帮我们做了，<code>set autocommit=0</code></p>
<h3 id="关闭唯一性校验"><a href="#关闭唯一性校验" class="headerlink" title="关闭唯一性校验"></a>关闭唯一性校验</h3><p>set unique checks &#x3D; 0</p>
<p>对于大表而言这会节约很多磁盘IO，不过要确保数据没有重复记录。</p>
<h3 id="关闭外键校验"><a href="#关闭外键校验" class="headerlink" title="关闭外键校验"></a>关闭外键校验</h3><p>SET foreign_key_checks&#x3D;0;</p>
<h3 id="多值INSERT"><a href="#多值INSERT" class="headerlink" title="多值INSERT"></a>多值INSERT</h3><p>使用多值INSERT 来减少客户端与服务器之间的通信开销</p>
<p>INSERT INTO yourtable VALUES (1,2), (5,5), …;</p>
<p>需要注意的是，MyISAM用这招也管用。</p>
<p><strong>这一点是我们本文讨论的重点内容。</strong></p>
<h3 id="自增列的处理"><a href="#自增列的处理" class="headerlink" title="自增列的处理"></a>自增列的处理</h3><p>当对具有自动增量列的表进行批量插入时，请将其设置 <code>innodb_autoinc_lock_mode</code>为2而不是默认值1</p>
<h3 id="主键排序"><a href="#主键排序" class="headerlink" title="主键排序"></a>主键排序</h3><p>InnoDB表是按照主键顺序排列的，所以将数据顺序按照主键顺序排列好，可以提高导入效率</p>
<h1 id="Python性能"><a href="#Python性能" class="headerlink" title="Python性能"></a>Python性能</h1><p>这可能是PHP被黑的最惨的一次。</p>
<p>如果单纯的比较执行性能的话，Python是肯定比不过静态语言的。不过我早就过了单纯的年龄，我很邪恶的。由于这是Python自身的短板，咱也不太好做点什么有实质性的工作，也许仅限于把解释器换成PyPy，编译Python时带上<code>enable-optimizations</code>，把性能关键的模块用C&#x2F;C++写一遍然后胶水糊上。</p>
<p>但可是啊可但是啊，代码执行时绝大部分的时间都消耗在了网络IO、磁盘IO，在语言本身上的劣势并不是那么明显。当然了非得说语言本身，那动态语言运行时要解释，要运行时检查……</p>
<h1 id="代码效率质量"><a href="#代码效率质量" class="headerlink" title="代码效率质量"></a>代码效率质量</h1><p>实际上老实说，这部分才是最关键的。一个足够Pythonic的代码看起来是很舒服的嗯……</p>
<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><h3 id="查询时SQL注入的预防"><a href="#查询时SQL注入的预防" class="headerlink" title="查询时SQL注入的预防"></a>查询时SQL注入的预防</h3><p>在有些情况下（比如说登录的时候）我们需要进行where限制条件查询，此时如果使用拼接SQL语句的方式，那么被注入几乎就是肯定的了。</p>
<p>比如某些新手在登录的查询语句可能会构造如下语句：</p>
<p>SELECT * FROM account WHERE username&#x3D;’benny’ AND password&#x3D;’123456’</p>
<p>其中benny和123456是由用户输入的变量，通过判断结果集是否为空来判断是否登录成功。乍一看似乎没啥问题，但是……问题太多了。</p>
<ol>
<li>无验证登录</li>
</ol>
<p>恶意用户只需要把用户名输入为<code>&#39; or 1=1; --</code> ，SQL语句就会变成这样：</p>
<p>SELECT * FROM account WHERE username&#x3D;’’ or 1&#x3D;1; – ‘ AND password&#x3D;’123456’</p>
<p>这是一条带不带WHERE都一样的语句，只要表中有数据那么结果集就一定为真，自然也就绕过登录了。</p>
<ol>
<li>各种注入</li>
</ol>
<p>通过构造各种各样的奇葩的SQL语句，可以摸索出来表的结构，甚至是某些关键库（比如mysql这个库）的数据，比如说<a target="_blank" rel="noopener" href="https://chybeta.github.io/2017/07/21/MySql%E6%B3%A8%E5%85%A5%E5%A4%87%E5%BF%98%E5%BD%95/">这篇</a>。</p>
<ol>
<li>密码存储问题</li>
</ol>
<p>即使注入不是问题，从系统设计的角度来讲这种设计也是错误的。</p>
<p>明文密码，无论从传输角度还是从数据库角度来讲都是不合理的。即使是使用安全的散列函数、HMAC也是错误的。</p>
<p>正确的姿势是用参数化查询查询出密码，使用PBKDF的方法进行等时间比较。</p>
<p>（如何存储用户密码是一门艺术，以后也许单独开一篇完整介绍吧）</p>
<h3 id="dictCursor"><a href="#dictCursor" class="headerlink" title="dictCursor"></a>dictCursor</h3><p>有些时候我们可能需要查询出来的结果是一定类型的，默认情况下pymysq使用的cursor会查询出来<code>[(),()]</code>这种格式的数据，如果我们需要字典样式的数据，那么就要在构造con连接对象的时候指定游标，语法大致如下：</p>
<p>con &#x3D; pymysql.connect(host&#x3D;’localhost’, user&#x3D;’user’, password&#x3D;’passwd’,<br>db&#x3D;’db’, charset&#x3D;’utf8mb4’, cursorclass&#x3D;pymysql.cursors.DictCursor)</p>
<p>这样就不用再从information_schema里乱查一通了。</p>
<h3 id="fetch方式"><a href="#fetch方式" class="headerlink" title="fetch方式"></a>fetch方式</h3><p>cur在获取数据时，有<code>fetchall()</code>、<code>fetchone()</code>、<code>fetchmany()</code>三种方法。细节已经<a target="_blank" rel="noopener" href="https://dmesg.app/mysql-es-mongo.html">在这里说了</a>，所以就暂且不提。</p>
<h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><h3 id="插入时SQL注入的预防"><a href="#插入时SQL注入的预防" class="headerlink" title="插入时SQL注入的预防"></a>插入时SQL注入的预防</h3><p>插入数据时也同样需要防范SQL注入，所以应该使用参数化查询。下面会详细说明</p>
<h3 id="cur-execute-与参数"><a href="#cur-execute-与参数" class="headerlink" title="cur.execute()与参数"></a>cur.execute()与参数</h3><p>首先看一眼原型：<code>def execute(self, query, args=None)</code></p>
<p>第一个参数query代表要执行的SQL语句，第二个args代表可选的查询参数，类型可为tuple, list or dict</p>
<p>也就是说，我们应该这样执行execute：</p>
<ol>
<li><code>cur.execute(&#39;select version()&#39;)</code> 不需要任何参数，直接一整条SQL语句。</li>
<li><code>cur.execute(&#39;INSERT INTO sometable VALUES (%s,%s)&#39;, (1, 4))</code> 参数化查询，%s是占位符，不需要考虑字段类型。无脑%s没事的，这不是Python的字符串%格式化风格语法。</li>
</ol>
<p>根据<a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0249/">PEP 249</a>，clientlibrary.paramstyle可以看到占位符风格，比如说自带的sqlite3的占位符就是?，pymysql是pyformat，更多详细信息可以<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/7929364/python-best-practice-and-securest-to-connect-to-mysql-and-execute-queries">看看这里</a></p>
<p>比较不推荐的执行查询的方式</p>
<p>sql &#x3D; ‘insert into sometable values(‘<br>sql &#x3D; sql + “‘“ + var1 + “‘,’” + var2 + “‘,’” + var3 + “‘,” + str(1984) + “)”</p>
<p>以及任何花样循环拼接的方式，看着那些单引号双引号我都头疼，就算USE somedb这种没办法搞参数化查询，那咱用%s、format、f-string拼字符串可读性也比这种+的好。况且+要开辟新的内存空间，会更慢了。</p>
<p>提示：mysql connector的cursor支持multiLine模式，也就是说可以通过分号执行多条SQL语句。不过，pymysql不支持哟。</p>
<h3 id="cur-executemany-参数"><a href="#cur-executemany-参数" class="headerlink" title="cur.executemany()参数"></a>cur.executemany()参数</h3><p>以为会execute参数化查询就够了吗？才不是呢，远远还不够。有些时候我们需要大量插入（或是replace）。按照一般的脑回路：</p>
<p>sql &#x3D; “INSERT INTO sometable VALUES (%s,%s,%s)”<br>for item in data:<br>    cur.execute(sql, item)</p>
<p>还是先来看下executemany的原型：<code>executemany(self, query, args)</code></p>
<p>第一个参数query还是带有占位符的SQL语句，第二个参数args一般来说是双层嵌套的参数。例子如下：</p>
<p>sql &#x3D; ‘INSERT INTO SOMETABLE VALUES (%s,%s,%s)’<br>data &#x3D; [[1, 2, 3], [4, 5, 6], [7, 8, 9]]<br>cur.executemany(sql, data)</p>
<p>核心关键就在这里，executemany会通过多值的INSERT提升性能，其他情况下就和循环调用execute一样了</p>
<p>有些小盆友可能想问，为啥executemany能够提高性能呢？因为executemany生成的是类似<code>INSERT INTO sometable VALUES(1,2,3),(4,5,6)</code>这种语句啊，肯定要比一条一条INSERT要快很多了。不过为什么说“肯定”呢？想当然是很正常的，有理有据的想当然才是可以的（…( ＿ ＿)ノ｜继续看就知道为什么了）。</p>
<p>注意，由于单条SQL语句的长度有限制，这里可能需要看情况分割一下：</p>
<p>for i in range(0, len(data), SIZE):<br>    part &#x3D; data[i:i + SIZE]<br>    # do something here, such as executemany</p>
<p>相信我，只要插入数据量足够大，executemany就能够成为性能提升的最关键的一点。</p>
<p>哦对了，executemany配合参数化查询已经很好用了，还是别多值INSERT，虽说也能提高效率……</p>
<p>以下测试有一点需要注意，不同的表结构、字段类型所得到的二者比值未必相同，但总体情况毫无疑问是executemany胜出。</p>
<p>下面是我的测试，测试脚本可以从如下地址获取： [gt href&#x3D;’<a target="_blank" rel="noopener" href="https://github.com/BennyThink/tools/tree/master/one/_million'/]%E5%BC%80%E6%BA%90%E5%9C%B0%E5%9D%80/[/gt/]">https://github.com/BennyThink/tools/tree/master/one\_million&#39;\]开源地址\[/gt\]</a></p>
<table><tbody><tr><td colspan="3"><span style="font-size: 12pt;">简单表的性能benchmark</span></td></tr><tr><td>插入条数</td><td><span style="font-size: 12pt;">execute</span></td><td><span style="font-size: 12pt;">executemany</span></td></tr><tr><td><span style="font-size: 12pt;">1000</span></td><td><span style="font-size: 12pt;">0.35</span></td><td><span style="font-size: 12pt;">0.02</span></td></tr><tr><td><span style="font-size: 12pt;">5000</span></td><td><span style="font-size: 12pt;">0.84</span></td><td><span style="font-size: 12pt;">0.06</span></td></tr><tr><td><span style="font-size: 12pt;">10000</span></td><td><span style="font-size: 12pt;">4.16</span></td><td><span style="font-size: 12pt;">0.34</span></td></tr><tr><td><span style="font-size: 12pt;">20000</span></td><td><span style="font-size: 12pt;">4.87</span></td><td><span style="font-size: 12pt;">0.39</span></td></tr><tr><td><span style="font-size: 12pt;">50000</span></td><td><span style="font-size: 12pt;">19.43</span></td><td><span style="font-size: 12pt;">0.93</span></td></tr><tr><td><span style="font-size: 12pt;">100000</span></td><td><span style="font-size: 12pt;">40.84</span></td><td><span style="font-size: 12pt;">3.18</span></td></tr><tr><td><span style="font-size: 12pt;">500000</span></td><td><span style="font-size: 12pt;">165.72</span></td><td><span style="font-size: 12pt;">9.76</span></td></tr><tr><td><span style="font-size: 12pt;">1000000</span></td><td><span style="font-size: 12pt;">369.46</span></td><td><span style="font-size: 12pt;">29.43</span></td></tr></tbody></table>

<p><img src="/images/2018112701530413.png"></p>
<p>看一下这个折线图更直观的感受下吧，平均来说executemany要比execute快上至少10倍。</p>
<h3 id="其他不太好玩方式"><a href="#其他不太好玩方式" class="headerlink" title="其他不太好玩方式"></a>其他不太好玩方式</h3><p><strong>关于事务与commit</strong></p>
<p>不要尝试花样commit，比如说一条一条插，每插入1000条commit一次；插一条commit一次。这比画蛇添足还过分，这就是自讨苦吃啊。一起commit就得了。（如果数据可能会插入失败，那么一定要用try…except…finally控制好异常确保无误）</p>
<p><strong>并发INSERT</strong></p>
<p>在使用InnoDB情况下，由于InnoDB有事务，插入时有排他锁，表的结构可能不同，可能有主键外键唯一约束，可能有自增非空限制，数据库版本&#x2F;配置可能不同，一些库的限制，GIL锁等等，这个变量就有点太大了有点难控制……这个我真的没办法拿数据说话。</p>
<h3 id="其他小的代码因素"><a href="#其他小的代码因素" class="headerlink" title="其他小的代码因素"></a>其他小的代码因素</h3><p>除了execute&#x2F;executemany这个最大的性能因素之外，还有一些在某些情况下Python层面的对性能提升未必很明显的处理方式:</p>
<ol>
<li>拼接字符串：尽量选择f-string、%、format或join，+是最慢的，<a target="_blank" rel="noopener" href="https://realpython.com/python-f-strings/#speed">f-string是最快的</a>。</li>
<li>Python 2需要特别注意一些方面，比如range和xrange，True和1等</li>
</ol>
<h1 id="其他因素"><a href="#其他因素" class="headerlink" title="其他因素"></a>其他因素</h1><h2 id="服务器性能"><a href="#服务器性能" class="headerlink" title="服务器性能"></a>服务器性能</h2><p>包含MySQL版本，编译优化，宿主机IO&#x2F;CPU&#x2F;RAM等。这一点就很难展开说了，说不定某个版本的MySQL在某个平台上通过某个编译优化参数性能就提升了20%呢。哦对了，Python开启<code>--enable-optimizations</code>时据说性能会提升10%-20%呢。</p>
<h2 id="网络速度"><a href="#网络速度" class="headerlink" title="网络速度"></a>网络速度</h2><p>如果是远程连接到数据库的话，那么减少连接次数、减少数据量是更加的选择，此时就更应该选择批量的executemany而不是execute了。因为多次execute会嗷嗷的增加上传和下载的流量，而executemany不会增加下载的流量，就连上传流量的增加也不那么可怕哟。</p>
<p>还好都是一个TCP连接里走的，要不就更惨不忍睹了。</p>
<p>不信我抓包给你看~</p>
<h3 id="单个execute"><a href="#单个execute" class="headerlink" title="单个execute"></a>单个execute</h3><p><img src="/images/20181127015305100.png"></p>
<p>一共这么几个请求，一个autocommit&#x3D;0，一个commit，三个查询。</p>
<p><img src="/images/2018112701530643.png"></p>
<p>协议统计告诉我们，我发送了682字节，接受了628字节。</p>
<p>下面我们来看下executemany</p>
<h3 id="executemany"><a href="#executemany" class="headerlink" title="executemany"></a>executemany</h3><p><img src="/images/2018112701530642.png"></p>
<p>从图中我们可以看到，一个autocommit&#x3D;0，一个commit，外加一次查询。</p>
<p><img src="/images/2018112701530789.png"></p>
<p>协议统计告诉我们，发送了514字节，接收了537字节。</p>
<p>假如我把数据量从3改成1000，那么……</p>
<p><img src="/images/2018112701530770.png"></p>
<p>单次execute发送94K接受65K</p>
<p><img src="/images/2018112701530850.png"></p>
<p>Executemany发送10K接受542字节</p>
<h3 id="网速影响总结"><a href="#网速影响总结" class="headerlink" title="网速影响总结"></a>网速影响总结</h3><p>综上，在数量级为1000的情况下，execute总流量是159K，executemany是10.53K，差了接近15倍。那么在低网速、大数据的情况下谁的优势更明显就不言而喻了。</p>
<p>那么问题来了，假如单独executemany的时候差了十倍，流量又差了十倍，那是不是一共就差了100倍了？</p>
<p>(　o&#x3D;^•ェ•)o　┏━┓（你看桌子都翻了，所以呢）不可以这么计算的，大部分情况下网速对性能的影响并不是那么明显，当网速足够慢、数据足够大时，这个影响就会被放大；反之这个影响可以忽略不计。所以正确计算是要加权重的，然而这个权重是几乎无法得到的ε&#x3D;ε&#x3D;ε&#x3D;┏(゜ロ゜;)┛</p>
<p>所以，如果在远程连接数据库的情况下执行查询，那么数据量大的时候，因为单次execute导致了网络传输量的急剧上升，execute的负面效应会被一定程度的放大。</p>
<h2 id="最终的总结"><a href="#最终的总结" class="headerlink" title="最终的总结"></a>最终的总结</h2><ol>
<li>官方文档是第二好的参考来源，那么第一好的参考来源是什么？源代码啦；</li>
<li>当遇到问题的时候，想当然是很正常的，但是更重要的是通过分析实验与数据了解并证实猜想；</li>
<li>某些因素可能会互相影响。像本例execute的副作用之一就是会增加网络流量，所以execute才是根源，网速只是伴随的副作用而已，不可因果倒置；</li>
<li>某些性能因素是很难控制的，比如服务器CPU&#x2F;RAM&#x2F;IO，Python解释器性能，MySQL版本&#x2F;编译选项&#x2F;配置&#x2F;集群，甚至是操作系统、内核的差距。这种因素的变量几乎很难控制，那么就不要考虑了，等某因素成为关键点的时候再去分析；</li>
<li>我有代码洁癖；</li>
<li>这可能是一个火苗</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/11/28/one-million-data/index/" data-id="clhp7rthw0069s2qr5c1z6h42" data-title="假如给我一百万（的数据）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-confess-for-what/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/03/confess-for-what/index/" class="article-date">
  <time class="dt-published" datetime="2018-11-03T00:00:00.000Z" itemprop="datePublished">2018-11-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/03/confess-for-what/index/">面壁思过...？</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>晚上女神突然来找我，我很开心。我知道这段时间她一定会比较频繁的找我，所以也并没有感到有什么意外。本来以为是因为毕设的原因来找我帮忙，没想到是想去Quora让我帮忙搜几个问题(去给留学生的作业什么的)。不过你懂的，我们的GFW是多么伟大啊。</p>
<p>后来这么一说，事情就简单了，我直接找几篇发给她参考下，也省得帮她配置shadowsocks什么的，尽管我十分愿意，毕竟，这也是为了<a target="_blank" rel="noopener" href="https://program-think.blogspot.com/2009/10/use-people-war-to-anti-gfw.html">让GFW陷入人民战争的汪洋大海</a>而做的微不足道的努力吧。话说回来，问题也很简单：为什么最近几年人们都选择移民美国，美国应该紧缩还是宽松移民政策？</p>
<p>这是个很好的问题啊，很值得讨论。我就顺便说了一句，我无时无刻不在想着逃走。我以前从来不会跟人说我的任何倾向和想法，因为我觉得就某人说的一样：我关注的都是大家不关注的。大家关注的我都没有精力去关注。</p>
<p>之所以敢和她这么说一句，可能是因为我认为她最近这一两年的经历与思想转变更像是<a target="_blank" rel="noopener" href="https://program-think.blogspot.com/2014/02/brainwash-and-idiot.html">“觉醒”的人</a>吧。我还跟人吹嘘过说我认识这种“异类觉醒”的人呢。呃似乎我这么说人家不太好吧。</p>
<p>也许她是受到了我当初无心插柳送给她的《1984》的影响吧，也许是那一年遇到了各种奇怪的社会现象吧。总之这种“觉醒”的人越来越多总是好的，虽说从觉醒程度上来讲可能并不足够深、并不理想。</p>
<p>但是想都没想到，我竟然被她狠狠的训了、或者说是凶了一次。感觉平时那么温文儒雅的她好像是第一次用这么大的声音、这么强烈的语气、加重了的力度的词语跟我说话……我记得她的声音分明是很甜美很温柔的那种圆滚滚的可爱的样子的啊……</p>
<p>大概就是说作为华人会被歧视，只看到了白板上一个黑点，只想追求自己的所谓的什么什么的。说实话我觉得这些观点都是没什么的，是的<strong>我不同意你的观点，但是我却愿意捍卫你说这些话的权利</strong>。即使我们的思想截然相反，但是思想一旦发生碰撞，就会溅出曼妙的火花。而这种思维火花往往对彼此的发展有积极性作用的。</p>
<p>只是很平静的说出这些其实也没什么，心情好的话，也许就可以你一句我一句的讨论，找出论据支撑自己的观点，用事实来说明观点，也许在这种事情里并没有绝对的对错（可能这样说也不对，但是至少我很清楚，我不会一定要像古美门那样不择手段的不留余地，毕竟跟我对话的人可是女神），可能经过这样一次讨论，我们对彼此的理解会更加深一点，或者是学习了解到了一些自己的思维体系中原本并不存在的一些观点。<strong>所谓思维的碰撞嘛，本应该就是这样美好的设想的</strong>。</p>
<p>唯一不同的是，她并不是心态平和的说出了这些，而是以着一种盛气凌人的、怒发冲冠的非常强烈的训斥般的语气说出了这些，如果是一些逻辑严谨的证明也就算了，但是给我的感觉却是分分钟走下滑坡。</p>
<p>上次有人用这种居高临下盛气凌人的语气跟我说话，还是8月中旬看电影时发生的小意外。不过好歹我和他也不认识，打不打招呼能咋样，又不给我发钱，并不在乎。可是今晚……想一想，是不是我太脆弱了，是不是我太过于看重别人对我的看法了，是不是我太玻璃心了。一定是这样的吧。为什么要轻易相信别人，为什么要轻易的把自己的内心、把自己的想法告诉别人呢？</p>
<p>我一句话都没敢反驳，甚至都不敢接茬。我立刻怂了，一丁点观点都不敢表达，一丁点事实都不敢描述。我立刻很委婉纠结的试探着问下不会是生气了吧……当然了这么问当然是无用功了。</p>
<p>得了，先别想这些，怀着忐忑不安的心情，我还是尽全力认真完成她拜托我的事情吧。我才不在乎别人是怎么拜托她的，也不在乎她能拿到什么好处。我所在乎的就是她来找我，她需要我帮忙我这一个环节，在那一瞬间我知道我是被人需要的，还是被女神需要的，所以自然要尽全力的认真的做好交代给我的事情，这样下次她才会更愿意来拜托我。至于其他的环节，其实我并不是很在乎的。</p>
<p>然后就到了现在。我本来只是想写几个字平静下自己的内心，却开始发现自己的情绪变得越来越不稳定、越来越激动。</p>
<p>莫非我这是PTSD了？所以我才这样敏感……说出去会被嫌弃笑话的吧。不过也没关系啊，我的心理太阴暗了，我一点都不积极，我总是看不到阳光的那一面，我总是倾向于选择自我毁灭，偶尔还会有着自暴自弃的想法。谁能喜欢这样性情多变的人就怪了。所以我不值得被爱啊，这些全都是我自己作死的后果。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2018/11/2018110316142082.jpg"><img src="/images/2018110316142082.jpg"></a> 和你一起面壁思过好了。</p>
<p>也许吧，我再也不是那个你们认识的我了。终有一天我们之间的关系会逐渐切断，终有一天我们会把对方从彼此的记忆中清除。我一直认为自己是一个很绝情的人，所以这些对我来说是都是可以接受的。只是你现在还需要我，那就让我心甘情愿的完成为数不多的几次收官之作吧。</p>
<p>最后，还是想起了一句话：</p>
<blockquote>
<p>宪法原则中最重要的是“自由思想的原则”——不是确保我们喜欢的思想的自由，而是确保我们所憎恨的思想的自由</p>
<p>if there is any principle of the Constitution that more imperatively calls for attachment than any other it is the principle of free thought—not free thought for those who agree with us but freedom for the thought that we hate.</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/11/03/confess-for-what/index/" data-id="clhp7rtf5001gs2qr3eps78rt" data-title="面壁思过...？" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-python-excel-add-column/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/19/python-excel-add-column/index/" class="article-date">
  <time class="dt-published" datetime="2018-09-19T00:00:00.000Z" itemprop="datePublished">2018-09-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/19/python-excel-add-column/index/">使用Python给带合并单元格的Excel加一列</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>前几天有这么一个需求，要给Excel表格的最前面加入两列。我想这不是非常简单吗？几行代码而已：</p>
<p>import openpyxl</p>
<p>wb &#x3D; openpyxl.load_workbook(‘simple.xlsx’)<br>sh &#x3D; wb.active<br>sh.insert_cols(1)<br>wb.save(‘result.xlsx’)</p>
<p>非常简单，自己还找了个表格试了下，好像没问题。</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2018/09/2018091913193939.png"><img src="/images/2018091913193939.png"></a></p>
<p>然后我发现我要处理的表格是带有合并单元格的，用这几行代码处理下发现……</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2018/09/2018091913194017.png"><img src="/images/2018091913194017.png"></a></p>
<p>我的单元格都乱套了……</p>
<p>这可咋整……不管了，掏出了openpyxl</p>
<h2 id="openpyxl"><a href="#openpyxl" class="headerlink" title="openpyxl"></a>openpyxl</h2><h3 id="处理xlsx合并单元格插入列"><a href="#处理xlsx合并单元格插入列" class="headerlink" title="处理xlsx合并单元格插入列"></a>处理xlsx合并单元格插入列</h3><p>其实处理思路很简单，遍历每一个单元格，给纵坐标+2，然后样式什么的也拷贝一份写到新的表格里就好了。但是一片不大不小的水域，总是有那么不多不少的水坑。</p>
<h3 id="如何判断合并单元格"><a href="#如何判断合并单元格" class="headerlink" title="如何判断合并单元格"></a>如何判断合并单元格</h3><p>在openpyxl中， 合并单元格是以<code>ws.merged_cells</code>这个列表表示的，这个列表里面的形式如下：I1:I2 D1:E1 A1:A2 B1:C1 F1:H1，每一对用冒号连接的坐标表示这两个之间是合并的。</p>
<p>这样问题就简单啦，我们只需要把坐标+2就好了，比如说A1:B2变C1:E2，K1:J5变M1:L1，Z1:AA1变AB1:AC1，等等什么？Z1:AA1变AB1:AC1？没办法我这个Excel有点长……</p>
<p>这个不是普通的加法啊，通过<code>ord()</code>和<code>chr()</code>来回转换吧？进坑了吧少年?</p>
<h3 id="二十六进制？？"><a href="#二十六进制？？" class="headerlink" title="二十六进制？？"></a>二十六进制？？</h3><p>我们了解到，Excel的坐标变化是字母表的进位，也就是26进制！这……二进制，八进制，十六进制都是咱比较常用的，这二十六进制是什么鬼？来我们<code>if…elif…elif….elif</code>写一波……</p>
<p>def twenty_six(coord, size):</p>
<h1 id="A1-B2-AB1-AC2"><a href="#A1-B2-AB1-AC2" class="headerlink" title="A1:B2, AB1:AC2"></a>A1:B2, AB1:AC2</h1><pre><code>left = coord.split(&#39;:&#39;)\[0\]
right = coord.split(&#39;:&#39;)\[-1\]
left\_char = left\[0\]
right\_char = right\[0\]

if len(left\_char) == 1 and len(right\_char) == 1:
    return &quot;%s:%s&quot; % (chr(ord(left\_char + size)), chr(ord(right\_char + size)))
elif len(left\_char) == 2 and len(right\_char) == 2:
    return &quot;%s:%s&quot; % (chr(ord(left\_char + size)), chr(ord(right\_char + size)))
</code></pre>
<p>哎？那要坐标是A1:AZ3的呢？不用想了这段代码是错的⛲</p>
<p>那么我们来创造人类史上的第一个26进制吧！小伙子，又进坑了吧……?</p>
<p>要什么26进制啊，直接弄个A, B, C, D….AA, AB, AC….BC, BD….ZZ一共26*26个元素的列表，通过index查得了。</p>
<p>所以所谓的“26进制”咱可以这么处理一波：</p>
<p>import itertools<br>import string</p>
<p>table &#x3D; list(itertools.chain(string.ascii_uppercase,(‘’.join(pair) for pair in itertools.product(string.ascii_uppercase, repeat&#x3D;2))))</p>
<p>def twenty_six(char, size):<br>    index &#x3D; table.index(char)<br>    return table[index + size]</p>
<p>其中<code>char</code>是表示字母（不带数字的那种）</p>
<p>喜欢挑刺的童鞋们可能会说，你这是列表，列表查找可能得全都遍历完了才查找到，你这太浪费时间了。得用字典。</p>
<p>喂(#`O′)童鞋，如果用字典的话，那么需要不仅能从键（字母）找到值，还得需要通过值找到键，这……行行行，没啥不可能的，键值对反转嘛，面试必会题目。那么用字典，table大概就是这么构造：</p>
<p>使用dict方法</p>
<p>table &#x3D; [dict(zip(itertools.chain(string.ascii_uppercase,<br>(‘’.join(pair) for pair in itertools.product(string.ascii_uppercase, repeat&#x3D;2))),<br>[i for i in range(26 * 26)])),<br>dict(zip([i for i in range(26 * 26)], itertools.chain(string.ascii_uppercase,<br>(‘’.join(pair) for pair in itertools.product(string.ascii_uppercase, repeat&#x3D;2)))))]</p>
<p>使用字典推导(ﾉ*･ω･)ﾉ：</p>
<p>base &#x3D; dict(zip(itertools.chain(string.ascii_uppercase,<br>(‘’.join(pair) for pair in itertools.product(string.ascii_uppercase, repeat&#x3D;2))),<br>[i for i in range(26 * 26)]))</p>
<p>table &#x3D; [base, {v: k for k, v in base.items()}]</p>
<p><code>table[0]</code>表示从字母查找数字，给数字+2之后在<code>table[1]</code>从数字查找字母，调用就更简单了。我爱(ﾉ*･ω･)ﾉ。</p>
<p>然而实际上，676个元素有点少，字典的空间换时间几乎是划不来的。而且<code>dict()</code>和<code>zip()</code>方法以及遍历字典也会花费一点时间，代码还写得很长，所以简单起见生成个列表就够了。</p>
<h3 id="处理字母式坐标"><a href="#处理字母式坐标" class="headerlink" title="处理字母式坐标"></a>处理字母式坐标</h3><p>在解决了26进制之后，我们只需要把字母从一个合并单元格坐标中提取出来就可以了，要完成这项工作其实方法挺多的，比较简单的方法是直接用正则表达式。一搜就有。这里就不写了。</p>
<h3 id="遍历单元格内容和样式"><a href="#遍历单元格内容和样式" class="headerlink" title="遍历单元格内容和样式"></a>遍历单元格内容和样式</h3><p>我们需要遍历每个单元格，多亏了PyCharm的Evaluate Expression功能，很容易就发现遍历单元格的方法：</p>
<p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2018/09/2018091913194476.png"><img src="/images/2018091913194476.png"></a></p>
<p>我们可以很清楚的看到，i这个变量的每一个元素都包含了这个表格的全部信息，包括内容，边框，填充，字体等等。那么获取到这些信息就很简单了，一个双循环即可：</p>
<p>for i in ws.rows:<br>    for v in i:<br>        print(v.coordinate, v.fill, v.border, v.value)</p>
<p><code>v.coordinate</code>表示的是单元格的字母式坐标，我们可以给上面封装好的twenty_six调用下，就能够做好新的移动之后的坐标了。</p>
<p>那么拷贝样式吧。</p>
<h3 id="拷贝单元格样式"><a href="#拷贝单元格样式" class="headerlink" title="拷贝单元格样式"></a>拷贝单元格样式</h3><p>在openpyxl中，给单元格写入样式非常简单，大概如下就可以了：</p>
<p><code>ws[&#39;A1&#39;].fill=&#39;Your fill style&#39;</code></p>
<p>我们把上面遍历过来的内容直接赋值就可以了，大概如下：</p>
<p>for i in ws.rows:<br>    for v in i:<br>        coord &#x3D; ‘移动之后的坐标’<br>        # copy fill border and everything<br>        write_ws[coord].fill &#x3D; v.fill<br>        write_ws[coord].font &#x3D; v.border<br>        write_ws[coord].border &#x3D; v.border</p>
<p>童鞋，你又进坑了━((*′д｀)爻(′д｀*))━!!!!</p>
<p>尽管通过Evaluate能够看到右面的类型是左边接受的类型，但是还是报错。为什么不尝试下浅拷贝呢？嗯这是好用的。</p>
<p><code>from copy import copy</code>把<code>v.fill</code>替换成<code>copy(v.fill)</code>就好了</p>
<h3 id="给合并单元格应用样式"><a href="#给合并单元格应用样式" class="headerlink" title="给合并单元格应用样式"></a>给合并单元格应用样式</h3><p>这个有点特殊，<a target="_blank" rel="noopener" href="https://openpyxl.readthedocs.io/en/stable/styles.html#styling-merged-cells">openpyxl官网写好</a>了一个，咱拿过来直接用就好了。</p>
<h3 id="拷贝单元格内容"><a href="#拷贝单元格内容" class="headerlink" title="拷贝单元格内容"></a>拷贝单元格内容</h3><p>单元格内容用<code>v.value</code>就能读到了。但是那些合并了的单元格，究竟是读取哪个坐标才能读到呢?别猜了，让我来告诉你，左上角的。其他的读取出来的都是<code>None</code></p>
<p>所以拷贝单元格内容就太简单了，判断下就好了。</p>
<p>if v.value:<br>    self.write_ws[coord] &#x3D; v.value</p>
<p>啪(￣ε(#￣)打飞你。如果某个单元格的内容是0，0是布尔假值啊……那岂不是丢数据了？？</p>
<p>小可爱，判断下，这是个特例。于是乎吭哧吭哧……</p>
<p>elif type(v.value) &#x3D;&#x3D; int:<br>    pass</p>
<p>啪(。&gt;︿&lt;)_θ再次打飞你。难道不知道有个东西叫<code>isinstance()</code>嘛？后面的类型可以是元组，列表或者单个类型（类啊，int啊，float啊啥的都可以）</p>
<p>elif isinstance(v.value, float):<br>    pass</p>
<h3 id="组装……"><a href="#组装……" class="headerlink" title="组装……"></a>组装……</h3><p>好吧，那么坑都踩的差不多了，组装组装就好了，先拷贝每个单元格，再给<code>merge_cell</code>拷贝过去，基本上就没啥了。</p>
<p>biu biu biu于是别人给你发了一个xls格式的Excel。</p>
<p>openpyxl不支持xls哦。</p>
<h3 id="转换格式？"><a href="#转换格式？" class="headerlink" title="转换格式？"></a>转换格式？</h3><p>怕啥，openpyxl不支持读xls，我们就找个东西给转换成xlsx，再拿他处理。什么pandas啊，pyexcel啊都行，要不随手找个什么在线转换的支持REST API的咱用requests走起啊……</p>
<p>你看，这个?是什么，黑乎乎的我看不清，要不你跳进去看下。</p>
<p>不用试了，那些库把xls转换成xlsx之后，合并单元格基本丢的差不多的了。用在线转换，比如说牛逼哄哄的Google Docs？恐怕我是要请<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Legal_High">黛真知子</a>当我的辩护律师呀……啊不，我愿意，非常愿意，真的真的那就在线转换吧。小黛请你为我唱一首歌(&#x2F;≧▽≦)&#x2F;</p>
<iframe src="//player.bilibili.com/player.html?aid=4012670&amp;cid=6469605&amp;page=1" frameborder="no" scrolling="no" allowfullscreen="allowfullscreen"></iframe>

<p>哦那个对不起，其实我家小黛唱歌好好听的。爱老婆的清唱??(*￣3￣)╭</p>
<iframe src="//player.bilibili.com/player.html?aid=2440565&amp;cid=3820356&amp;page=1" frameborder="no" scrolling="no" allowfullscreen="allowfullscreen"></iframe>

<p>(づ￣ 3￣)づ</p>
<h2 id="xlrd-xlwt-xlutils"><a href="#xlrd-xlwt-xlutils" class="headerlink" title="xlrd xlwt xlutils"></a>xlrd xlwt xlutils</h2><p>所以说到底，我们又用回来了xlrd这一系列？不过好在思路已经有了，那么就简单了。</p>
<h3 id="读取合并单元格"><a href="#读取合并单元格" class="headerlink" title="读取合并单元格"></a>读取合并单元格</h3><p>同样的，借助PyCharm的Debug，咱很快就找到了合并单元格存于<code>read_ws.merged_cells</code>中。当然要遍历啦，每个元素都是一个包含了四个数字的元组。这四个数字都是啥啊……哎嘿嘿坐标呗，↖↘酱紫的呗，从0开始数数哦，前开后闭哦（哦对不起我高中数学就没及格过）。</p>
<p>for (rlow, rhigh, clow, chigh) in read_ws.merged_cells:<br>    print(rlow, rhigh, clow, chigh)</p>
<p>那怎么读取到合并单元格的值呢？当然还是左上角的坐标啦。那是什么呢，反正就4个数字，排列组合也就十几种，哎……好吧，是rlow和clow啦。读取的话就<code>read_ws.cell(1,2).value</code>就拿到了。</p>
<h3 id="写入合并单元格"><a href="#写入合并单元格" class="headerlink" title="写入合并单元格"></a>写入合并单元格</h3><p>这个也很简单啦，<code>write_merge()</code>接受4个必选参数，也就是坐标，1个可选参数插入的值，另一个可选参数样式。</p>
<p>所以复制合并单元格就这样子：</p>
<p>for (rlow, rhigh, clow, chigh) in read_ws.merged_cells:<br>    # 2nd &amp; 4th parameter have to -1<br>    write_ws.write_merge(rlow, rhigh - 1, clow + size, chigh - 1 + size, read_ws.cell(rlow, clow).value)</p>
<h3 id="读取单元格样式"><a href="#读取单元格样式" class="headerlink" title="读取单元格样式"></a>读取单元格样式</h3><p>xlrd的样式是怎么读出来的呢？找遍了<code>sh.cell()</code>的返回值也没发现有什么结构是存着样式的。</p>
<p>猛然间发现一个<code>sh.cell_xf_index()</code>似乎可以拿到样式的索引的……还有个<code>wb.xf_list</code>，于是用索引去取，完美了。</p>
<h3 id="应用单元格样式"><a href="#应用单元格样式" class="headerlink" title="应用单元格样式"></a>应用单元格样式</h3><p>样式已经取到了，那么赋值给关键字参数style，❌；copy一下赋值，❌……类型似乎正确啊……</p>
<p>一把梭一把梭，拿起来就是干，我不会编程，全都是抄StackOverflow的。</p>
<p>xlrd的样式不能应用给xlwt哦亲亲。(╯‵□′)╯︵┻━┻气得我当场就把桌子掀了。</p>
<p>w &#x3D; XLWTWriter()<br>process(XLRDReader(wb, ‘unknown.xls’), w)<br>w.style_list</p>
<p>从这个<code>w.style_list</code>取下标，这个值就是可以传给xlwt的关键字参数style的了✔○( ＾皿＾)っHiahiahia…</p>
<h3 id="遍历并写入单元格内容和样式"><a href="#遍历并写入单元格内容和样式" class="headerlink" title="遍历并写入单元格内容和样式"></a>遍历并写入单元格内容和样式</h3><p>xlrd的<code>read_ws.nrows</code>和<code>read_ws.ncols</code>表示了这个表格总计的行数和列数，简单粗暴双循环，同样需要注意布尔值为假的0：</p>
<p>for i in range(__nrows):<br>    for j in range(__ncols):<br>        # copy style and value<br>        if read_ws.cell(i, j).value:<br>            write_ws.write(i, j + size, read_ws.cell(i, j).value, style&#x3D;__generate_style(i, j))<br>        elif isinstance(read_ws.cell(i, j).value, float):<br>            write_ws.write(i, j + size, read_ws.cell(i, j).value)</p>
<p>?<strong>是一种神奇的东西，我们每个人都见过，但是却又不知道它的本质，不知道它究竟为何。</strong></p>
<p>?有的时候，可能某些单元格，它是有填充色的，但是内容为空哦。那你这……不就错了吗？</p>
<p>解决方案也很简单，再来个else，继续copy style但是插入空值呗……哎？有没有人想问下openpyxl就没有这个问题啊，怎么这就出现了……(*&#x2F;ω＼*)那个你最好看下openpyxl我是在哪里应用的样式。</p>
<p>人生在世，?总是有的，说不定哪一天走在马路上就……这样做可能会抛出ValueError的异常。</p>
<p>这是为啥呢？其实我也不知道。try一波捕获了就好了。</p>
<h2 id="那么封装成一个类"><a href="#那么封装成一个类" class="headerlink" title="那么封装成一个类"></a>那么封装成一个类</h2><p>这还用说嘛，简单，把openpyxl和xlrd家族的封装到类里，<code>__init__()</code>接受俩参数，也就是输入和输出文件名，该用双下划线“保护”的成员变量就写上，该静态方法就静态方法，最后保留一个<code>insert_col()</code>接受一个size参数，一个<code>save()</code>保存文件就得了，实例能访问读取和写入的workbook和worksheet就足够了。</p>
<h3 id="为什么要有save-呢？"><a href="#为什么要有save-呢？" class="headerlink" title="为什么要有save()呢？"></a>为什么要有save()呢？</h3><p>因为灵活啊，万一人家想插了两列空白，顺便加点字呢？难不成要让人再打开一遍文件啊？当然不了，直接实例调用写入的worksheet的那个变量，想怎么来就怎么来了。</p>
<h2 id="这个新的列的表头也得你加"><a href="#这个新的列的表头也得你加" class="headerlink" title="这个新的列的表头也得你加"></a>这个新的列的表头也得你加</h2><h3 id="自定义前景色"><a href="#自定义前景色" class="headerlink" title="自定义前景色"></a>自定义前景色</h3><p>这没啥，很简单，xlwt和openpyxl都带，自己看下文档，很容易就做出来了。</p>
<p>不过需要注意的是，xlwt的设计有一点秀逗，这个插入的背景色的话，如果想自定义的话，是用不了十六进制的颜色值的……那么自定义颜色值大概是……</p>
<p>pattern &#x3D; xlwt.Pattern()<br>xlwt.add_palette_colour(“custom_color”, 0x21)<br>c.write_wb.set_colour_RGB(0x21, 0, 204, 255)<br>pattern.pattern &#x3D; xlwt.Pattern.SOLID_PATTERN<br>pattern.pattern_fore_colour &#x3D; 0x21</p>
<h3 id="这个新加的表头也要封装"><a href="#这个新加的表头也要封装" class="headerlink" title="这个新加的表头也要封装"></a>这个新加的表头也要封装</h3><p>于是咱咔咔咔的要给这个类再加个方法，再给构造方法添加个参数啥的（因为要处理两个不同的表头样式）</p>
<p>啪ㄟ( ▔, ▔ )ㄏ手疼ヽ(*。&gt;Д&lt;)o゜</p>
<p>难道不知道有个东西叫做继承吗？这个类已经很纯粹了，就是给Excel前面加两列，这么加个不相干的方法进去那就是老鼠屎里进了米饭……啊不是米饭里进了老鼠屎。继承下更好哟(＾Ｕ＾)ノ~ＹＯ</p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p><a target="_blank" rel="noopener" href="https://dmesg.app/wp-content/uploads/2018/09/2018091913194557.png"><img src="/images/2018091913194557.png"></a></p>
<p>完美(o゜▽゜)o☆</p>
<p>全部源代码以及示例文件可以戳下面的章鱼猫哦o(&#x3D;•ェ•&#x3D;)m [gt href&#x3D;’<a target="_blank" rel="noopener" href="https://github.com/BennyThink/tools/tree/master/xls'/]%E5%BC%80%E6%BA%90%E5%9C%B0%E5%9D%80/[/gt/]">https://github.com/BennyThink/tools/tree/master/xls&#39;\]开源地址\[/gt\]</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/19/python-excel-add-column/index/" data-id="clhp7rtid006zs2qrhodr75sd" data-title="使用Python给带合并单元格的Excel加一列" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-purpose-of-life/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/08/27/purpose-of-life/index/" class="article-date">
  <time class="dt-published" datetime="2018-08-27T00:00:00.000Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/justsay/">justsay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/08/27/purpose-of-life/index/">生活啊，究竟是为了什么呢</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>A true suicide is a paced, disciplined certainty.</p>
<p>People pontificate “Suicide is a coward’s act”.</p>
<p>Couldn’t be further from the truth.</p>
<p>Suicide takes tremendous courage.</p>
<p>真正的自杀是一场深思熟虑的谋划</p>
<p>人们断言，自杀系懦夫之为</p>
<p>事实却是大相径庭</p>
<p>自杀需要极大的勇气</p>
</blockquote>
<h2 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h2><p>生活啊，究竟是为了什么呢？是为了奔向更美好的未来，还是为了生存下去？</p>
<p>我想，对于我来说，只是单纯的为了生存下去，我只是想活下去，但是却又不敢有一丝的对未来的奢望。</p>
<p>是我选择让生活变得更糟糕的。我自己作死，怪得了谁呢？</p>
<p>真的是这样吗？只是因为我不想再跟父母要一分钱，只是因为我想自己努力去创造未来。</p>
<p>生于穷人家的孩子总是在体验同龄人都在毕业游而我却要为生活而奔波的<a target="_blank" rel="noopener" href="https://twitter.com/BennyThinks/status/1011895319100051456">落差感</a>，总是在感受别人父母都已经准备好一切而我却想要拒绝些许帮助的无力感。是的，这就是生活，永远孤独一人，只能指望自己。</p>
<p>然而无论我怎么选择，似乎还是看不见未来呢。</p>
<p>房价高到望尘莫及，物价高到无法理喻，可收入却低到深不见底。好吧我承认我说错了，收入没那么低，物价虽说高但是也没到吃不起的份上，可是房价却是实实在在的无法理喻。</p>
<p>可不是嘛，住不起、行不起、生不起、病不起、死不起、结不起，总之总之，什么都不起，除了吃得起让你饿不死。</p>
<p>生活变得越来越糟糕了，越来越看不到未来的任何希望了。</p>
<p>生活失去希望，虽生犹死。</p>
<p><img src="/images/2018082713432951.jpeg" alt="To live without hope is to cease to life"></p>
<h2 id="假象"><a href="#假象" class="headerlink" title="假象"></a>假象</h2><p>似乎我曾经说过，我的生活还算滋润？好像是这样啊，工作上的事情处理来得心应手，有人需要我；家庭和睦幸福，父母身体很好，还可以戳小孩子的脸；有着游戏机，吃喝不愁可能还会比较奢侈，有着足够让我无收入活过一年半载的积蓄，可以开开心心的吃顿大餐，可以孤注一掷的为喜欢的人买点什么。这好像可以算作说得过去的才毕业两个月的应届生了？在同龄人中还算是说得过去的了？</p>
<p>看着很潇洒，很得意自由是吧。然而背后的真相就是，这些都无法改变我是小白兔的事实。</p>
<p><a target="_blank" rel="noopener" href="https://program-think.blogspot.com/2013/03/weekly-share-42.html#head-1">我是只可爱的小白兔啊</a>，可爱的小白兔啊，非常萌的萌到爆的那种。然后某天突然意识到自己变成了没有脚的绿油油的韭菜。</p>
<p>小白兔活得多不容易啊，然而被狼，狐狸和王八割了个溜光。</p>
<h2 id="伊人"><a href="#伊人" class="headerlink" title="伊人"></a>伊人</h2><p>我总是会想起<a target="_blank" rel="noopener" href="https://dmesg.app/my-lovestory.html">她</a>。尽管她也许做的不对，但是不知为何我总是回忆起那些日子里她对我的信任。</p>
<p>她那么漂亮，却选择和矮穷挫的我在一起，甚至考虑了未来。也许那个时候我们都很幼稚吧，不知道生活有多么残酷，也许那个时候爱情都是很纯真美好的吧。也许分开对她而言是更好的选择，和我在一起会吃苦的。</p>
<p>曾经互相凝视时看到你眼中含着的笑容，那种很温柔的充满了爱意的笑眼。即使感觉整个内心世界似乎都可以被一个拥抱填满，即使在某些时刻我觉得自己是被需要的，即使这样，也只不过是过去的美好记忆，也许是三年前的记忆，也许是三天前的记忆。</p>
<p>要习惯被拒绝，习惯被忽视，习惯被讨厌，并且要不带任何情绪的一笑而过。希望我能够不带任何情绪的，很快的就忘记这些吧。然而我深深地知道，喜欢的人是不可能的，想要的东西是拿不到的，未来是看不见的。只剩下绝望，只剩下逃离。</p>
<p>在看不到希望的未来里，我能够遇见你，能够与你共同玩耍，能够注视你的笑眼，能够与你牵手拥抱哪怕只有一瞬间，我觉得这也是很美妙的事情。</p>
<p>卖火柴的小女孩最终划亮了最后一根火柴，希望也在她的眼中渐渐流逝。</p>
<p><img src="/images/2018082713433041.png"></p>
<p>最爱的结衣老婆，求你快来治愈我…… 你的笑容已经了我的精神支柱……</p>
<h2 id="离去"><a href="#离去" class="headerlink" title="离去"></a>离去</h2><p>唉。</p>
<p>看不到希望的未来，看不到未来的希望?看不到一丝一毫的生活能变得起色的样子。</p>
<p>没有希望，没有未来。在这个看不到希望的未来里，我连你也看不到呢……</p>
<p>即使看不到希望，也一定要努力生存下去，坚持到这一天吧……还是要努力的，为了逃离，为了Exodus……?</p>
<p><img src="/images/2018082713433171.jpeg"></p>
<h2 id="……"><a href="#……" class="headerlink" title="……"></a>……</h2><p>新出的电影可以去看，喜欢的游戏可以去买，想吃什么也可以吃，想喝冰酒也可以毫不犹豫的加到购物车里。看着很潇洒，很得意自由，光鲜亮丽的生活是吧。然而背后的真相就是，这些都无法改变我是小白兔的事实。其实更多的是对未来生活的无望。不知道是看不到未来的希望还是看不到希望的未来</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/27/purpose-of-life/index/" data-id="clhp7rti3006ts2qrckke3fbh" data-title="生活啊，究竟是为了什么呢" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-pyweathercn/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/08/18/pyweathercn/index/" class="article-date">
  <time class="dt-published" datetime="2018-08-18T00:00:00.000Z" itemprop="datePublished">2018-08-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/program/">program</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/08/18/pyweathercn/index/">一个简单强大的Python天气预报库pyweathercn</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>今天向大家介绍一款可以用来查询国内绝大部分城市天气预报的Python库pyweathercn，网上搜到的基本都不能用啦……</p>
<p>pyweathercn的作者正是大名鼎鼎的本人。</p>
<p>好吧，其实这个库我早在5月份的时候就写好了，但是由于太忙一直忘了这回事……</p>
<p>demo: <a target="_blank" rel="noopener" href="https://weather.bennythink.com/">https://weather.bennythink.com</a></p>
<h2 id="特色"><a href="#特色" class="headerlink" title="特色"></a>特色</h2><p>用法简洁</p>
<p>支持开启REST API风格的服务器，一库多用，异步非阻塞支持高并发，支持https</p>
<h2 id="为啥要开发这个"><a href="#为啥要开发这个" class="headerlink" title="为啥要开发这个"></a>为啥要开发这个</h2><p>因为我需要啊！上网搜罗了一波，各种天气预报API基本上都得注册，可能还得要钱，或者限制访问频率，这就让我非常不开心了。那么既然没人写过，那咱就只好自己写一个了啊。</p>
<p>不过需要注意的是，这个原理是爬虫并解析<a target="_blank" rel="noopener" href="http://www.weather.com.cn/">www.weather.com.cn</a>，所以如果某天不好用了，很有可能就是人家网站改版了……</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>需要注意的是，这个库并不支持Python 2，所以请使用Python 3</p>
<p>pip install pyweathercn</p>
<p>如果需要请自行替换为<code>pip3</code></p>
<p>另外，如果你使用国内的PyPi源，可能现在还没更新到1.0.3呢……</p>
<p>其实这个库本应该是支持Python 2的，因为也没用什么Python 3才有的特性和语法用了一些的，但是我就是不想支持Python 2，不爽你来打我啊。不过非得想支持Python 2 的话，你可以下载tar包解压缩到site-packages啊</p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="普通模式"><a href="#普通模式" class="headerlink" title="普通模式"></a>普通模式</h3><p>非常简单，支持chain call和实例模式，来几个例子：</p>
<p>&gt;&gt;&gt; import pyweathercn</p>
<blockquote>
<blockquote>
<blockquote>
<p>pyweathercn.Weather(‘重庆’).temp()</p>
</blockquote>
</blockquote>
</blockquote>
<p>‘重庆：20’</p>
<blockquote>
<blockquote>
<blockquote>
<p>w &#x3D; pyweathercn.Weather(‘北京’)</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>w.data</p>
</blockquote>
</blockquote>
</blockquote>
<p>{‘data’: {‘city’: ‘北京’, ‘aqi’: ‘159’, ‘tip’: ‘紫外线指数很强涂擦SPF20以上，PA++护肤品，避强光。穿衣指数热适合穿T恤、短薄外套等夏季服装。’, ‘temp’: ‘20’, ‘forecast’: [{‘date’: ‘23日（今天）’, ‘type’: ‘晴’, ‘temp’: ‘15℃’, ‘wind’: ‘西南风 3-4级’}, {‘date’: ‘24日（明天）’, ‘type’: ‘晴’, ‘temp’: ‘31℃&#x2F;17℃’, ‘wind’: ‘南风 3-4级’}, {‘date’: ‘25日（后天）’, ‘type’: ‘晴转多云’, ‘temp’: ‘31℃&#x2F;19℃’, ‘wind’: ‘西南风 &lt;3级’}, {‘date’: ‘26日（周六）’, ‘type’: ‘阴转多云’, ‘temp’: ‘30℃&#x2F;16℃’, ‘wind’: ‘西风 &lt;3级’}, {‘date’: ‘27日（周日）’, ‘type’: ‘多云’, ‘temp’: ‘29℃&#x2F;15℃’, ‘wind’: ‘南风 &lt;3级’}, {‘date’: ‘28日（周一）’, ‘type’: ‘多云’, ‘temp’: ‘25℃&#x2F;15℃’, ‘wind’: ‘东北风 &lt;3级’}, {‘date’: ‘29日（周二）’, ‘type’: ‘晴’, ‘temp’: ‘29℃&#x2F;15℃’, ‘wind’: ‘西南风 &lt;3级’}]}, ‘status’: 0, ‘message’: ‘success’}</p>
<blockquote>
<blockquote>
<blockquote>
<p>w.today()</p>
</blockquote>
</blockquote>
</blockquote>
<p>‘北京：23日（今天）晴15℃西南风 3-4级’</p>
<blockquote>
<blockquote>
<blockquote>
<p>w.tomorrow(True)</p>
</blockquote>
</blockquote>
</blockquote>
<p>{‘date’: ‘24日（明天）’, ‘type’: ‘晴’, ‘temp’: ‘31℃&#x2F;17℃’, ‘wind’: ‘南风 3-4级’}</p>
<blockquote>
<blockquote>
<blockquote>
<p>w.tip()</p>
</blockquote>
</blockquote>
</blockquote>
<p>‘北京温馨提示：紫外线指数很强涂擦SPF20以上，PA++护肤品，避强光。穿衣指数热适合穿T恤、短薄外套等夏季服装。’</p>
<blockquote>
<blockquote>
<blockquote>
<p>w.forecast(False,5)</p>
</blockquote>
</blockquote>
</blockquote>
<p>‘北京：28日（周一）多云25℃&#x2F;15℃东北风 &lt;3级’</p>
<p>其中tomorrow 等类方法的参数如果传布尔真值的话，将会显示原始json响应，不传或者传布尔假值会显示易于阅读的字符串。</p>
<p>其他的一些类方法，咱的IDE都有提示，我注释写的还算简单易懂，这里就不细说了</p>
<h3 id="服务器模式"><a href="#服务器模式" class="headerlink" title="服务器模式"></a>服务器模式</h3><p>import pyweather</p>
<h1 id="running-on-http-127-0-0-1-8888"><a href="#running-on-http-127-0-0-1-8888" class="headerlink" title="running on http://127.0.0.1:8888"></a>running on <a target="_blank" rel="noopener" href="http://127.0.0.1:8888/">http://127.0.0.1:8888</a></h1><p>pyweathercn.server(host&#x3D;’127.0.0.1’)</p>
<h1 id="running-on-http-0-0-0-0-3333"><a href="#running-on-http-0-0-0-0-3333" class="headerlink" title="running on http://0.0.0.0:3333"></a>running on <a target="_blank" rel="noopener" href="http://0.0.0.0:3333/">http://0.0.0.0:3333</a></h1><p>pyweathercn.server(3333)</p>
<h1 id="support-ssl-https-www-example-com-8888"><a href="#support-ssl-https-www-example-com-8888" class="headerlink" title="support ssl: https://www.example.com:8888"></a>support ssl: <a target="_blank" rel="noopener" href="https://www.example.com:8888/">https://www.example.com:8888</a></h1><p>pyweathercn.server(‘8888’, ‘<a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a>‘, ssl_options&#x3D;{<br>“certfile”: “fullchain.pem”,<br>“keyfile”: “privkey.pem”})</p>
<p>哪位好心人我啊可以开放一个<a target="_blank" rel="noopener" href="https://weather.bennythink.com/">公开的API</a>给大家用，哈哈。</p>
<p>在服务器模式下的调用方法，需要请求<code>/weather</code>路由，必须参数为city，可选参数为day，使用get方法的url参数或者post方法的url-encode form，目前还不支持post json。</p>
<p> </p>
<h4 id="Nginx-反向代理"><a href="#Nginx-反向代理" class="headerlink" title="Nginx 反向代理"></a>Nginx 反向代理</h4><p>服务器用systemd等运行一个监听127.0.0.1的服务器模式python脚本，server块如下配置：</p>
<p>server {<br>listen 80;<br>server_name <a target="_blank" rel="noopener" href="http://www.siteone.com/">www.siteone.com</a>; # 你的域名<br>location &#x2F; {<br>proxy_pass <a target="_blank" rel="noopener" href="http://127.0.0.1:8888/">http://127.0.0.1:8888</a>;<br>}</p>
<p>如果需要https支持，可以参考<a target="_blank" rel="noopener" href="https://github.com/BennyThink/tools/blob/master/weather.conf">这个配置文件</a></p>
<h4 id="例子1-GET：呃请原谅我的pangu把url搞成了带空格的……"><a href="#例子1-GET：呃请原谅我的pangu把url搞成了带空格的……" class="headerlink" title="例子1 GET：呃请原谅我的pangu把url搞成了带空格的……"></a>例子1 GET：呃请原谅我的pangu把url搞成了带空格的……</h4><p><a target="_blank" rel="noopener" href="http://127.0.0.1:8888/weather?city=%E4%B8%8A%E6%B5%B7">http://127.0.0.1:8888/weather?city=上海</a></p>
<p><img src="/images/2018081808175847.png"></p>
<h4 id="例子2-GET："><a href="#例子2-GET：" class="headerlink" title="例子2 GET："></a>例子2 GET：</h4><p><a target="_blank" rel="noopener" href="http://127.0.0.1:8888/weather?city=%E4%B8%8A%E6%B5%B7&day=3">http://127.0.0.1:8888/weather?city=上海&amp;day=3</a></p>
<p><img src="/images/2018081808175971.png"></p>
<h4 id="例子3-POST："><a href="#例子3-POST：" class="headerlink" title="例子3 POST："></a>例子3 POST：</h4><p><img src="/images/2018081808180288.png"></p>
<h2 id="PyPi仓库地址"><a href="#PyPi仓库地址" class="headerlink" title="PyPi仓库地址"></a>PyPi仓库地址</h2><p><a target="_blank" rel="noopener" href="https://pypi.org/project/pyweathercn/">https://pypi.org/project/pyweathercn/</a></p>
<h2 id="GitHub源代码"><a href="#GitHub源代码" class="headerlink" title="GitHub源代码"></a>GitHub源代码</h2><p>[gt href&#x3D;’<a target="_blank" rel="noopener" href="https://github.com/BennyThink/pyweathercn'/]%E5%BC%80%E6%BA%90%E5%9C%B0%E5%9D%80/[/gt/]">https://github.com/BennyThink/pyweathercn&#39;\]开源地址\[/gt\]</a> 欢迎star、fork、PR</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/18/pyweathercn/index/" data-id="clhp7rtif0075s2qr7l5c31yj" data-title="一个简单强大的Python天气预报库pyweathercn" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-x1c-hdmi/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/08/09/x1c-hdmi/index/" class="article-date">
  <time class="dt-published" datetime="2018-08-09T00:00:00.000Z" itemprop="datePublished">2018-08-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/08/09/x1c-hdmi/index/">X1 Carbon的HDMI不好用了怎么办</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>X1C的HDMI不好用了怎么办，捅屁股啊</p>
<p>Lenovo X1 Carbon 6th 是一款非常优(áng)秀(guì)、轻薄的商务本。某天，我照常连接显示器的时候，发现竟然没有输出了。考虑到Windows 10是一个日常抽风的操作系统，第一反应当然是重启啦。</p>
<p>当然是不好用的啦。</p>
<p>那么就替换法，依次替换转接头、用同事电脑测试，得出的结论是：HDMI转接头没坏、VGA线没坏，显示器没坏，是我电脑炸了。至于是软件还是硬件……要不我先做个Ubuntu Live Disk试试？</p>
<p>后来再联想官网搜到了解决方案，如果你的设备管理器中System Device下没有看到ThunderBolt字样的设备，那么就可以跟着这个方法来一遍。</p>
<p><img src="/images/2018080904481293.png"></p>
<p>关机，拔掉电源，把电脑翻过来，找到背面的小孔，用一个回形针捅大概5秒。然后，开机，设备管理器里是不是就有了，是不是就好用了</p>
<p><img src="/images/201808090448151.png"></p>
<p><strong>喂(#`O′)我说，你要是用百度，下辈子也搜不到这个结果。李彦宏你就别出来丢人现眼了</strong></p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://forums.lenovo.com/t5/ThinkPad-X-Series-Laptops/X1-Carbon-6th-gen-HDMI-not-working/td-p/4091511">X1 Carbon 6th gen HDMI not working</a></p>
<p><a target="_blank" rel="noopener" href="https://is.wfu.edu/help-articles/hard-reset-for-lenovo-x1-carbon/">Hard Reset for Lenovo X1 Carbon</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/09/x1c-hdmi/index/" data-id="clhp7rtnm00bks2qr30sc2jf9" data-title="X1 Carbon的HDMI不好用了怎么办" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ntpdate-problem/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/07/12/ntpdate-problem/index/" class="article-date">
  <time class="dt-published" datetime="2018-07-12T00:00:00.000Z" itemprop="datePublished">2018-07-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/12/ntpdate-problem/index/">Ntpdate调整时间no server suitable for synchronization found</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>小葵花妈妈课堂开课啦</p>
<h2 id="关于俺近期的静默"><a href="#关于俺近期的静默" class="headerlink" title="关于俺近期的静默"></a>关于俺近期的静默</h2><p>最近两个多月，俺确实比较忙（在前几篇博文中也多次提及这点），导致博客更新频率下降。在此，先向各位读者表示抱歉 :(</p>
<p>划掉划掉，其实是最近比较忙，又觉得没什么可以写的。</p>
<h2 id="NTP问题"><a href="#NTP问题" class="headerlink" title="NTP问题"></a>NTP问题</h2><p>最近在公司服务器上进行一些操作，需要比较精确的时间，但是发现服务器时间慢了接近半小时。</p>
<p>对于我这么懒的人，怎么会自己用date去设置时间啊，于是自然用ntpdate同步时间啊。</p>
<p>于是很自然的，用阿里云的ntp服务器吧</p>
<p>[root@XXX ~]# ntpdate -v ntp1.aliyun.com<br>12 Jul 13:25:56 ntpdate[5547]: ntpdate <a href="mailto:&#52;&#46;&#50;&#x2e;&#54;&#112;&#x35;&#x40;&#49;&#x2e;&#50;&#51;&#x34;&#x39;&#x2d;&#x6f;">&#52;&#46;&#50;&#x2e;&#54;&#112;&#x35;&#x40;&#49;&#x2e;&#50;&#51;&#x34;&#x39;&#x2d;&#x6f;</a> Thu Oct 26 10:57:33 UTC 2017 (1)<br>12 Jul 13:26:01 ntpdate[5547]: no server suitable for synchronization found</p>
<p>啊噗，这是个什么报错，莫非阿里云挂了？换到自己的服务器上发现没问题啊……</p>
<p>别说了，网上搜那堆东西真是<a target="_blank" rel="noopener" href="https://dmesg.app/mysql-es-mongo.html#title-3">你抄我我抄你，你说有用吧还说得过去，都是没用的错误的，有意思嘛。</a></p>
<p>后来想了想，可能是因为公司服务器有一些网络限制，导致只能使用内部的NTP服务器吧？于是上employee communities上搜了下，找了一个，再试试……</p>
<p>[root@XXX ~]# ntpdate -v 1.ntp.company.com<br>12 Jul 13:42:25 ntpdate[5825]: ntpdate <a href="mailto:&#x34;&#x2e;&#50;&#x2e;&#x36;&#x70;&#53;&#x40;&#49;&#46;&#x32;&#x33;&#x34;&#57;&#x2d;&#111;">&#x34;&#x2e;&#50;&#x2e;&#x36;&#x70;&#53;&#x40;&#49;&#46;&#x32;&#x33;&#x34;&#57;&#x2d;&#111;</a> Thu Oct 26 10:57:33 UTC 2017 (1)<br>12 Jul 13:42:26 ntpdate[5825]: adjust time server 88.99.77.66 offset -0.009861 sec</p>
<p>你看行了吧</p>
<h2 id="关于近期和未来的计划"><a href="#关于近期和未来的计划" class="headerlink" title="关于近期和未来的计划"></a>关于近期和未来的计划</h2><p>由于工作稍微有点忙，所以除了安静的过好每一天，暂时没有什么太大的安排。</p>
<p>非得要说说的嘛……那就是研究下<a target="_blank" rel="noopener" href="https://www.jetbrains.com/license-server/outdated-ls/">新版本的JetBrains License Server</a>? 要是能有好心人提供一个抓包样本就好了。</p>
<p>更多详细信息可以戳这篇<a target="_blank" rel="noopener" href="https://dmesg.app/jbls.html">《JetBrains License Server 原理及 40 行 Python 代码的实现》</a></p>
<h2 id="于是就这么水了一贴……"><a href="#于是就这么水了一贴……" class="headerlink" title="于是就这么水了一贴……?"></a>于是就这么水了一贴……?</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/07/12/ntpdate-problem/index/" data-id="clhp7rthv0067s2qr2t8o1dpu" data-title="Ntpdate调整时间no server suitable for synchronization found" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-padavan-radius/index" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/13/padavan-radius/index/" class="article-date">
  <time class="dt-published" datetime="2018-05-13T00:00:00.000Z" itemprop="datePublished">2018-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/it/">it</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/13/padavan-radius/index/">在Padavan上简单的使用Radius进行802.1x认证</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>注意看，是Radius，不是Redis</p>
<p>通常来说，我们的无线网络一般是使用WPA2-Personal保护的，但是如果能够使用802.1x，每位用户输入自己的用户名密码，类似某些企业、学校那种认证方式，岂不是很好玩？</p>
<p>当然了，咱只是为了好玩……好像并没什么卵用的样子</p>
<h2 id="前置条件"><a href="#前置条件" class="headerlink" title="前置条件"></a>前置条件</h2><h3 id="需要有一台支持WPA2-Enterprise的路由器"><a href="#需要有一台支持WPA2-Enterprise的路由器" class="headerlink" title="需要有一台支持WPA2-Enterprise的路由器"></a>需要有一台支持WPA2-Enterprise的路由器</h3><p>包括但不限于Padavan等第三方固件。某些路由器的官方固件也是支持的。</p>
<p>比如，在这款TP-LINK固件中无线安全的设置下我们可以看到这个：</p>
<p><img src="/images/2018051308413275.png"></p>
<p>Padavan固件中可以看到这些</p>
<p><img src="/images/2018051308413667.png"></p>
<h3 id="一台服务器"><a href="#一台服务器" class="headerlink" title="一台服务器"></a>一台服务器</h3><p>无论这台服务器是在内网的，还是在外网（比如说腾讯云的也可以）的都可以，只要能和路由器互相通信，并且拥有一个固定的IP即可。</p>
<p>当然了，我这么穷，肯定是拿树莓派做Radius服务器啦。如果想拿Padavan自身做Radius服务器……嗯~ o(<em>￣▽￣</em>)o这个还是算了吧，交叉编译太麻烦，性能也有点太差劲呢。</p>
<p>当然了，这台服务器是要装好一个Linux发行版的。方便起见，这里我用的是Ubuntu Mate 16.04，IP地址为192.168.7.193.当然了，我已经在Padavan中绑定了这个IP，这样就不会因为种种原因导致分配了其他的IP地址啦。 [v_blue] 小提示：固定IP分配方法 高级配置-内部网络-DHCP服务器，最下方的手动指定 IP 的 DHCP 列表。</p>
<p>其他固件可以参考类似条目或者IP与MAC绑定等。 [&#x2F;v_blue]</p>
<h2 id="准备Radius服务器"><a href="#准备Radius服务器" class="headerlink" title="准备Radius服务器"></a>准备Radius服务器</h2><p>既然要使用WPA2-Enterprise，咱就要有Radius服务器来提供认证。这里咱就选择<a target="_blank" rel="noopener" href="https://freeradius.org/">freeRadius</a>啦。</p>
<p>所以就是编译编译咯。以Ubuntu、freeRadius 3.0.x为例：</p>
<p>sudo apt update<br>sudo apt install libtalloc-dev libssl-dev build-essential<br>wget <a href="ftp://ftp.freeradius.org/pub/freeradius/freeradius-server-3.0.17.tar.gz">ftp://ftp.freeradius.org/pub/freeradius/freeradius-server-3.0.17.tar.gz</a><br>tar xf freeradius-server-3.0.17.tar.gz &amp;&amp; rm freeradius-server-3.0.17.tar.gz<br>cd freeradius-server-3.0.17<br>.&#x2F;configure<br>make -j4 &amp;&amp; sudo make install</p>
<p>在最后一步<code>make install</code>时，由于树莓派这孱弱的性能，生成DH密钥花了很长时间（超过半小时哦） <img src="/images/2018051308413833.png"> </p>
<h2 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h2><p>经过漫长的编译之后，如果确认编译成功的话，那咱们就开始配置吧。</p>
<p>以root权限执行如下命令开启调试模式：</p>
<p>sudo radiusd -X</p>
<p>不出意外的话你会看到这样的报错：</p>
<p>Debugger not attached<br>Refusing to start with libssl version OpenSSL 1.0.2g 1 Mar 2016 0x1000207f (1.0.2g release) (in range 1.0.2 release - 1.0.2h rele)<br>Security advisory CVE-2016-6304 (OCSP status request extension)<br>For more information see <a target="_blank" rel="noopener" href="https://www.openssl.org/news/secadv/20160922.txt">https://www.openssl.org/news/secadv/20160922.txt</a><br>Once you have verified libssl has been correctly patched, set security.allow_vulnerable_openssl &#x3D; ‘CVE-2016-6304’</p>
<p>要么更新OpenSSL到1.0.2h之后的，要么……禁用这个检查呗。鉴于OpenSSL实在是太基础的东西，怕更新出乱子，还是禁用吧</p>
<p>sudo vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;raddb&#x2F;radiusd.conf</p>
<p>找到<code>allow_vulnerable_openssl = no</code>，把no改成yes</p>
<p>此时再运行<code>sudo radius -X</code>，就应该能看到Ready to process requests字样了。</p>
<h2 id="添加认证信息"><a href="#添加认证信息" class="headerlink" title="添加认证信息"></a>添加认证信息</h2><p>我们需要配置两个认证信息，一个是路由器连接到Radius的认证信息，一个是客户用于连接到热点的信息。</p>
<p>sudo vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;raddb&#x2F;clients.conf</p>
<p>在文件末尾添加如下信息：</p>
<p>client new {<br>ipaddr &#x3D; 192.168.7.1<br>secret &#x3D; pi.lan<br>}</p>
<p>其中IP地址是路由器的IP地址，secret是设置的密码。</p>
<p>sudo vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;raddb&#x2F;mods-config&#x2F;files&#x2F;authorize</p>
<p>在文件的开头（或者找到取消注释）添加如下信息：</p>
<p>bob Cleartext-Password :&#x3D; “hello”<br>Reply-Message :&#x3D; “Hello, %{User-Name}”</p>
<p>这行配置的意思是，用户名为bob，密码为hello</p>
<p>保存退出，再次运行<code>sudo radiusd -X</code></p>
<p>另开一个窗口，运行如下命令：</p>
<p>radtest bob hello 127.0.0.1 0 test<br>ing123</p>
<p>如果出现如下图所示的Access-Accept那么就是配置成功了</p>
<p><img src="/images/2018051308413973.png"></p>
<h2 id="配置路由器"><a href="#配置路由器" class="headerlink" title="配置路由器"></a>配置路由器</h2><p>在路由器中找到对应的WPA2-Enterprise的配置，大概如下设置：</p>
<p><img src="/images/2018051308414048.png"></p>
<p>之后保存即可</p>
<h2 id="客户端连接"><a href="#客户端连接" class="headerlink" title="客户端连接"></a>客户端连接</h2><p>之后拿起你的手机，找到刚刚的热点，会发现已经变成802.1x认证了，输入用户名bob，密码hello，就可以成功连接啦。</p>
<p><img src="/images/201805130841428.png"></p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>这只是一个非常简单的基础配置教程，可能存在一些不安全的因素。所以以后说不定出系列呗？比如说用数据库，提升安全性……？</p>
<p>更多详情，还是看下面的参考资料吧</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://wiki.freeradius.org/building/Home">https://wiki.freeradius.org/building/Home</a></p>
<p><a target="_blank" rel="noopener" href="https://freeradius.org/documentation/">https://freeradius.org/documentation/</a></p>
<p><a target="_blank" rel="noopener" href="https://freeradius.org/doc/getting_started.html">https://freeradius.org/doc/getting_started.html</a></p>
<p><a target="_blank" rel="noopener" href="http://networkradius.com/doc/FreeRADIUS%20Technical%20Guide.pdf">http://networkradius.com/doc/FreeRADIUS%20Technical%20Guide.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://depthsecurity.com/blog/when-802-1x-peap-eap-ttls-is-worse-than-no-wireless-security">https://depthsecurity.com/blog/when-802-1x-peap-eap-ttls-is-worse-than-no-wireless-security</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/13/padavan-radius/index/" data-id="clhp7rthz006fs2qr4gdzgi3c" data-title="在Padavan上简单的使用Radius进行802.1x认证" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/10/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/12/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/">azure</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/azure/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/china/">china</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/china/justsay/">justsay</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cloudflare/">cloudflare</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/">it</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/it/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/it/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/">justsay</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/gfw/">gfw</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/justsay/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/security/">security</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/website/">website</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/program/">program</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/program/share/">share</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/">security</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/security/justsay/">justsay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/security/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/share/">share</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/website/">website</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/website/program/">program</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/what/">what</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/what/gfw/">gfw</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">March 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">November 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/03/16/py-azure-oai-proxy/index/">使用50行Python代码实现一个Azure OpenAI Proxy</a>
          </li>
        
          <li>
            <a href="/2024/12/12/candlestick-llm/index/">使用Python 通过K线计算技术指标，并用 LLM 预测趋势</a>
          </li>
        
          <li>
            <a href="/2024/11/03/warp-http-proxy/index/">把 Cloudflare WARP 转换为 http 代理</a>
          </li>
        
          <li>
            <a href="/2024/10/12/aca-php/index/">用 Azure Container Apps 运行PHP网站</a>
          </li>
        
          <li>
            <a href="/2024/10/06/aca-vm-scale/index/">Azure Container Apps 连接到虚拟机并配置CPU自动缩放</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Benny小土豆<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>